/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 * <p>
 * http://www.apache.org/licenses/LICENSE-2.0
 * <p>
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.odpi.openmetadata.accessservices.subjectarea.generated.server;

import java.util.*;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;
import org.springframework.web.bind.annotation.*;

//omrs
import org.odpi.openmetadata.repositoryservices.rest.properties.*;
import org.odpi.openmetadata.repositoryservices.archivemanager.opentypes.OpenMetadataTypesArchive;

import org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.*;
import org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.typedefs.PrimitiveDefCategory;

//omas
import org.odpi.openmetadata.accessservices.subjectarea.common.*;
import org.odpi.openmetadata.accessservices.subjectarea.ffdc.SubjectAreaErrorCode;
import org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.*;
import org.odpi.openmetadata.accessservices.subjectarea.common.Classification;
import org.odpi.openmetadata.accessservices.subjectarea.common.Reference;
import org.odpi.openmetadata.accessservices.subjectarea.validators.RestValidator;
import org.odpi.openmetadata.accessservices.subjectarea.constraints.SubjectAreaConstraintsFactory;
import org.odpi.openmetadata.accessservices.subjectarea.constraints.SubjectAreaConstraint;
import org.odpi.openmetadata.accessservices.subjectarea.server.properties.line.Line;

// omas entity specific imports
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.CertificationType.CertificationType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.CertificationType.CertificationTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.CertificationType.CertificationTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.APISchemaType.APISchemaType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.APISchemaType.APISchemaTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.APISchemaType.APISchemaTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DataSet.DataSet;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DataSet.DataSetReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DataSet.DataSetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.OperatingPlatform.OperatingPlatform;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.OperatingPlatform.OperatingPlatformReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.OperatingPlatform.OperatingPlatformMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernancePolicy.GovernancePolicy;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernancePolicy.GovernancePolicyReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernancePolicy.GovernancePolicyMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DerivedSchemaAttribute.DerivedSchemaAttribute;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DerivedSchemaAttribute.DerivedSchemaAttributeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DerivedSchemaAttribute.DerivedSchemaAttributeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Process.Process;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Process.ProcessReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Process.ProcessMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MapSchemaType.MapSchemaType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MapSchemaType.MapSchemaTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MapSchemaType.MapSchemaTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DeployedSoftwareComponent.DeployedSoftwareComponent;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DeployedSoftwareComponent.DeployedSoftwareComponentReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DeployedSoftwareComponent.DeployedSoftwareComponentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaType.SchemaType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaType.SchemaTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaType.SchemaTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DataFile.DataFile;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DataFile.DataFileReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DataFile.DataFileMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Like.Like;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Like.LikeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Like.LikeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Referenceable.Referenceable;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Referenceable.ReferenceableReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Referenceable.ReferenceableMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalReference.ExternalReference;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalReference.ExternalReferenceReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalReference.ExternalReferenceMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Endpoint.Endpoint;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Endpoint.EndpointReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Endpoint.EndpointMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ContactDetails.ContactDetails;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ContactDetails.ContactDetailsReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ContactDetails.ContactDetailsMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceDefinition.GovernanceDefinition;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceDefinition.GovernanceDefinitionReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceDefinition.GovernanceDefinitionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.FileFolder.FileFolder;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.FileFolder.FileFolderReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.FileFolder.FileFolderMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Network.Network;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Network.NetworkReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Network.NetworkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ActorProfile.ActorProfile;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ActorProfile.ActorProfileReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ActorProfile.ActorProfileMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Asset.Asset;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Asset.AssetReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Asset.AssetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.APIOperation.APIOperation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.APIOperation.APIOperationReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.APIOperation.APIOperationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ToDo.ToDo;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ToDo.ToDoReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ToDo.ToDoMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NetworkGateway.NetworkGateway;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NetworkGateway.NetworkGatewayReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NetworkGateway.NetworkGatewayMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceResponsibility.GovernanceResponsibility;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceResponsibility.GovernanceResponsibilityReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceResponsibility.GovernanceResponsibilityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ImplementationSnippet.ImplementationSnippet;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ImplementationSnippet.ImplementationSnippetReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ImplementationSnippet.ImplementationSnippetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.UserIdentity.UserIdentity;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.UserIdentity.UserIdentityReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.UserIdentity.UserIdentityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NoteEntry.NoteEntry;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NoteEntry.NoteEntryReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NoteEntry.NoteEntryMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.PropertyFacet.PropertyFacet;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.PropertyFacet.PropertyFacetReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.PropertyFacet.PropertyFacetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Project.Project;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Project.ProjectReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Project.ProjectMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.HostCluster.HostCluster;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.HostCluster.HostClusterReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.HostCluster.HostClusterMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Glossary.Glossary;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Glossary.GlossaryReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Glossary.GlossaryMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GlossaryCategory.GlossaryCategory;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GlossaryCategory.GlossaryCategoryReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GlossaryCategory.GlossaryCategoryMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MediaCollection.MediaCollection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MediaCollection.MediaCollectionReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MediaCollection.MediaCollectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Collection.Collection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Collection.CollectionReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Collection.CollectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.InformalTag.InformalTag;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.InformalTag.InformalTagReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.InformalTag.InformalTagMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceZone.GovernanceZone;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceZone.GovernanceZoneReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceZone.GovernanceZoneMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Person.Person;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Person.PersonReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Person.PersonMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Application.Application;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Application.ApplicationReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Application.ApplicationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.VirtualContainer.VirtualContainer;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.VirtualContainer.VirtualContainerReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.VirtualContainer.VirtualContainerMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceDriver.GovernanceDriver;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceDriver.GovernanceDriverReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceDriver.GovernanceDriverMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Meeting.Meeting;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Meeting.MeetingReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Meeting.MeetingMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Rating.Rating;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Rating.RatingReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Rating.RatingMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ProjectCharter.ProjectCharter;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ProjectCharter.ProjectCharterReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ProjectCharter.ProjectCharterMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SoftwareServerCapability.SoftwareServerCapability;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SoftwareServerCapability.SoftwareServerCapabilityReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SoftwareServerCapability.SoftwareServerCapabilityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.LicenseType.LicenseType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.LicenseType.LicenseTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.LicenseType.LicenseTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GraphVertex.GraphVertex;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GraphVertex.GraphVertexReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GraphVertex.GraphVertexMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GlossaryTerm.GlossaryTerm;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GlossaryTerm.GlossaryTermReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GlossaryTerm.GlossaryTermMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Team.Team;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Team.TeamReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Team.TeamMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MetadataCollection.MetadataCollection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MetadataCollection.MetadataCollectionReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MetadataCollection.MetadataCollectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceControl.GovernanceControl;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceControl.GovernanceControlReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceControl.GovernanceControlMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Topic.Topic;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Topic.TopicReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Topic.TopicMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SoftwareServer.SoftwareServer;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SoftwareServer.SoftwareServerReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SoftwareServer.SoftwareServerMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DeployedAPI.DeployedAPI;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DeployedAPI.DeployedAPIReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.DeployedAPI.DeployedAPIMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MediaFile.MediaFile;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MediaFile.MediaFileReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MediaFile.MediaFileMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Comment.Comment;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Comment.CommentReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Comment.CommentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.RelatedMedia.RelatedMedia;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.RelatedMedia.RelatedMediaReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.RelatedMedia.RelatedMediaMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ConnectorType.ConnectorType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ConnectorType.ConnectorTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ConnectorType.ConnectorTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.CohortMember.CohortMember;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.CohortMember.CohortMemberReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.CohortMember.CohortMemberMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ComplexSchemaType.ComplexSchemaType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ComplexSchemaType.ComplexSchemaTypeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ComplexSchemaType.ComplexSchemaTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceMetric.GovernanceMetric;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceMetric.GovernanceMetricReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceMetric.GovernanceMetricMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalId.ExternalId;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalId.ExternalIdReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalId.ExternalIdMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Connection.Connection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Connection.ConnectionReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Connection.ConnectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Host.Host;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Host.HostReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Host.HostMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SubscriberList.SubscriberList;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SubscriberList.SubscriberListReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SubscriberList.SubscriberListMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceRule.GovernanceRule;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceRule.GovernanceRuleReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceRule.GovernanceRuleMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MetadataRepositoryCohort.MetadataRepositoryCohort;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MetadataRepositoryCohort.MetadataRepositoryCohortReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.MetadataRepositoryCohort.MetadataRepositoryCohortMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NoteLog.NoteLog;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NoteLog.NoteLogReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.NoteLog.NoteLogMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalGlossaryLink.ExternalGlossaryLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalGlossaryLink.ExternalGlossaryLinkReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.ExternalGlossaryLink.ExternalGlossaryLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.VirtualConnection.VirtualConnection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.VirtualConnection.VirtualConnectionReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.VirtualConnection.VirtualConnectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Regulation.Regulation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Regulation.RegulationReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Regulation.RegulationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceProcess.GovernanceProcess;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceProcess.GovernanceProcessReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GovernanceProcess.GovernanceProcessMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaAttribute.SchemaAttribute;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaAttribute.SchemaAttributeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaAttribute.SchemaAttributeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GraphEdge.GraphEdge;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GraphEdge.GraphEdgeReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.GraphEdge.GraphEdgeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Community.Community;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Community.CommunityReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Community.CommunityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Location.Location;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Location.LocationReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.Location.LocationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.BusinessCapability.BusinessCapability;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.BusinessCapability.BusinessCapabilityReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.BusinessCapability.BusinessCapabilityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaLinkElement.SchemaLinkElement;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaLinkElement.SchemaLinkElementReferences;
import org.odpi.openmetadata.accessservices.subjectarea.generated.entities.SchemaLinkElement.SchemaLinkElementMapper;
// omas relationship specific imports
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.UsedInContext.UsedInContext;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.UsedInContext.UsedInContextMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Leadership.Leadership;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Leadership.LeadershipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedComment.AttachedComment;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedComment.AttachedCommentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ContactThrough.ContactThrough;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ContactThrough.ContactThroughMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.License.License;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.License.LicenseMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ZoneGovernance.ZoneGovernance;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ZoneGovernance.ZoneGovernanceMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.FolderHierarchy.FolderHierarchy;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.FolderHierarchy.FolderHierarchyMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostClusterMember.HostClusterMember;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostClusterMember.HostClusterMemberMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LibraryCategoryReference.LibraryCategoryReference;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LibraryCategoryReference.LibraryCategoryReferenceMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectCharterLink.ProjectCharterLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectCharterLink.ProjectCharterLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProfileIdentity.ProfileIdentity;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProfileIdentity.ProfileIdentityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ToDoSource.ToDoSource;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ToDoSource.ToDoSourceMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Translation.Translation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Translation.TranslationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaLinkToType.SchemaLinkToType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaLinkToType.SchemaLinkToTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CommunityResources.CommunityResources;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CommunityResources.CommunityResourcesMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.DataContentForDataSet.DataContentForDataSet;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.DataContentForDataSet.DataContentForDataSetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ServerEndpoint.ServerEndpoint;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ServerEndpoint.ServerEndpointMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternalIdLink.ExternalIdLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternalIdLink.ExternalIdLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CategoryHierarchyLink.CategoryHierarchyLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CategoryHierarchyLink.CategoryHierarchyLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.PreferredTerm.PreferredTerm;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.PreferredTerm.PreferredTermMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectHierarchy.ProjectHierarchy;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectHierarchy.ProjectHierarchyMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.DeployedVirtualContainer.DeployedVirtualContainer;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.DeployedVirtualContainer.DeployedVirtualContainerMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.BusinessCapabilityResponsibility.BusinessCapabilityResponsibility;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.BusinessCapabilityResponsibility.BusinessCapabilityResponsibilityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectMeeting.ProjectMeeting;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectMeeting.ProjectMeetingMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceResults.GovernanceResults;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceResults.GovernanceResultsMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIResponse.APIResponse;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIResponse.APIResponseMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ServerSupportedCapability.ServerSupportedCapability;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ServerSupportedCapability.ServerSupportedCapabilityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CollectionMember.CollectionMember;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CollectionMember.CollectionMemberMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostNetwork.HostNetwork;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostNetwork.HostNetworkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttributeForSchema.AttributeForSchema;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttributeForSchema.AttributeForSchemaMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AssetLocation.AssetLocation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AssetLocation.AssetLocationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.IsTaxonomy.IsTaxonomy;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.IsTaxonomy.IsTaxonomyMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaAttributeType.SchemaAttributeType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaAttributeType.SchemaAttributeTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceImplementation.GovernanceImplementation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceImplementation.GovernanceImplementationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LinkedMedia.LinkedMedia;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LinkedMedia.LinkedMediaMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MapToElementType.MapToElementType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MapToElementType.MapToElementTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternallySourcedGlossary.ExternallySourcedGlossary;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternallySourcedGlossary.ExternallySourcedGlossaryMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternalReferenceLink.ExternalReferenceLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternalReferenceLink.ExternalReferenceLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MediaReference.MediaReference;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MediaReference.MediaReferenceMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CommunityMembership.CommunityMembership;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CommunityMembership.CommunityMembershipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternalIdScope.ExternalIdScope;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ExternalIdScope.ExternalIdScopeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ValidValue.ValidValue;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ValidValue.ValidValueMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AcceptedAnswer.AcceptedAnswer;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AcceptedAnswer.AcceptedAnswerMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceDefinitionMetric.GovernanceDefinitionMetric;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceDefinitionMetric.GovernanceDefinitionMetricMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaQueryImplementation.SchemaQueryImplementation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaQueryImplementation.SchemaQueryImplementationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AssetSchemaType.AssetSchemaType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AssetSchemaType.AssetSchemaTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectDependency.ProjectDependency;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectDependency.ProjectDependencyMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TopicSubscribers.TopicSubscribers;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TopicSubscribers.TopicSubscribersMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ReplacementTerm.ReplacementTerm;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ReplacementTerm.ReplacementTermMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.OrganizationalCapability.OrganizationalCapability;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.OrganizationalCapability.OrganizationalCapabilityMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MetadataCohortPeer.MetadataCohortPeer;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MetadataCohortPeer.MetadataCohortPeerMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedNoteLogEntry.AttachedNoteLogEntry;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedNoteLogEntry.AttachedNoteLogEntryMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AssetServerUse.AssetServerUse;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AssetServerUse.AssetServerUseMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.RuntimeForProcess.RuntimeForProcess;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.RuntimeForProcess.RuntimeForProcessMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.NestedLocation.NestedLocation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.NestedLocation.NestedLocationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.StaffAssignment.StaffAssignment;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.StaffAssignment.StaffAssignmentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LinkedFile.LinkedFile;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LinkedFile.LinkedFileMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermCategorization.TermCategorization;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermCategorization.TermCategorizationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ZoneMembership.ZoneMembership;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ZoneMembership.ZoneMembershipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIEndpoint.APIEndpoint;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIEndpoint.APIEndpointMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ConnectionEndpoint.ConnectionEndpoint;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ConnectionEndpoint.ConnectionEndpointMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CategoryAnchor.CategoryAnchor;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CategoryAnchor.CategoryAnchorMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectTeam.ProjectTeam;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectTeam.ProjectTeamMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProcessOutput.ProcessOutput;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProcessOutput.ProcessOutputMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIOperations.APIOperations;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIOperations.APIOperationsMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernancePolicyLink.GovernancePolicyLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernancePolicyLink.GovernancePolicyLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ResponsibilityStaffContact.ResponsibilityStaffContact;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ResponsibilityStaffContact.ResponsibilityStaffContactMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Peer.Peer;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Peer.PeerMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermTYPEDBYRelationship.TermTYPEDBYRelationship;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermTYPEDBYRelationship.TermTYPEDBYRelationshipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MapFromElementType.MapFromElementType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MapFromElementType.MapFromElementTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Certification.Certification;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Certification.CertificationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.NetworkGatewayLink.NetworkGatewayLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.NetworkGatewayLink.NetworkGatewayLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ConnectionConnectorType.ConnectionConnectorType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ConnectionConnectorType.ConnectionConnectorTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Synonym.Synonym;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Synonym.SynonymMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Antonym.Antonym;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Antonym.AntonymMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GraphEdgeLink.GraphEdgeLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GraphEdgeLink.GraphEdgeLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ToDoOnReferenceable.ToDoOnReferenceable;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ToDoOnReferenceable.ToDoOnReferenceableMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectScope.ProjectScope;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectScope.ProjectScopeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ISARelationship.ISARelationship;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ISARelationship.ISARelationshipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermISATypeOFRelationship.TermISATypeOFRelationship;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermISATypeOFRelationship.TermISATypeOFRelationshipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Contributor.Contributor;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.Contributor.ContributorMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.EmbeddedConnection.EmbeddedConnection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.EmbeddedConnection.EmbeddedConnectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceControlLink.GovernanceControlLink;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceControlLink.GovernanceControlLinkMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedRating.AttachedRating;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedRating.AttachedRatingMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedNoteLog.AttachedNoteLog;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedNoteLog.AttachedNoteLogMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ConnectionToAsset.ConnectionToAsset;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ConnectionToAsset.ConnectionToAssetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.RegulationCertificationType.RegulationCertificationType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.RegulationCertificationType.RegulationCertificationTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LinkedType.LinkedType;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.LinkedType.LinkedTypeMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceRuleImplementation.GovernanceRuleImplementation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceRuleImplementation.GovernanceRuleImplementationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AdjacentLocation.AdjacentLocation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AdjacentLocation.AdjacentLocationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SemanticAssignment.SemanticAssignment;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SemanticAssignment.SemanticAssignmentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostLocation.HostLocation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostLocation.HostLocationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ServerDeployment.ServerDeployment;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ServerDeployment.ServerDeploymentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.RelatedTerm.RelatedTerm;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.RelatedTerm.RelatedTermMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaTypeImplementation.SchemaTypeImplementation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SchemaTypeImplementation.SchemaTypeImplementationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProcessInput.ProcessInput;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProcessInput.ProcessInputMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIHeader.APIHeader;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIHeader.APIHeaderMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MeetingOnReferenceable.MeetingOnReferenceable;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.MeetingOnReferenceable.MeetingOnReferenceableMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedTag.AttachedTag;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedTag.AttachedTagMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermHASARelationship.TermHASARelationship;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermHASARelationship.TermHASARelationshipMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceProcessImplementation.GovernanceProcessImplementation;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceProcessImplementation.GovernanceProcessImplementationMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GroupedMedia.GroupedMedia;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GroupedMedia.GroupedMediaMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceResponse.GovernanceResponse;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.GovernanceResponse.GovernanceResponseMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.NestedFile.NestedFile;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.NestedFile.NestedFileMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostOperatingPlatform.HostOperatingPlatform;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.HostOperatingPlatform.HostOperatingPlatformMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ActorCollection.ActorCollection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ActorCollection.ActorCollectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermAnchor.TermAnchor;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.TermAnchor.TermAnchorMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectResources.ProjectResources;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ProjectResources.ProjectResourcesMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIRequest.APIRequest;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.APIRequest.APIRequestMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SoftwareComponentDeployment.SoftwareComponentDeployment;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.SoftwareComponentDeployment.SoftwareComponentDeploymentMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CohortMemberMetadataCollection.CohortMemberMetadataCollection;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.CohortMemberMetadataCollection.CohortMemberMetadataCollectionMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ReferenceableFacet.ReferenceableFacet;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.ReferenceableFacet.ReferenceableFacetMapper;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedLike.AttachedLike;
import org.odpi.openmetadata.accessservices.subjectarea.generated.relationships.AttachedLike.AttachedLikeMapper;

/**
 * REST for the Subject Area OMAS. Exposes Rest endpoints for entities including Golossary, Term and Category.
 *
 * The Subject Area OMAS should not have dependancies on Atlas (apart from its package name)- so that it can call other non-Atlas resource services
 * and it will be in OMAG packages without Atlas.
 *
 */

@RestController
@RequestMapping("access-services/subject-area")
public class SubjectAreaOmasREST  {

    private static final Logger log = LoggerFactory.getLogger(SubjectAreaOmasREST.class);
    private static final String className = SubjectAreaOmasREST.class.getName();

    // The OMRSAPIHelper allows the junits to mock out the omrs layer.
    private OMRSAPIHelper oMRSAPIHelper =new OMRSAPIHelper();

    public SubjectAreaOmasREST() {
    }
    public void setOMRSAPIHelper(OMRSAPIHelper oMRSAPIHelper) {
        this.oMRSAPIHelper=oMRSAPIHelper;
    }

    /**
     * Fetch complete definition of an certificationType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the certificationTypes relationships.
     * @param entityGuid GUID for the entity
     * @return CertificationType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/certificationTypes/guid/{entityGuid}")
    public CertificationType getCertificationTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getCertificationTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        CertificationType gotcertificationType = CertificationTypeMapper.mapOmrsEntityDetailToCertificationType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcertificationType );
        }
        return gotcertificationType;

    }
    /**
     * Create new certificationType in Atlas.
     * @param certificationType
     * @return CertificationType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/certificationTypes")
    public CertificationType createCertificationType(@PathVariable String userId,CertificationType certificationType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createCertificationTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("CertificationType");
        if (constraint!=null) {
             constraint.preCreate(certificationType);
        }

        EntityDetail entityDetail = CertificationTypeMapper.mapCertificationTypeToOmrsEntityDetail(certificationType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        CertificationType createdCertificationType =  CertificationTypeMapper.mapOmrsEntityDetailToCertificationType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created CertificationType="+ createdCertificationType );
        }
        return createdCertificationType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/certificationTypes/guid/{certificationTypeGuid}")
    public CertificationType updateCertificationType(@PathVariable String userId,@PathVariable String entityGuid, CertificationType certificationType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateCertificationTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = CertificationTypeMapper.mapCertificationTypeToOmrsEntityDetail(certificationType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            CertificationType updatedCertificationType =  CertificationTypeMapper.mapOmrsEntityDetailToCertificationType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated CertificationType="+ updatedCertificationType );
            }
            return updatedCertificationType;
        }

    /**
     * Delete an certificationType identified by its GUID. Delete is a soft delete, this means that the certificationType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the certificationType
     * @return CertificationType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/certificationTypes/guid/{certificationTypeGuid}")

    public void deleteCertificationTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteCertificationTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeCertificationTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeCertificationTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied certificationType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/certificationTypes/{certificationTypeGuid}/classifications")
    public CertificationType addCertificationTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addCertificationTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         CertificationType certificationTypeClassifications = CertificationTypeMapper.mapOmrsEntityDetailToCertificationType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified CertificationType=" +  certificationTypeClassifications);
         }
         return  certificationTypeClassifications;
    }

    /**
     * Updates classifications to an existing certificationType represented by a guid.
     * @param  entityGuid globally unique identifier for the certificationType
     * @return classification for the given certificationType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/certificationTypes/{certificationTypeGuid}/classification")

    public CertificationType updateCertificationTypeClassification(@PathVariable("userId") String userId,@PathVariable("certificationTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateCertificationTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           CertificationType  certificationTypeClassifications = CertificationTypeMapper.mapOmrsEntityDetailToCertificationType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  certificationTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing certificationType represented by a guid.
     * @param entityGuid  globally unique identifier for the certificationType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/certificationTypes/{certificationTypeGuid}/classification/{name}")
    public CertificationType deleteCertificationTypeClassification(@PathVariable("userId") String userId,@PathVariable("certificationTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteCertificationTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       CertificationType declassifiedCertificationType =  CertificationTypeMapper.mapOmrsEntityDetailToCertificationType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedCertificationType;
    }

    /**
      * Get the relationships associated with entity certificationType represented by a guid.
      * @param entityGuid  globally unique identifier for the certificationType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/certificationTypes/guid/{entityGuid}/relationships")
    public List<Line> getCertificationTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getCertificationTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an aPISchemaType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the aPISchemaTypes relationships.
     * @param entityGuid GUID for the entity
     * @return APISchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/aPISchemaTypes/guid/{entityGuid}")
    public APISchemaType getAPISchemaTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getAPISchemaTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        APISchemaType gotaPISchemaType = APISchemaTypeMapper.mapOmrsEntityDetailToAPISchemaType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotaPISchemaType );
        }
        return gotaPISchemaType;

    }
    /**
     * Create new aPISchemaType in Atlas.
     * @param aPISchemaType
     * @return APISchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/aPISchemaTypes")
    public APISchemaType createAPISchemaType(@PathVariable String userId,APISchemaType aPISchemaType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createAPISchemaTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("APISchemaType");
        if (constraint!=null) {
             constraint.preCreate(aPISchemaType);
        }

        EntityDetail entityDetail = APISchemaTypeMapper.mapAPISchemaTypeToOmrsEntityDetail(aPISchemaType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        APISchemaType createdAPISchemaType =  APISchemaTypeMapper.mapOmrsEntityDetailToAPISchemaType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created APISchemaType="+ createdAPISchemaType );
        }
        return createdAPISchemaType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/aPISchemaTypes/guid/{aPISchemaTypeGuid}")
    public APISchemaType updateAPISchemaType(@PathVariable String userId,@PathVariable String entityGuid, APISchemaType aPISchemaType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateAPISchemaTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = APISchemaTypeMapper.mapAPISchemaTypeToOmrsEntityDetail(aPISchemaType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            APISchemaType updatedAPISchemaType =  APISchemaTypeMapper.mapOmrsEntityDetailToAPISchemaType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated APISchemaType="+ updatedAPISchemaType );
            }
            return updatedAPISchemaType;
        }

    /**
     * Delete an aPISchemaType identified by its GUID. Delete is a soft delete, this means that the aPISchemaType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the aPISchemaType
     * @return APISchemaType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/aPISchemaTypes/guid/{aPISchemaTypeGuid}")

    public void deleteAPISchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteAPISchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeAPISchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeAPISchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied aPISchemaType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/aPISchemaTypes/{aPISchemaTypeGuid}/classifications")
    public APISchemaType addAPISchemaTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addAPISchemaTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         APISchemaType aPISchemaTypeClassifications = APISchemaTypeMapper.mapOmrsEntityDetailToAPISchemaType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified APISchemaType=" +  aPISchemaTypeClassifications);
         }
         return  aPISchemaTypeClassifications;
    }

    /**
     * Updates classifications to an existing aPISchemaType represented by a guid.
     * @param  entityGuid globally unique identifier for the aPISchemaType
     * @return classification for the given aPISchemaType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/aPISchemaTypes/{aPISchemaTypeGuid}/classification")

    public APISchemaType updateAPISchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("aPISchemaTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateAPISchemaTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           APISchemaType  aPISchemaTypeClassifications = APISchemaTypeMapper.mapOmrsEntityDetailToAPISchemaType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  aPISchemaTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing aPISchemaType represented by a guid.
     * @param entityGuid  globally unique identifier for the aPISchemaType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/aPISchemaTypes/{aPISchemaTypeGuid}/classification/{name}")
    public APISchemaType deleteAPISchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("aPISchemaTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteAPISchemaTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       APISchemaType declassifiedAPISchemaType =  APISchemaTypeMapper.mapOmrsEntityDetailToAPISchemaType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedAPISchemaType;
    }

    /**
      * Get the relationships associated with entity aPISchemaType represented by a guid.
      * @param entityGuid  globally unique identifier for the aPISchemaType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/aPISchemaTypes/guid/{entityGuid}/relationships")
    public List<Line> getAPISchemaTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getAPISchemaTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an dataSet given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the dataSets relationships.
     * @param entityGuid GUID for the entity
     * @return DataSet
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/dataSets/guid/{entityGuid}")
    public DataSet getDataSetById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getDataSetById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        DataSet gotdataSet = DataSetMapper.mapOmrsEntityDetailToDataSet(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotdataSet );
        }
        return gotdataSet;

    }
    /**
     * Create new dataSet in Atlas.
     * @param dataSet
     * @return DataSet
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/dataSets")
    public DataSet createDataSet(@PathVariable String userId,DataSet dataSet)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createDataSetById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("DataSet");
        if (constraint!=null) {
             constraint.preCreate(dataSet);
        }

        EntityDetail entityDetail = DataSetMapper.mapDataSetToOmrsEntityDetail(dataSet);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        DataSet createdDataSet =  DataSetMapper.mapOmrsEntityDetailToDataSet(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created DataSet="+ createdDataSet );
        }
        return createdDataSet;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/dataSets/guid/{dataSetGuid}")
    public DataSet updateDataSet(@PathVariable String userId,@PathVariable String entityGuid, DataSet dataSet)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateDataSetById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = DataSetMapper.mapDataSetToOmrsEntityDetail(dataSet);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            DataSet updatedDataSet =  DataSetMapper.mapOmrsEntityDetailToDataSet(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated DataSet="+ updatedDataSet );
            }
            return updatedDataSet;
        }

    /**
     * Delete an dataSet identified by its GUID. Delete is a soft delete, this means that the dataSet has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the dataSet
     * @return DataSet
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/dataSets/guid/{dataSetGuid}")

    public void deleteDataSetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteDataSetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeDataSetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeDataSetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied dataSet
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/dataSets/{dataSetGuid}/classifications")
    public DataSet addDataSetClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addDataSetClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         DataSet dataSetClassifications = DataSetMapper.mapOmrsEntityDetailToDataSet(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified DataSet=" +  dataSetClassifications);
         }
         return  dataSetClassifications;
    }

    /**
     * Updates classifications to an existing dataSet represented by a guid.
     * @param  entityGuid globally unique identifier for the dataSet
     * @return classification for the given dataSet guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/dataSets/{dataSetGuid}/classification")

    public DataSet updateDataSetClassification(@PathVariable("userId") String userId,@PathVariable("dataSetGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateDataSetClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           DataSet  dataSetClassifications = DataSetMapper.mapOmrsEntityDetailToDataSet(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  dataSetClassifications;
    }

    /**
     * Deletes a given classification from an existing dataSet represented by a guid.
     * @param entityGuid  globally unique identifier for the dataSet
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/dataSets/{dataSetGuid}/classification/{name}")
    public DataSet deleteDataSetClassification(@PathVariable("userId") String userId,@PathVariable("dataSetGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteDataSetClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       DataSet declassifiedDataSet =  DataSetMapper.mapOmrsEntityDetailToDataSet(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedDataSet;
    }

    /**
      * Get the relationships associated with entity dataSet represented by a guid.
      * @param entityGuid  globally unique identifier for the dataSet
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/dataSets/guid/{entityGuid}/relationships")
    public List<Line> getDataSetRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getDataSetRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an operatingPlatform given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the operatingPlatforms relationships.
     * @param entityGuid GUID for the entity
     * @return OperatingPlatform
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/operatingPlatforms/guid/{entityGuid}")
    public OperatingPlatform getOperatingPlatformById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getOperatingPlatformById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        OperatingPlatform gotoperatingPlatform = OperatingPlatformMapper.mapOmrsEntityDetailToOperatingPlatform(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotoperatingPlatform );
        }
        return gotoperatingPlatform;

    }
    /**
     * Create new operatingPlatform in Atlas.
     * @param operatingPlatform
     * @return OperatingPlatform
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/operatingPlatforms")
    public OperatingPlatform createOperatingPlatform(@PathVariable String userId,OperatingPlatform operatingPlatform)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createOperatingPlatformById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("OperatingPlatform");
        if (constraint!=null) {
             constraint.preCreate(operatingPlatform);
        }

        EntityDetail entityDetail = OperatingPlatformMapper.mapOperatingPlatformToOmrsEntityDetail(operatingPlatform);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        OperatingPlatform createdOperatingPlatform =  OperatingPlatformMapper.mapOmrsEntityDetailToOperatingPlatform(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created OperatingPlatform="+ createdOperatingPlatform );
        }
        return createdOperatingPlatform;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/operatingPlatforms/guid/{operatingPlatformGuid}")
    public OperatingPlatform updateOperatingPlatform(@PathVariable String userId,@PathVariable String entityGuid, OperatingPlatform operatingPlatform)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateOperatingPlatformById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = OperatingPlatformMapper.mapOperatingPlatformToOmrsEntityDetail(operatingPlatform);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            OperatingPlatform updatedOperatingPlatform =  OperatingPlatformMapper.mapOmrsEntityDetailToOperatingPlatform(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated OperatingPlatform="+ updatedOperatingPlatform );
            }
            return updatedOperatingPlatform;
        }

    /**
     * Delete an operatingPlatform identified by its GUID. Delete is a soft delete, this means that the operatingPlatform has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the operatingPlatform
     * @return OperatingPlatform
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/operatingPlatforms/guid/{operatingPlatformGuid}")

    public void deleteOperatingPlatformByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteOperatingPlatformByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeOperatingPlatformByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeOperatingPlatformByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied operatingPlatform
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/operatingPlatforms/{operatingPlatformGuid}/classifications")
    public OperatingPlatform addOperatingPlatformClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addOperatingPlatformClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         OperatingPlatform operatingPlatformClassifications = OperatingPlatformMapper.mapOmrsEntityDetailToOperatingPlatform(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified OperatingPlatform=" +  operatingPlatformClassifications);
         }
         return  operatingPlatformClassifications;
    }

    /**
     * Updates classifications to an existing operatingPlatform represented by a guid.
     * @param  entityGuid globally unique identifier for the operatingPlatform
     * @return classification for the given operatingPlatform guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/operatingPlatforms/{operatingPlatformGuid}/classification")

    public OperatingPlatform updateOperatingPlatformClassification(@PathVariable("userId") String userId,@PathVariable("operatingPlatformGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateOperatingPlatformClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           OperatingPlatform  operatingPlatformClassifications = OperatingPlatformMapper.mapOmrsEntityDetailToOperatingPlatform(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  operatingPlatformClassifications;
    }

    /**
     * Deletes a given classification from an existing operatingPlatform represented by a guid.
     * @param entityGuid  globally unique identifier for the operatingPlatform
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/operatingPlatforms/{operatingPlatformGuid}/classification/{name}")
    public OperatingPlatform deleteOperatingPlatformClassification(@PathVariable("userId") String userId,@PathVariable("operatingPlatformGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteOperatingPlatformClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       OperatingPlatform declassifiedOperatingPlatform =  OperatingPlatformMapper.mapOmrsEntityDetailToOperatingPlatform(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedOperatingPlatform;
    }

    /**
      * Get the relationships associated with entity operatingPlatform represented by a guid.
      * @param entityGuid  globally unique identifier for the operatingPlatform
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/operatingPlatforms/guid/{entityGuid}/relationships")
    public List<Line> getOperatingPlatformRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getOperatingPlatformRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governancePolicy given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governancePolicies relationships.
     * @param entityGuid GUID for the entity
     * @return GovernancePolicy
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governancePolicies/guid/{entityGuid}")
    public GovernancePolicy getGovernancePolicyById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernancePolicyById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernancePolicy gotgovernancePolicy = GovernancePolicyMapper.mapOmrsEntityDetailToGovernancePolicy(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernancePolicy );
        }
        return gotgovernancePolicy;

    }
    /**
     * Create new governancePolicy in Atlas.
     * @param governancePolicy
     * @return GovernancePolicy
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governancePolicies")
    public GovernancePolicy createGovernancePolicy(@PathVariable String userId,GovernancePolicy governancePolicy)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernancePolicyById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernancePolicy");
        if (constraint!=null) {
             constraint.preCreate(governancePolicy);
        }

        EntityDetail entityDetail = GovernancePolicyMapper.mapGovernancePolicyToOmrsEntityDetail(governancePolicy);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernancePolicy createdGovernancePolicy =  GovernancePolicyMapper.mapOmrsEntityDetailToGovernancePolicy(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernancePolicy="+ createdGovernancePolicy );
        }
        return createdGovernancePolicy;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governancePolicies/guid/{governancePolicyGuid}")
    public GovernancePolicy updateGovernancePolicy(@PathVariable String userId,@PathVariable String entityGuid, GovernancePolicy governancePolicy)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernancePolicyById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernancePolicyMapper.mapGovernancePolicyToOmrsEntityDetail(governancePolicy);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernancePolicy updatedGovernancePolicy =  GovernancePolicyMapper.mapOmrsEntityDetailToGovernancePolicy(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernancePolicy="+ updatedGovernancePolicy );
            }
            return updatedGovernancePolicy;
        }

    /**
     * Delete an governancePolicy identified by its GUID. Delete is a soft delete, this means that the governancePolicy has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governancePolicy
     * @return GovernancePolicy
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governancePolicies/guid/{governancePolicyGuid}")

    public void deleteGovernancePolicyByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernancePolicyByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernancePolicyByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernancePolicyByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governancePolicy
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governancePolicies/{governancePolicyGuid}/classifications")
    public GovernancePolicy addGovernancePolicyClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernancePolicyClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernancePolicy governancePolicyClassifications = GovernancePolicyMapper.mapOmrsEntityDetailToGovernancePolicy(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernancePolicy=" +  governancePolicyClassifications);
         }
         return  governancePolicyClassifications;
    }

    /**
     * Updates classifications to an existing governancePolicy represented by a guid.
     * @param  entityGuid globally unique identifier for the governancePolicy
     * @return classification for the given governancePolicy guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governancePolicies/{governancePolicyGuid}/classification")

    public GovernancePolicy updateGovernancePolicyClassification(@PathVariable("userId") String userId,@PathVariable("governancePolicyGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernancePolicyClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernancePolicy  governancePolicyClassifications = GovernancePolicyMapper.mapOmrsEntityDetailToGovernancePolicy(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governancePolicyClassifications;
    }

    /**
     * Deletes a given classification from an existing governancePolicy represented by a guid.
     * @param entityGuid  globally unique identifier for the governancePolicy
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governancePolicies/{governancePolicyGuid}/classification/{name}")
    public GovernancePolicy deleteGovernancePolicyClassification(@PathVariable("userId") String userId,@PathVariable("governancePolicyGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernancePolicyClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernancePolicy declassifiedGovernancePolicy =  GovernancePolicyMapper.mapOmrsEntityDetailToGovernancePolicy(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernancePolicy;
    }

    /**
      * Get the relationships associated with entity governancePolicy represented by a guid.
      * @param entityGuid  globally unique identifier for the governancePolicy
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governancePolicies/guid/{entityGuid}/relationships")
    public List<Line> getGovernancePolicyRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernancePolicyRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an derivedSchemaAttribute given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the derivedSchemaAttributes relationships.
     * @param entityGuid GUID for the entity
     * @return DerivedSchemaAttribute
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/derivedSchemaAttributes/guid/{entityGuid}")
    public DerivedSchemaAttribute getDerivedSchemaAttributeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getDerivedSchemaAttributeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        DerivedSchemaAttribute gotderivedSchemaAttribute = DerivedSchemaAttributeMapper.mapOmrsEntityDetailToDerivedSchemaAttribute(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotderivedSchemaAttribute );
        }
        return gotderivedSchemaAttribute;

    }
    /**
     * Create new derivedSchemaAttribute in Atlas.
     * @param derivedSchemaAttribute
     * @return DerivedSchemaAttribute
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/derivedSchemaAttributes")
    public DerivedSchemaAttribute createDerivedSchemaAttribute(@PathVariable String userId,DerivedSchemaAttribute derivedSchemaAttribute)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createDerivedSchemaAttributeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("DerivedSchemaAttribute");
        if (constraint!=null) {
             constraint.preCreate(derivedSchemaAttribute);
        }

        EntityDetail entityDetail = DerivedSchemaAttributeMapper.mapDerivedSchemaAttributeToOmrsEntityDetail(derivedSchemaAttribute);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        DerivedSchemaAttribute createdDerivedSchemaAttribute =  DerivedSchemaAttributeMapper.mapOmrsEntityDetailToDerivedSchemaAttribute(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created DerivedSchemaAttribute="+ createdDerivedSchemaAttribute );
        }
        return createdDerivedSchemaAttribute;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/derivedSchemaAttributes/guid/{derivedSchemaAttributeGuid}")
    public DerivedSchemaAttribute updateDerivedSchemaAttribute(@PathVariable String userId,@PathVariable String entityGuid, DerivedSchemaAttribute derivedSchemaAttribute)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateDerivedSchemaAttributeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = DerivedSchemaAttributeMapper.mapDerivedSchemaAttributeToOmrsEntityDetail(derivedSchemaAttribute);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            DerivedSchemaAttribute updatedDerivedSchemaAttribute =  DerivedSchemaAttributeMapper.mapOmrsEntityDetailToDerivedSchemaAttribute(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated DerivedSchemaAttribute="+ updatedDerivedSchemaAttribute );
            }
            return updatedDerivedSchemaAttribute;
        }

    /**
     * Delete an derivedSchemaAttribute identified by its GUID. Delete is a soft delete, this means that the derivedSchemaAttribute has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the derivedSchemaAttribute
     * @return DerivedSchemaAttribute
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/derivedSchemaAttributes/guid/{derivedSchemaAttributeGuid}")

    public void deleteDerivedSchemaAttributeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteDerivedSchemaAttributeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeDerivedSchemaAttributeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeDerivedSchemaAttributeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied derivedSchemaAttribute
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/derivedSchemaAttributes/{derivedSchemaAttributeGuid}/classifications")
    public DerivedSchemaAttribute addDerivedSchemaAttributeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addDerivedSchemaAttributeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         DerivedSchemaAttribute derivedSchemaAttributeClassifications = DerivedSchemaAttributeMapper.mapOmrsEntityDetailToDerivedSchemaAttribute(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified DerivedSchemaAttribute=" +  derivedSchemaAttributeClassifications);
         }
         return  derivedSchemaAttributeClassifications;
    }

    /**
     * Updates classifications to an existing derivedSchemaAttribute represented by a guid.
     * @param  entityGuid globally unique identifier for the derivedSchemaAttribute
     * @return classification for the given derivedSchemaAttribute guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/derivedSchemaAttributes/{derivedSchemaAttributeGuid}/classification")

    public DerivedSchemaAttribute updateDerivedSchemaAttributeClassification(@PathVariable("userId") String userId,@PathVariable("derivedSchemaAttributeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateDerivedSchemaAttributeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           DerivedSchemaAttribute  derivedSchemaAttributeClassifications = DerivedSchemaAttributeMapper.mapOmrsEntityDetailToDerivedSchemaAttribute(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  derivedSchemaAttributeClassifications;
    }

    /**
     * Deletes a given classification from an existing derivedSchemaAttribute represented by a guid.
     * @param entityGuid  globally unique identifier for the derivedSchemaAttribute
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/derivedSchemaAttributes/{derivedSchemaAttributeGuid}/classification/{name}")
    public DerivedSchemaAttribute deleteDerivedSchemaAttributeClassification(@PathVariable("userId") String userId,@PathVariable("derivedSchemaAttributeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteDerivedSchemaAttributeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       DerivedSchemaAttribute declassifiedDerivedSchemaAttribute =  DerivedSchemaAttributeMapper.mapOmrsEntityDetailToDerivedSchemaAttribute(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedDerivedSchemaAttribute;
    }

    /**
      * Get the relationships associated with entity derivedSchemaAttribute represented by a guid.
      * @param entityGuid  globally unique identifier for the derivedSchemaAttribute
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/derivedSchemaAttributes/guid/{entityGuid}/relationships")
    public List<Line> getDerivedSchemaAttributeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getDerivedSchemaAttributeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an process given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the processes relationships.
     * @param entityGuid GUID for the entity
     * @return Process
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/processes/guid/{entityGuid}")
    public Process getProcessById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getProcessById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Process gotprocess = ProcessMapper.mapOmrsEntityDetailToProcess(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotprocess );
        }
        return gotprocess;

    }
    /**
     * Create new process in Atlas.
     * @param process
     * @return Process
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/processes")
    public Process createProcess(@PathVariable String userId,Process process)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createProcessById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Process");
        if (constraint!=null) {
             constraint.preCreate(process);
        }

        EntityDetail entityDetail = ProcessMapper.mapProcessToOmrsEntityDetail(process);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Process createdProcess =  ProcessMapper.mapOmrsEntityDetailToProcess(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Process="+ createdProcess );
        }
        return createdProcess;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/processes/guid/{processGuid}")
    public Process updateProcess(@PathVariable String userId,@PathVariable String entityGuid, Process process)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateProcessById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ProcessMapper.mapProcessToOmrsEntityDetail(process);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Process updatedProcess =  ProcessMapper.mapOmrsEntityDetailToProcess(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Process="+ updatedProcess );
            }
            return updatedProcess;
        }

    /**
     * Delete an process identified by its GUID. Delete is a soft delete, this means that the process has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the process
     * @return Process
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/processes/guid/{processGuid}")

    public void deleteProcessByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteProcessByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeProcessByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeProcessByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied process
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/processes/{processGuid}/classifications")
    public Process addProcessClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addProcessClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Process processClassifications = ProcessMapper.mapOmrsEntityDetailToProcess(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Process=" +  processClassifications);
         }
         return  processClassifications;
    }

    /**
     * Updates classifications to an existing process represented by a guid.
     * @param  entityGuid globally unique identifier for the process
     * @return classification for the given process guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/processes/{processGuid}/classification")

    public Process updateProcessClassification(@PathVariable("userId") String userId,@PathVariable("processGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateProcessClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Process  processClassifications = ProcessMapper.mapOmrsEntityDetailToProcess(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  processClassifications;
    }

    /**
     * Deletes a given classification from an existing process represented by a guid.
     * @param entityGuid  globally unique identifier for the process
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/processes/{processGuid}/classification/{name}")
    public Process deleteProcessClassification(@PathVariable("userId") String userId,@PathVariable("processGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteProcessClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Process declassifiedProcess =  ProcessMapper.mapOmrsEntityDetailToProcess(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedProcess;
    }

    /**
      * Get the relationships associated with entity process represented by a guid.
      * @param entityGuid  globally unique identifier for the process
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/processes/guid/{entityGuid}/relationships")
    public List<Line> getProcessRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getProcessRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an mapSchemaType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the mapSchemaTypes relationships.
     * @param entityGuid GUID for the entity
     * @return MapSchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/mapSchemaTypes/guid/{entityGuid}")
    public MapSchemaType getMapSchemaTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getMapSchemaTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        MapSchemaType gotmapSchemaType = MapSchemaTypeMapper.mapOmrsEntityDetailToMapSchemaType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotmapSchemaType );
        }
        return gotmapSchemaType;

    }
    /**
     * Create new mapSchemaType in Atlas.
     * @param mapSchemaType
     * @return MapSchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/mapSchemaTypes")
    public MapSchemaType createMapSchemaType(@PathVariable String userId,MapSchemaType mapSchemaType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createMapSchemaTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("MapSchemaType");
        if (constraint!=null) {
             constraint.preCreate(mapSchemaType);
        }

        EntityDetail entityDetail = MapSchemaTypeMapper.mapMapSchemaTypeToOmrsEntityDetail(mapSchemaType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        MapSchemaType createdMapSchemaType =  MapSchemaTypeMapper.mapOmrsEntityDetailToMapSchemaType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created MapSchemaType="+ createdMapSchemaType );
        }
        return createdMapSchemaType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/mapSchemaTypes/guid/{mapSchemaTypeGuid}")
    public MapSchemaType updateMapSchemaType(@PathVariable String userId,@PathVariable String entityGuid, MapSchemaType mapSchemaType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateMapSchemaTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = MapSchemaTypeMapper.mapMapSchemaTypeToOmrsEntityDetail(mapSchemaType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            MapSchemaType updatedMapSchemaType =  MapSchemaTypeMapper.mapOmrsEntityDetailToMapSchemaType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated MapSchemaType="+ updatedMapSchemaType );
            }
            return updatedMapSchemaType;
        }

    /**
     * Delete an mapSchemaType identified by its GUID. Delete is a soft delete, this means that the mapSchemaType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the mapSchemaType
     * @return MapSchemaType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/mapSchemaTypes/guid/{mapSchemaTypeGuid}")

    public void deleteMapSchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteMapSchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeMapSchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeMapSchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied mapSchemaType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/mapSchemaTypes/{mapSchemaTypeGuid}/classifications")
    public MapSchemaType addMapSchemaTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addMapSchemaTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         MapSchemaType mapSchemaTypeClassifications = MapSchemaTypeMapper.mapOmrsEntityDetailToMapSchemaType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified MapSchemaType=" +  mapSchemaTypeClassifications);
         }
         return  mapSchemaTypeClassifications;
    }

    /**
     * Updates classifications to an existing mapSchemaType represented by a guid.
     * @param  entityGuid globally unique identifier for the mapSchemaType
     * @return classification for the given mapSchemaType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/mapSchemaTypes/{mapSchemaTypeGuid}/classification")

    public MapSchemaType updateMapSchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("mapSchemaTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateMapSchemaTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           MapSchemaType  mapSchemaTypeClassifications = MapSchemaTypeMapper.mapOmrsEntityDetailToMapSchemaType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  mapSchemaTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing mapSchemaType represented by a guid.
     * @param entityGuid  globally unique identifier for the mapSchemaType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/mapSchemaTypes/{mapSchemaTypeGuid}/classification/{name}")
    public MapSchemaType deleteMapSchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("mapSchemaTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteMapSchemaTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       MapSchemaType declassifiedMapSchemaType =  MapSchemaTypeMapper.mapOmrsEntityDetailToMapSchemaType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedMapSchemaType;
    }

    /**
      * Get the relationships associated with entity mapSchemaType represented by a guid.
      * @param entityGuid  globally unique identifier for the mapSchemaType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/mapSchemaTypes/guid/{entityGuid}/relationships")
    public List<Line> getMapSchemaTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getMapSchemaTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an deployedSoftwareComponent given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the deployedSoftwareComponents relationships.
     * @param entityGuid GUID for the entity
     * @return DeployedSoftwareComponent
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/deployedSoftwareComponents/guid/{entityGuid}")
    public DeployedSoftwareComponent getDeployedSoftwareComponentById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getDeployedSoftwareComponentById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        DeployedSoftwareComponent gotdeployedSoftwareComponent = DeployedSoftwareComponentMapper.mapOmrsEntityDetailToDeployedSoftwareComponent(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotdeployedSoftwareComponent );
        }
        return gotdeployedSoftwareComponent;

    }
    /**
     * Create new deployedSoftwareComponent in Atlas.
     * @param deployedSoftwareComponent
     * @return DeployedSoftwareComponent
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/deployedSoftwareComponents")
    public DeployedSoftwareComponent createDeployedSoftwareComponent(@PathVariable String userId,DeployedSoftwareComponent deployedSoftwareComponent)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createDeployedSoftwareComponentById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("DeployedSoftwareComponent");
        if (constraint!=null) {
             constraint.preCreate(deployedSoftwareComponent);
        }

        EntityDetail entityDetail = DeployedSoftwareComponentMapper.mapDeployedSoftwareComponentToOmrsEntityDetail(deployedSoftwareComponent);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        DeployedSoftwareComponent createdDeployedSoftwareComponent =  DeployedSoftwareComponentMapper.mapOmrsEntityDetailToDeployedSoftwareComponent(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created DeployedSoftwareComponent="+ createdDeployedSoftwareComponent );
        }
        return createdDeployedSoftwareComponent;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/deployedSoftwareComponents/guid/{deployedSoftwareComponentGuid}")
    public DeployedSoftwareComponent updateDeployedSoftwareComponent(@PathVariable String userId,@PathVariable String entityGuid, DeployedSoftwareComponent deployedSoftwareComponent)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateDeployedSoftwareComponentById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = DeployedSoftwareComponentMapper.mapDeployedSoftwareComponentToOmrsEntityDetail(deployedSoftwareComponent);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            DeployedSoftwareComponent updatedDeployedSoftwareComponent =  DeployedSoftwareComponentMapper.mapOmrsEntityDetailToDeployedSoftwareComponent(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated DeployedSoftwareComponent="+ updatedDeployedSoftwareComponent );
            }
            return updatedDeployedSoftwareComponent;
        }

    /**
     * Delete an deployedSoftwareComponent identified by its GUID. Delete is a soft delete, this means that the deployedSoftwareComponent has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the deployedSoftwareComponent
     * @return DeployedSoftwareComponent
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/deployedSoftwareComponents/guid/{deployedSoftwareComponentGuid}")

    public void deleteDeployedSoftwareComponentByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteDeployedSoftwareComponentByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeDeployedSoftwareComponentByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeDeployedSoftwareComponentByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied deployedSoftwareComponent
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/deployedSoftwareComponents/{deployedSoftwareComponentGuid}/classifications")
    public DeployedSoftwareComponent addDeployedSoftwareComponentClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addDeployedSoftwareComponentClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         DeployedSoftwareComponent deployedSoftwareComponentClassifications = DeployedSoftwareComponentMapper.mapOmrsEntityDetailToDeployedSoftwareComponent(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified DeployedSoftwareComponent=" +  deployedSoftwareComponentClassifications);
         }
         return  deployedSoftwareComponentClassifications;
    }

    /**
     * Updates classifications to an existing deployedSoftwareComponent represented by a guid.
     * @param  entityGuid globally unique identifier for the deployedSoftwareComponent
     * @return classification for the given deployedSoftwareComponent guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/deployedSoftwareComponents/{deployedSoftwareComponentGuid}/classification")

    public DeployedSoftwareComponent updateDeployedSoftwareComponentClassification(@PathVariable("userId") String userId,@PathVariable("deployedSoftwareComponentGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateDeployedSoftwareComponentClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           DeployedSoftwareComponent  deployedSoftwareComponentClassifications = DeployedSoftwareComponentMapper.mapOmrsEntityDetailToDeployedSoftwareComponent(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  deployedSoftwareComponentClassifications;
    }

    /**
     * Deletes a given classification from an existing deployedSoftwareComponent represented by a guid.
     * @param entityGuid  globally unique identifier for the deployedSoftwareComponent
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/deployedSoftwareComponents/{deployedSoftwareComponentGuid}/classification/{name}")
    public DeployedSoftwareComponent deleteDeployedSoftwareComponentClassification(@PathVariable("userId") String userId,@PathVariable("deployedSoftwareComponentGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteDeployedSoftwareComponentClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       DeployedSoftwareComponent declassifiedDeployedSoftwareComponent =  DeployedSoftwareComponentMapper.mapOmrsEntityDetailToDeployedSoftwareComponent(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedDeployedSoftwareComponent;
    }

    /**
      * Get the relationships associated with entity deployedSoftwareComponent represented by a guid.
      * @param entityGuid  globally unique identifier for the deployedSoftwareComponent
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/deployedSoftwareComponents/guid/{entityGuid}/relationships")
    public List<Line> getDeployedSoftwareComponentRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getDeployedSoftwareComponentRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an schemaType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the schemaTypes relationships.
     * @param entityGuid GUID for the entity
     * @return SchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/schemaTypes/guid/{entityGuid}")
    public SchemaType getSchemaTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getSchemaTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        SchemaType gotschemaType = SchemaTypeMapper.mapOmrsEntityDetailToSchemaType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotschemaType );
        }
        return gotschemaType;

    }
    /**
     * Create new schemaType in Atlas.
     * @param schemaType
     * @return SchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/schemaTypes")
    public SchemaType createSchemaType(@PathVariable String userId,SchemaType schemaType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createSchemaTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("SchemaType");
        if (constraint!=null) {
             constraint.preCreate(schemaType);
        }

        EntityDetail entityDetail = SchemaTypeMapper.mapSchemaTypeToOmrsEntityDetail(schemaType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        SchemaType createdSchemaType =  SchemaTypeMapper.mapOmrsEntityDetailToSchemaType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created SchemaType="+ createdSchemaType );
        }
        return createdSchemaType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/schemaTypes/guid/{schemaTypeGuid}")
    public SchemaType updateSchemaType(@PathVariable String userId,@PathVariable String entityGuid, SchemaType schemaType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateSchemaTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = SchemaTypeMapper.mapSchemaTypeToOmrsEntityDetail(schemaType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            SchemaType updatedSchemaType =  SchemaTypeMapper.mapOmrsEntityDetailToSchemaType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated SchemaType="+ updatedSchemaType );
            }
            return updatedSchemaType;
        }

    /**
     * Delete an schemaType identified by its GUID. Delete is a soft delete, this means that the schemaType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the schemaType
     * @return SchemaType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/schemaTypes/guid/{schemaTypeGuid}")

    public void deleteSchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteSchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeSchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeSchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied schemaType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/schemaTypes/{schemaTypeGuid}/classifications")
    public SchemaType addSchemaTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addSchemaTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         SchemaType schemaTypeClassifications = SchemaTypeMapper.mapOmrsEntityDetailToSchemaType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified SchemaType=" +  schemaTypeClassifications);
         }
         return  schemaTypeClassifications;
    }

    /**
     * Updates classifications to an existing schemaType represented by a guid.
     * @param  entityGuid globally unique identifier for the schemaType
     * @return classification for the given schemaType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/schemaTypes/{schemaTypeGuid}/classification")

    public SchemaType updateSchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("schemaTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateSchemaTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           SchemaType  schemaTypeClassifications = SchemaTypeMapper.mapOmrsEntityDetailToSchemaType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  schemaTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing schemaType represented by a guid.
     * @param entityGuid  globally unique identifier for the schemaType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/schemaTypes/{schemaTypeGuid}/classification/{name}")
    public SchemaType deleteSchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("schemaTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteSchemaTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       SchemaType declassifiedSchemaType =  SchemaTypeMapper.mapOmrsEntityDetailToSchemaType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedSchemaType;
    }

    /**
      * Get the relationships associated with entity schemaType represented by a guid.
      * @param entityGuid  globally unique identifier for the schemaType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/schemaTypes/guid/{entityGuid}/relationships")
    public List<Line> getSchemaTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getSchemaTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an dataFile given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the dataFiles relationships.
     * @param entityGuid GUID for the entity
     * @return DataFile
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/dataFiles/guid/{entityGuid}")
    public DataFile getDataFileById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getDataFileById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        DataFile gotdataFile = DataFileMapper.mapOmrsEntityDetailToDataFile(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotdataFile );
        }
        return gotdataFile;

    }
    /**
     * Create new dataFile in Atlas.
     * @param dataFile
     * @return DataFile
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/dataFiles")
    public DataFile createDataFile(@PathVariable String userId,DataFile dataFile)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createDataFileById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("DataFile");
        if (constraint!=null) {
             constraint.preCreate(dataFile);
        }

        EntityDetail entityDetail = DataFileMapper.mapDataFileToOmrsEntityDetail(dataFile);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        DataFile createdDataFile =  DataFileMapper.mapOmrsEntityDetailToDataFile(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created DataFile="+ createdDataFile );
        }
        return createdDataFile;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/dataFiles/guid/{dataFileGuid}")
    public DataFile updateDataFile(@PathVariable String userId,@PathVariable String entityGuid, DataFile dataFile)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateDataFileById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = DataFileMapper.mapDataFileToOmrsEntityDetail(dataFile);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            DataFile updatedDataFile =  DataFileMapper.mapOmrsEntityDetailToDataFile(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated DataFile="+ updatedDataFile );
            }
            return updatedDataFile;
        }

    /**
     * Delete an dataFile identified by its GUID. Delete is a soft delete, this means that the dataFile has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the dataFile
     * @return DataFile
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/dataFiles/guid/{dataFileGuid}")

    public void deleteDataFileByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteDataFileByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeDataFileByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeDataFileByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied dataFile
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/dataFiles/{dataFileGuid}/classifications")
    public DataFile addDataFileClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addDataFileClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         DataFile dataFileClassifications = DataFileMapper.mapOmrsEntityDetailToDataFile(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified DataFile=" +  dataFileClassifications);
         }
         return  dataFileClassifications;
    }

    /**
     * Updates classifications to an existing dataFile represented by a guid.
     * @param  entityGuid globally unique identifier for the dataFile
     * @return classification for the given dataFile guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/dataFiles/{dataFileGuid}/classification")

    public DataFile updateDataFileClassification(@PathVariable("userId") String userId,@PathVariable("dataFileGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateDataFileClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           DataFile  dataFileClassifications = DataFileMapper.mapOmrsEntityDetailToDataFile(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  dataFileClassifications;
    }

    /**
     * Deletes a given classification from an existing dataFile represented by a guid.
     * @param entityGuid  globally unique identifier for the dataFile
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/dataFiles/{dataFileGuid}/classification/{name}")
    public DataFile deleteDataFileClassification(@PathVariable("userId") String userId,@PathVariable("dataFileGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteDataFileClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       DataFile declassifiedDataFile =  DataFileMapper.mapOmrsEntityDetailToDataFile(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedDataFile;
    }

    /**
      * Get the relationships associated with entity dataFile represented by a guid.
      * @param entityGuid  globally unique identifier for the dataFile
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/dataFiles/guid/{entityGuid}/relationships")
    public List<Line> getDataFileRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getDataFileRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an like given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the likes relationships.
     * @param entityGuid GUID for the entity
     * @return Like
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/likes/guid/{entityGuid}")
    public Like getLikeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getLikeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Like gotlike = LikeMapper.mapOmrsEntityDetailToLike(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotlike );
        }
        return gotlike;

    }
    /**
     * Create new like in Atlas.
     * @param like
     * @return Like
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/likes")
    public Like createLike(@PathVariable String userId,Like like)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createLikeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Like");
        if (constraint!=null) {
             constraint.preCreate(like);
        }

        EntityDetail entityDetail = LikeMapper.mapLikeToOmrsEntityDetail(like);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Like createdLike =  LikeMapper.mapOmrsEntityDetailToLike(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Like="+ createdLike );
        }
        return createdLike;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/likes/guid/{likeGuid}")
    public Like updateLike(@PathVariable String userId,@PathVariable String entityGuid, Like like)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateLikeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = LikeMapper.mapLikeToOmrsEntityDetail(like);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Like updatedLike =  LikeMapper.mapOmrsEntityDetailToLike(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Like="+ updatedLike );
            }
            return updatedLike;
        }

    /**
     * Delete an like identified by its GUID. Delete is a soft delete, this means that the like has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the like
     * @return Like
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/likes/guid/{likeGuid}")

    public void deleteLikeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteLikeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeLikeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeLikeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied like
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/likes/{likeGuid}/classifications")
    public Like addLikeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addLikeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Like likeClassifications = LikeMapper.mapOmrsEntityDetailToLike(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Like=" +  likeClassifications);
         }
         return  likeClassifications;
    }

    /**
     * Updates classifications to an existing like represented by a guid.
     * @param  entityGuid globally unique identifier for the like
     * @return classification for the given like guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/likes/{likeGuid}/classification")

    public Like updateLikeClassification(@PathVariable("userId") String userId,@PathVariable("likeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateLikeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Like  likeClassifications = LikeMapper.mapOmrsEntityDetailToLike(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  likeClassifications;
    }

    /**
     * Deletes a given classification from an existing like represented by a guid.
     * @param entityGuid  globally unique identifier for the like
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/likes/{likeGuid}/classification/{name}")
    public Like deleteLikeClassification(@PathVariable("userId") String userId,@PathVariable("likeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteLikeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Like declassifiedLike =  LikeMapper.mapOmrsEntityDetailToLike(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedLike;
    }

    /**
      * Get the relationships associated with entity like represented by a guid.
      * @param entityGuid  globally unique identifier for the like
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/likes/guid/{entityGuid}/relationships")
    public List<Line> getLikeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getLikeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an referenceable given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the referenceables relationships.
     * @param entityGuid GUID for the entity
     * @return Referenceable
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/referenceables/guid/{entityGuid}")
    public Referenceable getReferenceableById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getReferenceableById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Referenceable gotreferenceable = ReferenceableMapper.mapOmrsEntityDetailToReferenceable(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotreferenceable );
        }
        return gotreferenceable;

    }
    /**
     * Create new referenceable in Atlas.
     * @param referenceable
     * @return Referenceable
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/referenceables")
    public Referenceable createReferenceable(@PathVariable String userId,Referenceable referenceable)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createReferenceableById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Referenceable");
        if (constraint!=null) {
             constraint.preCreate(referenceable);
        }

        EntityDetail entityDetail = ReferenceableMapper.mapReferenceableToOmrsEntityDetail(referenceable);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Referenceable createdReferenceable =  ReferenceableMapper.mapOmrsEntityDetailToReferenceable(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Referenceable="+ createdReferenceable );
        }
        return createdReferenceable;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/referenceables/guid/{referenceableGuid}")
    public Referenceable updateReferenceable(@PathVariable String userId,@PathVariable String entityGuid, Referenceable referenceable)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateReferenceableById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ReferenceableMapper.mapReferenceableToOmrsEntityDetail(referenceable);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Referenceable updatedReferenceable =  ReferenceableMapper.mapOmrsEntityDetailToReferenceable(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Referenceable="+ updatedReferenceable );
            }
            return updatedReferenceable;
        }

    /**
     * Delete an referenceable identified by its GUID. Delete is a soft delete, this means that the referenceable has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the referenceable
     * @return Referenceable
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/referenceables/guid/{referenceableGuid}")

    public void deleteReferenceableByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteReferenceableByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeReferenceableByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeReferenceableByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied referenceable
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/referenceables/{referenceableGuid}/classifications")
    public Referenceable addReferenceableClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addReferenceableClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Referenceable referenceableClassifications = ReferenceableMapper.mapOmrsEntityDetailToReferenceable(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Referenceable=" +  referenceableClassifications);
         }
         return  referenceableClassifications;
    }

    /**
     * Updates classifications to an existing referenceable represented by a guid.
     * @param  entityGuid globally unique identifier for the referenceable
     * @return classification for the given referenceable guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/referenceables/{referenceableGuid}/classification")

    public Referenceable updateReferenceableClassification(@PathVariable("userId") String userId,@PathVariable("referenceableGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateReferenceableClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Referenceable  referenceableClassifications = ReferenceableMapper.mapOmrsEntityDetailToReferenceable(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  referenceableClassifications;
    }

    /**
     * Deletes a given classification from an existing referenceable represented by a guid.
     * @param entityGuid  globally unique identifier for the referenceable
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/referenceables/{referenceableGuid}/classification/{name}")
    public Referenceable deleteReferenceableClassification(@PathVariable("userId") String userId,@PathVariable("referenceableGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteReferenceableClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Referenceable declassifiedReferenceable =  ReferenceableMapper.mapOmrsEntityDetailToReferenceable(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedReferenceable;
    }

    /**
      * Get the relationships associated with entity referenceable represented by a guid.
      * @param entityGuid  globally unique identifier for the referenceable
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/referenceables/guid/{entityGuid}/relationships")
    public List<Line> getReferenceableRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getReferenceableRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an externalReference given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the externalReferences relationships.
     * @param entityGuid GUID for the entity
     * @return ExternalReference
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/externalReferences/guid/{entityGuid}")
    public ExternalReference getExternalReferenceById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getExternalReferenceById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ExternalReference gotexternalReference = ExternalReferenceMapper.mapOmrsEntityDetailToExternalReference(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotexternalReference );
        }
        return gotexternalReference;

    }
    /**
     * Create new externalReference in Atlas.
     * @param externalReference
     * @return ExternalReference
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/externalReferences")
    public ExternalReference createExternalReference(@PathVariable String userId,ExternalReference externalReference)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createExternalReferenceById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ExternalReference");
        if (constraint!=null) {
             constraint.preCreate(externalReference);
        }

        EntityDetail entityDetail = ExternalReferenceMapper.mapExternalReferenceToOmrsEntityDetail(externalReference);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ExternalReference createdExternalReference =  ExternalReferenceMapper.mapOmrsEntityDetailToExternalReference(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ExternalReference="+ createdExternalReference );
        }
        return createdExternalReference;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/externalReferences/guid/{externalReferenceGuid}")
    public ExternalReference updateExternalReference(@PathVariable String userId,@PathVariable String entityGuid, ExternalReference externalReference)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateExternalReferenceById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ExternalReferenceMapper.mapExternalReferenceToOmrsEntityDetail(externalReference);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ExternalReference updatedExternalReference =  ExternalReferenceMapper.mapOmrsEntityDetailToExternalReference(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ExternalReference="+ updatedExternalReference );
            }
            return updatedExternalReference;
        }

    /**
     * Delete an externalReference identified by its GUID. Delete is a soft delete, this means that the externalReference has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the externalReference
     * @return ExternalReference
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/externalReferences/guid/{externalReferenceGuid}")

    public void deleteExternalReferenceByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteExternalReferenceByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeExternalReferenceByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeExternalReferenceByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied externalReference
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/externalReferences/{externalReferenceGuid}/classifications")
    public ExternalReference addExternalReferenceClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addExternalReferenceClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ExternalReference externalReferenceClassifications = ExternalReferenceMapper.mapOmrsEntityDetailToExternalReference(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ExternalReference=" +  externalReferenceClassifications);
         }
         return  externalReferenceClassifications;
    }

    /**
     * Updates classifications to an existing externalReference represented by a guid.
     * @param  entityGuid globally unique identifier for the externalReference
     * @return classification for the given externalReference guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/externalReferences/{externalReferenceGuid}/classification")

    public ExternalReference updateExternalReferenceClassification(@PathVariable("userId") String userId,@PathVariable("externalReferenceGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateExternalReferenceClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ExternalReference  externalReferenceClassifications = ExternalReferenceMapper.mapOmrsEntityDetailToExternalReference(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  externalReferenceClassifications;
    }

    /**
     * Deletes a given classification from an existing externalReference represented by a guid.
     * @param entityGuid  globally unique identifier for the externalReference
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/externalReferences/{externalReferenceGuid}/classification/{name}")
    public ExternalReference deleteExternalReferenceClassification(@PathVariable("userId") String userId,@PathVariable("externalReferenceGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteExternalReferenceClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ExternalReference declassifiedExternalReference =  ExternalReferenceMapper.mapOmrsEntityDetailToExternalReference(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedExternalReference;
    }

    /**
      * Get the relationships associated with entity externalReference represented by a guid.
      * @param entityGuid  globally unique identifier for the externalReference
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/externalReferences/guid/{entityGuid}/relationships")
    public List<Line> getExternalReferenceRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getExternalReferenceRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an endpoint given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the endpoints relationships.
     * @param entityGuid GUID for the entity
     * @return Endpoint
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/endpoints/guid/{entityGuid}")
    public Endpoint getEndpointById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getEndpointById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Endpoint gotendpoint = EndpointMapper.mapOmrsEntityDetailToEndpoint(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotendpoint );
        }
        return gotendpoint;

    }
    /**
     * Create new endpoint in Atlas.
     * @param endpoint
     * @return Endpoint
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/endpoints")
    public Endpoint createEndpoint(@PathVariable String userId,Endpoint endpoint)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createEndpointById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Endpoint");
        if (constraint!=null) {
             constraint.preCreate(endpoint);
        }

        EntityDetail entityDetail = EndpointMapper.mapEndpointToOmrsEntityDetail(endpoint);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Endpoint createdEndpoint =  EndpointMapper.mapOmrsEntityDetailToEndpoint(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Endpoint="+ createdEndpoint );
        }
        return createdEndpoint;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/endpoints/guid/{endpointGuid}")
    public Endpoint updateEndpoint(@PathVariable String userId,@PathVariable String entityGuid, Endpoint endpoint)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateEndpointById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = EndpointMapper.mapEndpointToOmrsEntityDetail(endpoint);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Endpoint updatedEndpoint =  EndpointMapper.mapOmrsEntityDetailToEndpoint(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Endpoint="+ updatedEndpoint );
            }
            return updatedEndpoint;
        }

    /**
     * Delete an endpoint identified by its GUID. Delete is a soft delete, this means that the endpoint has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the endpoint
     * @return Endpoint
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/endpoints/guid/{endpointGuid}")

    public void deleteEndpointByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteEndpointByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeEndpointByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeEndpointByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied endpoint
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/endpoints/{endpointGuid}/classifications")
    public Endpoint addEndpointClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addEndpointClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Endpoint endpointClassifications = EndpointMapper.mapOmrsEntityDetailToEndpoint(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Endpoint=" +  endpointClassifications);
         }
         return  endpointClassifications;
    }

    /**
     * Updates classifications to an existing endpoint represented by a guid.
     * @param  entityGuid globally unique identifier for the endpoint
     * @return classification for the given endpoint guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/endpoints/{endpointGuid}/classification")

    public Endpoint updateEndpointClassification(@PathVariable("userId") String userId,@PathVariable("endpointGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateEndpointClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Endpoint  endpointClassifications = EndpointMapper.mapOmrsEntityDetailToEndpoint(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  endpointClassifications;
    }

    /**
     * Deletes a given classification from an existing endpoint represented by a guid.
     * @param entityGuid  globally unique identifier for the endpoint
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/endpoints/{endpointGuid}/classification/{name}")
    public Endpoint deleteEndpointClassification(@PathVariable("userId") String userId,@PathVariable("endpointGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteEndpointClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Endpoint declassifiedEndpoint =  EndpointMapper.mapOmrsEntityDetailToEndpoint(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedEndpoint;
    }

    /**
      * Get the relationships associated with entity endpoint represented by a guid.
      * @param entityGuid  globally unique identifier for the endpoint
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/endpoints/guid/{entityGuid}/relationships")
    public List<Line> getEndpointRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getEndpointRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an contactDetails given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the contactDetailses relationships.
     * @param entityGuid GUID for the entity
     * @return ContactDetails
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/contactDetailses/guid/{entityGuid}")
    public ContactDetails getContactDetailsById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getContactDetailsById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ContactDetails gotcontactDetails = ContactDetailsMapper.mapOmrsEntityDetailToContactDetails(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcontactDetails );
        }
        return gotcontactDetails;

    }
    /**
     * Create new contactDetails in Atlas.
     * @param contactDetails
     * @return ContactDetails
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/contactDetailses")
    public ContactDetails createContactDetails(@PathVariable String userId,ContactDetails contactDetails)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createContactDetailsById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ContactDetails");
        if (constraint!=null) {
             constraint.preCreate(contactDetails);
        }

        EntityDetail entityDetail = ContactDetailsMapper.mapContactDetailsToOmrsEntityDetail(contactDetails);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ContactDetails createdContactDetails =  ContactDetailsMapper.mapOmrsEntityDetailToContactDetails(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ContactDetails="+ createdContactDetails );
        }
        return createdContactDetails;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/contactDetailses/guid/{contactDetailsGuid}")
    public ContactDetails updateContactDetails(@PathVariable String userId,@PathVariable String entityGuid, ContactDetails contactDetails)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateContactDetailsById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ContactDetailsMapper.mapContactDetailsToOmrsEntityDetail(contactDetails);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ContactDetails updatedContactDetails =  ContactDetailsMapper.mapOmrsEntityDetailToContactDetails(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ContactDetails="+ updatedContactDetails );
            }
            return updatedContactDetails;
        }

    /**
     * Delete an contactDetails identified by its GUID. Delete is a soft delete, this means that the contactDetails has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the contactDetails
     * @return ContactDetails
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/contactDetailses/guid/{contactDetailsGuid}")

    public void deleteContactDetailsByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteContactDetailsByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeContactDetailsByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeContactDetailsByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied contactDetails
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/contactDetailses/{contactDetailsGuid}/classifications")
    public ContactDetails addContactDetailsClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addContactDetailsClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ContactDetails contactDetailsClassifications = ContactDetailsMapper.mapOmrsEntityDetailToContactDetails(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ContactDetails=" +  contactDetailsClassifications);
         }
         return  contactDetailsClassifications;
    }

    /**
     * Updates classifications to an existing contactDetails represented by a guid.
     * @param  entityGuid globally unique identifier for the contactDetails
     * @return classification for the given contactDetails guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/contactDetailses/{contactDetailsGuid}/classification")

    public ContactDetails updateContactDetailsClassification(@PathVariable("userId") String userId,@PathVariable("contactDetailsGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateContactDetailsClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ContactDetails  contactDetailsClassifications = ContactDetailsMapper.mapOmrsEntityDetailToContactDetails(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  contactDetailsClassifications;
    }

    /**
     * Deletes a given classification from an existing contactDetails represented by a guid.
     * @param entityGuid  globally unique identifier for the contactDetails
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/contactDetailses/{contactDetailsGuid}/classification/{name}")
    public ContactDetails deleteContactDetailsClassification(@PathVariable("userId") String userId,@PathVariable("contactDetailsGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteContactDetailsClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ContactDetails declassifiedContactDetails =  ContactDetailsMapper.mapOmrsEntityDetailToContactDetails(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedContactDetails;
    }

    /**
      * Get the relationships associated with entity contactDetails represented by a guid.
      * @param entityGuid  globally unique identifier for the contactDetails
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/contactDetailses/guid/{entityGuid}/relationships")
    public List<Line> getContactDetailsRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getContactDetailsRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceDefinition given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceDefinitions relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceDefinition
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceDefinitions/guid/{entityGuid}")
    public GovernanceDefinition getGovernanceDefinitionById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceDefinitionById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceDefinition gotgovernanceDefinition = GovernanceDefinitionMapper.mapOmrsEntityDetailToGovernanceDefinition(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceDefinition );
        }
        return gotgovernanceDefinition;

    }
    /**
     * Create new governanceDefinition in Atlas.
     * @param governanceDefinition
     * @return GovernanceDefinition
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceDefinitions")
    public GovernanceDefinition createGovernanceDefinition(@PathVariable String userId,GovernanceDefinition governanceDefinition)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceDefinitionById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceDefinition");
        if (constraint!=null) {
             constraint.preCreate(governanceDefinition);
        }

        EntityDetail entityDetail = GovernanceDefinitionMapper.mapGovernanceDefinitionToOmrsEntityDetail(governanceDefinition);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceDefinition createdGovernanceDefinition =  GovernanceDefinitionMapper.mapOmrsEntityDetailToGovernanceDefinition(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceDefinition="+ createdGovernanceDefinition );
        }
        return createdGovernanceDefinition;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceDefinitions/guid/{governanceDefinitionGuid}")
    public GovernanceDefinition updateGovernanceDefinition(@PathVariable String userId,@PathVariable String entityGuid, GovernanceDefinition governanceDefinition)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceDefinitionById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceDefinitionMapper.mapGovernanceDefinitionToOmrsEntityDetail(governanceDefinition);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceDefinition updatedGovernanceDefinition =  GovernanceDefinitionMapper.mapOmrsEntityDetailToGovernanceDefinition(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceDefinition="+ updatedGovernanceDefinition );
            }
            return updatedGovernanceDefinition;
        }

    /**
     * Delete an governanceDefinition identified by its GUID. Delete is a soft delete, this means that the governanceDefinition has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceDefinition
     * @return GovernanceDefinition
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceDefinitions/guid/{governanceDefinitionGuid}")

    public void deleteGovernanceDefinitionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceDefinitionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceDefinitionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceDefinitionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceDefinition
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceDefinitions/{governanceDefinitionGuid}/classifications")
    public GovernanceDefinition addGovernanceDefinitionClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceDefinitionClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceDefinition governanceDefinitionClassifications = GovernanceDefinitionMapper.mapOmrsEntityDetailToGovernanceDefinition(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceDefinition=" +  governanceDefinitionClassifications);
         }
         return  governanceDefinitionClassifications;
    }

    /**
     * Updates classifications to an existing governanceDefinition represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceDefinition
     * @return classification for the given governanceDefinition guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceDefinitions/{governanceDefinitionGuid}/classification")

    public GovernanceDefinition updateGovernanceDefinitionClassification(@PathVariable("userId") String userId,@PathVariable("governanceDefinitionGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceDefinitionClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceDefinition  governanceDefinitionClassifications = GovernanceDefinitionMapper.mapOmrsEntityDetailToGovernanceDefinition(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceDefinitionClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceDefinition represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceDefinition
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceDefinitions/{governanceDefinitionGuid}/classification/{name}")
    public GovernanceDefinition deleteGovernanceDefinitionClassification(@PathVariable("userId") String userId,@PathVariable("governanceDefinitionGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceDefinitionClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceDefinition declassifiedGovernanceDefinition =  GovernanceDefinitionMapper.mapOmrsEntityDetailToGovernanceDefinition(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceDefinition;
    }

    /**
      * Get the relationships associated with entity governanceDefinition represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceDefinition
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceDefinitions/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceDefinitionRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceDefinitionRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an fileFolder given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the fileFolders relationships.
     * @param entityGuid GUID for the entity
     * @return FileFolder
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/fileFolders/guid/{entityGuid}")
    public FileFolder getFileFolderById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getFileFolderById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        FileFolder gotfileFolder = FileFolderMapper.mapOmrsEntityDetailToFileFolder(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotfileFolder );
        }
        return gotfileFolder;

    }
    /**
     * Create new fileFolder in Atlas.
     * @param fileFolder
     * @return FileFolder
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/fileFolders")
    public FileFolder createFileFolder(@PathVariable String userId,FileFolder fileFolder)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createFileFolderById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("FileFolder");
        if (constraint!=null) {
             constraint.preCreate(fileFolder);
        }

        EntityDetail entityDetail = FileFolderMapper.mapFileFolderToOmrsEntityDetail(fileFolder);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        FileFolder createdFileFolder =  FileFolderMapper.mapOmrsEntityDetailToFileFolder(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created FileFolder="+ createdFileFolder );
        }
        return createdFileFolder;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/fileFolders/guid/{fileFolderGuid}")
    public FileFolder updateFileFolder(@PathVariable String userId,@PathVariable String entityGuid, FileFolder fileFolder)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateFileFolderById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = FileFolderMapper.mapFileFolderToOmrsEntityDetail(fileFolder);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            FileFolder updatedFileFolder =  FileFolderMapper.mapOmrsEntityDetailToFileFolder(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated FileFolder="+ updatedFileFolder );
            }
            return updatedFileFolder;
        }

    /**
     * Delete an fileFolder identified by its GUID. Delete is a soft delete, this means that the fileFolder has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the fileFolder
     * @return FileFolder
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/fileFolders/guid/{fileFolderGuid}")

    public void deleteFileFolderByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteFileFolderByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeFileFolderByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeFileFolderByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied fileFolder
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/fileFolders/{fileFolderGuid}/classifications")
    public FileFolder addFileFolderClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addFileFolderClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         FileFolder fileFolderClassifications = FileFolderMapper.mapOmrsEntityDetailToFileFolder(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified FileFolder=" +  fileFolderClassifications);
         }
         return  fileFolderClassifications;
    }

    /**
     * Updates classifications to an existing fileFolder represented by a guid.
     * @param  entityGuid globally unique identifier for the fileFolder
     * @return classification for the given fileFolder guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/fileFolders/{fileFolderGuid}/classification")

    public FileFolder updateFileFolderClassification(@PathVariable("userId") String userId,@PathVariable("fileFolderGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateFileFolderClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           FileFolder  fileFolderClassifications = FileFolderMapper.mapOmrsEntityDetailToFileFolder(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  fileFolderClassifications;
    }

    /**
     * Deletes a given classification from an existing fileFolder represented by a guid.
     * @param entityGuid  globally unique identifier for the fileFolder
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/fileFolders/{fileFolderGuid}/classification/{name}")
    public FileFolder deleteFileFolderClassification(@PathVariable("userId") String userId,@PathVariable("fileFolderGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteFileFolderClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       FileFolder declassifiedFileFolder =  FileFolderMapper.mapOmrsEntityDetailToFileFolder(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedFileFolder;
    }

    /**
      * Get the relationships associated with entity fileFolder represented by a guid.
      * @param entityGuid  globally unique identifier for the fileFolder
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/fileFolders/guid/{entityGuid}/relationships")
    public List<Line> getFileFolderRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getFileFolderRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an network given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the networks relationships.
     * @param entityGuid GUID for the entity
     * @return Network
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/networks/guid/{entityGuid}")
    public Network getNetworkById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getNetworkById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Network gotnetwork = NetworkMapper.mapOmrsEntityDetailToNetwork(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotnetwork );
        }
        return gotnetwork;

    }
    /**
     * Create new network in Atlas.
     * @param network
     * @return Network
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/networks")
    public Network createNetwork(@PathVariable String userId,Network network)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createNetworkById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Network");
        if (constraint!=null) {
             constraint.preCreate(network);
        }

        EntityDetail entityDetail = NetworkMapper.mapNetworkToOmrsEntityDetail(network);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Network createdNetwork =  NetworkMapper.mapOmrsEntityDetailToNetwork(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Network="+ createdNetwork );
        }
        return createdNetwork;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/networks/guid/{networkGuid}")
    public Network updateNetwork(@PathVariable String userId,@PathVariable String entityGuid, Network network)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateNetworkById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = NetworkMapper.mapNetworkToOmrsEntityDetail(network);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Network updatedNetwork =  NetworkMapper.mapOmrsEntityDetailToNetwork(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Network="+ updatedNetwork );
            }
            return updatedNetwork;
        }

    /**
     * Delete an network identified by its GUID. Delete is a soft delete, this means that the network has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the network
     * @return Network
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/networks/guid/{networkGuid}")

    public void deleteNetworkByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteNetworkByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeNetworkByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeNetworkByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied network
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/networks/{networkGuid}/classifications")
    public Network addNetworkClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addNetworkClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Network networkClassifications = NetworkMapper.mapOmrsEntityDetailToNetwork(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Network=" +  networkClassifications);
         }
         return  networkClassifications;
    }

    /**
     * Updates classifications to an existing network represented by a guid.
     * @param  entityGuid globally unique identifier for the network
     * @return classification for the given network guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/networks/{networkGuid}/classification")

    public Network updateNetworkClassification(@PathVariable("userId") String userId,@PathVariable("networkGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateNetworkClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Network  networkClassifications = NetworkMapper.mapOmrsEntityDetailToNetwork(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  networkClassifications;
    }

    /**
     * Deletes a given classification from an existing network represented by a guid.
     * @param entityGuid  globally unique identifier for the network
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/networks/{networkGuid}/classification/{name}")
    public Network deleteNetworkClassification(@PathVariable("userId") String userId,@PathVariable("networkGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteNetworkClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Network declassifiedNetwork =  NetworkMapper.mapOmrsEntityDetailToNetwork(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedNetwork;
    }

    /**
      * Get the relationships associated with entity network represented by a guid.
      * @param entityGuid  globally unique identifier for the network
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/networks/guid/{entityGuid}/relationships")
    public List<Line> getNetworkRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getNetworkRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an actorProfile given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the actorProfiles relationships.
     * @param entityGuid GUID for the entity
     * @return ActorProfile
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/actorProfiles/guid/{entityGuid}")
    public ActorProfile getActorProfileById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getActorProfileById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ActorProfile gotactorProfile = ActorProfileMapper.mapOmrsEntityDetailToActorProfile(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotactorProfile );
        }
        return gotactorProfile;

    }
    /**
     * Create new actorProfile in Atlas.
     * @param actorProfile
     * @return ActorProfile
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/actorProfiles")
    public ActorProfile createActorProfile(@PathVariable String userId,ActorProfile actorProfile)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createActorProfileById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ActorProfile");
        if (constraint!=null) {
             constraint.preCreate(actorProfile);
        }

        EntityDetail entityDetail = ActorProfileMapper.mapActorProfileToOmrsEntityDetail(actorProfile);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ActorProfile createdActorProfile =  ActorProfileMapper.mapOmrsEntityDetailToActorProfile(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ActorProfile="+ createdActorProfile );
        }
        return createdActorProfile;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/actorProfiles/guid/{actorProfileGuid}")
    public ActorProfile updateActorProfile(@PathVariable String userId,@PathVariable String entityGuid, ActorProfile actorProfile)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateActorProfileById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ActorProfileMapper.mapActorProfileToOmrsEntityDetail(actorProfile);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ActorProfile updatedActorProfile =  ActorProfileMapper.mapOmrsEntityDetailToActorProfile(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ActorProfile="+ updatedActorProfile );
            }
            return updatedActorProfile;
        }

    /**
     * Delete an actorProfile identified by its GUID. Delete is a soft delete, this means that the actorProfile has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the actorProfile
     * @return ActorProfile
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/actorProfiles/guid/{actorProfileGuid}")

    public void deleteActorProfileByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteActorProfileByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeActorProfileByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeActorProfileByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied actorProfile
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/actorProfiles/{actorProfileGuid}/classifications")
    public ActorProfile addActorProfileClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addActorProfileClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ActorProfile actorProfileClassifications = ActorProfileMapper.mapOmrsEntityDetailToActorProfile(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ActorProfile=" +  actorProfileClassifications);
         }
         return  actorProfileClassifications;
    }

    /**
     * Updates classifications to an existing actorProfile represented by a guid.
     * @param  entityGuid globally unique identifier for the actorProfile
     * @return classification for the given actorProfile guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/actorProfiles/{actorProfileGuid}/classification")

    public ActorProfile updateActorProfileClassification(@PathVariable("userId") String userId,@PathVariable("actorProfileGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateActorProfileClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ActorProfile  actorProfileClassifications = ActorProfileMapper.mapOmrsEntityDetailToActorProfile(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  actorProfileClassifications;
    }

    /**
     * Deletes a given classification from an existing actorProfile represented by a guid.
     * @param entityGuid  globally unique identifier for the actorProfile
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/actorProfiles/{actorProfileGuid}/classification/{name}")
    public ActorProfile deleteActorProfileClassification(@PathVariable("userId") String userId,@PathVariable("actorProfileGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteActorProfileClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ActorProfile declassifiedActorProfile =  ActorProfileMapper.mapOmrsEntityDetailToActorProfile(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedActorProfile;
    }

    /**
      * Get the relationships associated with entity actorProfile represented by a guid.
      * @param entityGuid  globally unique identifier for the actorProfile
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/actorProfiles/guid/{entityGuid}/relationships")
    public List<Line> getActorProfileRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getActorProfileRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an asset given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the assets relationships.
     * @param entityGuid GUID for the entity
     * @return Asset
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/assets/guid/{entityGuid}")
    public Asset getAssetById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getAssetById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Asset gotasset = AssetMapper.mapOmrsEntityDetailToAsset(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotasset );
        }
        return gotasset;

    }
    /**
     * Create new asset in Atlas.
     * @param asset
     * @return Asset
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

// Not required as a rest API for the Subject Area OMAS. 
    public Asset createAsset(@PathVariable String userId,Asset asset)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createAssetById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Asset");
        if (constraint!=null) {
             constraint.preCreate(asset);
        }

        EntityDetail entityDetail = AssetMapper.mapAssetToOmrsEntityDetail(asset);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Asset createdAsset =  AssetMapper.mapOmrsEntityDetailToAsset(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Asset="+ createdAsset );
        }
        return createdAsset;
    }

// Not required as a rest API for the Subject Area OMAS. 
    public Asset updateAsset(@PathVariable String userId,@PathVariable String entityGuid, Asset asset)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateAssetById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = AssetMapper.mapAssetToOmrsEntityDetail(asset);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Asset updatedAsset =  AssetMapper.mapOmrsEntityDetailToAsset(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Asset="+ updatedAsset );
            }
            return updatedAsset;
        }

    /**
     * Delete an asset identified by its GUID. Delete is a soft delete, this means that the asset has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the asset
     * @return Asset
     */

// Not required as a rest API for the Subject Area OMAS. 

    public void deleteAssetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteAssetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeAssetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeAssetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied asset
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
// Not required as a rest API for the Subject Area OMAS. 
    public Asset addAssetClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addAssetClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Asset assetClassifications = AssetMapper.mapOmrsEntityDetailToAsset(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Asset=" +  assetClassifications);
         }
         return  assetClassifications;
    }

    /**
     * Updates classifications to an existing asset represented by a guid.
     * @param  entityGuid globally unique identifier for the asset
     * @return classification for the given asset guid
     */

// Not required as a rest API for the Subject Area OMAS. 

    public Asset updateAssetClassification(@PathVariable("userId") String userId,@PathVariable("assetGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateAssetClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Asset  assetClassifications = AssetMapper.mapOmrsEntityDetailToAsset(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  assetClassifications;
    }

    /**
     * Deletes a given classification from an existing asset represented by a guid.
     * @param entityGuid  globally unique identifier for the asset
     * @param name name of the classification
     */
// Not required as a rest API for the Subject Area OMAS. 
    public Asset deleteAssetClassification(@PathVariable("userId") String userId,@PathVariable("assetGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteAssetClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Asset declassifiedAsset =  AssetMapper.mapOmrsEntityDetailToAsset(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedAsset;
    }

    /**
      * Get the relationships associated with entity asset represented by a guid.
      * @param entityGuid  globally unique identifier for the asset
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/assets/guid/{entityGuid}/relationships")
    public List<Line> getAssetRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getAssetRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an aPIOperation given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the aPIOperations relationships.
     * @param entityGuid GUID for the entity
     * @return APIOperation
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/aPIOperations/guid/{entityGuid}")
    public APIOperation getAPIOperationById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getAPIOperationById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        APIOperation gotaPIOperation = APIOperationMapper.mapOmrsEntityDetailToAPIOperation(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotaPIOperation );
        }
        return gotaPIOperation;

    }
    /**
     * Create new aPIOperation in Atlas.
     * @param aPIOperation
     * @return APIOperation
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/aPIOperations")
    public APIOperation createAPIOperation(@PathVariable String userId,APIOperation aPIOperation)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createAPIOperationById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("APIOperation");
        if (constraint!=null) {
             constraint.preCreate(aPIOperation);
        }

        EntityDetail entityDetail = APIOperationMapper.mapAPIOperationToOmrsEntityDetail(aPIOperation);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        APIOperation createdAPIOperation =  APIOperationMapper.mapOmrsEntityDetailToAPIOperation(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created APIOperation="+ createdAPIOperation );
        }
        return createdAPIOperation;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/aPIOperations/guid/{aPIOperationGuid}")
    public APIOperation updateAPIOperation(@PathVariable String userId,@PathVariable String entityGuid, APIOperation aPIOperation)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateAPIOperationById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = APIOperationMapper.mapAPIOperationToOmrsEntityDetail(aPIOperation);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            APIOperation updatedAPIOperation =  APIOperationMapper.mapOmrsEntityDetailToAPIOperation(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated APIOperation="+ updatedAPIOperation );
            }
            return updatedAPIOperation;
        }

    /**
     * Delete an aPIOperation identified by its GUID. Delete is a soft delete, this means that the aPIOperation has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the aPIOperation
     * @return APIOperation
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/aPIOperations/guid/{aPIOperationGuid}")

    public void deleteAPIOperationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteAPIOperationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeAPIOperationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeAPIOperationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied aPIOperation
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/aPIOperations/{aPIOperationGuid}/classifications")
    public APIOperation addAPIOperationClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addAPIOperationClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         APIOperation aPIOperationClassifications = APIOperationMapper.mapOmrsEntityDetailToAPIOperation(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified APIOperation=" +  aPIOperationClassifications);
         }
         return  aPIOperationClassifications;
    }

    /**
     * Updates classifications to an existing aPIOperation represented by a guid.
     * @param  entityGuid globally unique identifier for the aPIOperation
     * @return classification for the given aPIOperation guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/aPIOperations/{aPIOperationGuid}/classification")

    public APIOperation updateAPIOperationClassification(@PathVariable("userId") String userId,@PathVariable("aPIOperationGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateAPIOperationClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           APIOperation  aPIOperationClassifications = APIOperationMapper.mapOmrsEntityDetailToAPIOperation(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  aPIOperationClassifications;
    }

    /**
     * Deletes a given classification from an existing aPIOperation represented by a guid.
     * @param entityGuid  globally unique identifier for the aPIOperation
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/aPIOperations/{aPIOperationGuid}/classification/{name}")
    public APIOperation deleteAPIOperationClassification(@PathVariable("userId") String userId,@PathVariable("aPIOperationGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteAPIOperationClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       APIOperation declassifiedAPIOperation =  APIOperationMapper.mapOmrsEntityDetailToAPIOperation(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedAPIOperation;
    }

    /**
      * Get the relationships associated with entity aPIOperation represented by a guid.
      * @param entityGuid  globally unique identifier for the aPIOperation
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/aPIOperations/guid/{entityGuid}/relationships")
    public List<Line> getAPIOperationRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getAPIOperationRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an toDo given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the toDos relationships.
     * @param entityGuid GUID for the entity
     * @return ToDo
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/toDos/guid/{entityGuid}")
    public ToDo getToDoById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getToDoById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ToDo gottoDo = ToDoMapper.mapOmrsEntityDetailToToDo(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gottoDo );
        }
        return gottoDo;

    }
    /**
     * Create new toDo in Atlas.
     * @param toDo
     * @return ToDo
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/toDos")
    public ToDo createToDo(@PathVariable String userId,ToDo toDo)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createToDoById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ToDo");
        if (constraint!=null) {
             constraint.preCreate(toDo);
        }

        EntityDetail entityDetail = ToDoMapper.mapToDoToOmrsEntityDetail(toDo);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ToDo createdToDo =  ToDoMapper.mapOmrsEntityDetailToToDo(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ToDo="+ createdToDo );
        }
        return createdToDo;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/toDos/guid/{toDoGuid}")
    public ToDo updateToDo(@PathVariable String userId,@PathVariable String entityGuid, ToDo toDo)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateToDoById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ToDoMapper.mapToDoToOmrsEntityDetail(toDo);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ToDo updatedToDo =  ToDoMapper.mapOmrsEntityDetailToToDo(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ToDo="+ updatedToDo );
            }
            return updatedToDo;
        }

    /**
     * Delete an toDo identified by its GUID. Delete is a soft delete, this means that the toDo has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the toDo
     * @return ToDo
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/toDos/guid/{toDoGuid}")

    public void deleteToDoByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteToDoByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeToDoByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeToDoByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied toDo
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/toDos/{toDoGuid}/classifications")
    public ToDo addToDoClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addToDoClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ToDo toDoClassifications = ToDoMapper.mapOmrsEntityDetailToToDo(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ToDo=" +  toDoClassifications);
         }
         return  toDoClassifications;
    }

    /**
     * Updates classifications to an existing toDo represented by a guid.
     * @param  entityGuid globally unique identifier for the toDo
     * @return classification for the given toDo guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/toDos/{toDoGuid}/classification")

    public ToDo updateToDoClassification(@PathVariable("userId") String userId,@PathVariable("toDoGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateToDoClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ToDo  toDoClassifications = ToDoMapper.mapOmrsEntityDetailToToDo(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  toDoClassifications;
    }

    /**
     * Deletes a given classification from an existing toDo represented by a guid.
     * @param entityGuid  globally unique identifier for the toDo
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/toDos/{toDoGuid}/classification/{name}")
    public ToDo deleteToDoClassification(@PathVariable("userId") String userId,@PathVariable("toDoGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteToDoClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ToDo declassifiedToDo =  ToDoMapper.mapOmrsEntityDetailToToDo(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedToDo;
    }

    /**
      * Get the relationships associated with entity toDo represented by a guid.
      * @param entityGuid  globally unique identifier for the toDo
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/toDos/guid/{entityGuid}/relationships")
    public List<Line> getToDoRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getToDoRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an networkGateway given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the networkGatewaies relationships.
     * @param entityGuid GUID for the entity
     * @return NetworkGateway
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/networkGatewaies/guid/{entityGuid}")
    public NetworkGateway getNetworkGatewayById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getNetworkGatewayById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        NetworkGateway gotnetworkGateway = NetworkGatewayMapper.mapOmrsEntityDetailToNetworkGateway(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotnetworkGateway );
        }
        return gotnetworkGateway;

    }
    /**
     * Create new networkGateway in Atlas.
     * @param networkGateway
     * @return NetworkGateway
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/networkGatewaies")
    public NetworkGateway createNetworkGateway(@PathVariable String userId,NetworkGateway networkGateway)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createNetworkGatewayById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("NetworkGateway");
        if (constraint!=null) {
             constraint.preCreate(networkGateway);
        }

        EntityDetail entityDetail = NetworkGatewayMapper.mapNetworkGatewayToOmrsEntityDetail(networkGateway);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        NetworkGateway createdNetworkGateway =  NetworkGatewayMapper.mapOmrsEntityDetailToNetworkGateway(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created NetworkGateway="+ createdNetworkGateway );
        }
        return createdNetworkGateway;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/networkGatewaies/guid/{networkGatewayGuid}")
    public NetworkGateway updateNetworkGateway(@PathVariable String userId,@PathVariable String entityGuid, NetworkGateway networkGateway)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateNetworkGatewayById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = NetworkGatewayMapper.mapNetworkGatewayToOmrsEntityDetail(networkGateway);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            NetworkGateway updatedNetworkGateway =  NetworkGatewayMapper.mapOmrsEntityDetailToNetworkGateway(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated NetworkGateway="+ updatedNetworkGateway );
            }
            return updatedNetworkGateway;
        }

    /**
     * Delete an networkGateway identified by its GUID. Delete is a soft delete, this means that the networkGateway has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the networkGateway
     * @return NetworkGateway
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/networkGatewaies/guid/{networkGatewayGuid}")

    public void deleteNetworkGatewayByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteNetworkGatewayByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeNetworkGatewayByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeNetworkGatewayByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied networkGateway
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/networkGatewaies/{networkGatewayGuid}/classifications")
    public NetworkGateway addNetworkGatewayClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addNetworkGatewayClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         NetworkGateway networkGatewayClassifications = NetworkGatewayMapper.mapOmrsEntityDetailToNetworkGateway(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified NetworkGateway=" +  networkGatewayClassifications);
         }
         return  networkGatewayClassifications;
    }

    /**
     * Updates classifications to an existing networkGateway represented by a guid.
     * @param  entityGuid globally unique identifier for the networkGateway
     * @return classification for the given networkGateway guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/networkGatewaies/{networkGatewayGuid}/classification")

    public NetworkGateway updateNetworkGatewayClassification(@PathVariable("userId") String userId,@PathVariable("networkGatewayGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateNetworkGatewayClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           NetworkGateway  networkGatewayClassifications = NetworkGatewayMapper.mapOmrsEntityDetailToNetworkGateway(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  networkGatewayClassifications;
    }

    /**
     * Deletes a given classification from an existing networkGateway represented by a guid.
     * @param entityGuid  globally unique identifier for the networkGateway
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/networkGatewaies/{networkGatewayGuid}/classification/{name}")
    public NetworkGateway deleteNetworkGatewayClassification(@PathVariable("userId") String userId,@PathVariable("networkGatewayGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteNetworkGatewayClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       NetworkGateway declassifiedNetworkGateway =  NetworkGatewayMapper.mapOmrsEntityDetailToNetworkGateway(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedNetworkGateway;
    }

    /**
      * Get the relationships associated with entity networkGateway represented by a guid.
      * @param entityGuid  globally unique identifier for the networkGateway
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/networkGatewaies/guid/{entityGuid}/relationships")
    public List<Line> getNetworkGatewayRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getNetworkGatewayRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceResponsibility given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceResponsibilities relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceResponsibility
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceResponsibilities/guid/{entityGuid}")
    public GovernanceResponsibility getGovernanceResponsibilityById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceResponsibilityById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceResponsibility gotgovernanceResponsibility = GovernanceResponsibilityMapper.mapOmrsEntityDetailToGovernanceResponsibility(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceResponsibility );
        }
        return gotgovernanceResponsibility;

    }
    /**
     * Create new governanceResponsibility in Atlas.
     * @param governanceResponsibility
     * @return GovernanceResponsibility
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceResponsibilities")
    public GovernanceResponsibility createGovernanceResponsibility(@PathVariable String userId,GovernanceResponsibility governanceResponsibility)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceResponsibilityById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceResponsibility");
        if (constraint!=null) {
             constraint.preCreate(governanceResponsibility);
        }

        EntityDetail entityDetail = GovernanceResponsibilityMapper.mapGovernanceResponsibilityToOmrsEntityDetail(governanceResponsibility);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceResponsibility createdGovernanceResponsibility =  GovernanceResponsibilityMapper.mapOmrsEntityDetailToGovernanceResponsibility(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceResponsibility="+ createdGovernanceResponsibility );
        }
        return createdGovernanceResponsibility;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceResponsibilities/guid/{governanceResponsibilityGuid}")
    public GovernanceResponsibility updateGovernanceResponsibility(@PathVariable String userId,@PathVariable String entityGuid, GovernanceResponsibility governanceResponsibility)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceResponsibilityById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceResponsibilityMapper.mapGovernanceResponsibilityToOmrsEntityDetail(governanceResponsibility);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceResponsibility updatedGovernanceResponsibility =  GovernanceResponsibilityMapper.mapOmrsEntityDetailToGovernanceResponsibility(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceResponsibility="+ updatedGovernanceResponsibility );
            }
            return updatedGovernanceResponsibility;
        }

    /**
     * Delete an governanceResponsibility identified by its GUID. Delete is a soft delete, this means that the governanceResponsibility has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceResponsibility
     * @return GovernanceResponsibility
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceResponsibilities/guid/{governanceResponsibilityGuid}")

    public void deleteGovernanceResponsibilityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceResponsibilityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceResponsibilityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceResponsibilityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceResponsibility
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceResponsibilities/{governanceResponsibilityGuid}/classifications")
    public GovernanceResponsibility addGovernanceResponsibilityClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceResponsibilityClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceResponsibility governanceResponsibilityClassifications = GovernanceResponsibilityMapper.mapOmrsEntityDetailToGovernanceResponsibility(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceResponsibility=" +  governanceResponsibilityClassifications);
         }
         return  governanceResponsibilityClassifications;
    }

    /**
     * Updates classifications to an existing governanceResponsibility represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceResponsibility
     * @return classification for the given governanceResponsibility guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceResponsibilities/{governanceResponsibilityGuid}/classification")

    public GovernanceResponsibility updateGovernanceResponsibilityClassification(@PathVariable("userId") String userId,@PathVariable("governanceResponsibilityGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceResponsibilityClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceResponsibility  governanceResponsibilityClassifications = GovernanceResponsibilityMapper.mapOmrsEntityDetailToGovernanceResponsibility(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceResponsibilityClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceResponsibility represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceResponsibility
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceResponsibilities/{governanceResponsibilityGuid}/classification/{name}")
    public GovernanceResponsibility deleteGovernanceResponsibilityClassification(@PathVariable("userId") String userId,@PathVariable("governanceResponsibilityGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceResponsibilityClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceResponsibility declassifiedGovernanceResponsibility =  GovernanceResponsibilityMapper.mapOmrsEntityDetailToGovernanceResponsibility(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceResponsibility;
    }

    /**
      * Get the relationships associated with entity governanceResponsibility represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceResponsibility
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceResponsibilities/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceResponsibilityRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceResponsibilityRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an implementationSnippet given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the implementationSnippets relationships.
     * @param entityGuid GUID for the entity
     * @return ImplementationSnippet
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/implementationSnippets/guid/{entityGuid}")
    public ImplementationSnippet getImplementationSnippetById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getImplementationSnippetById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ImplementationSnippet gotimplementationSnippet = ImplementationSnippetMapper.mapOmrsEntityDetailToImplementationSnippet(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotimplementationSnippet );
        }
        return gotimplementationSnippet;

    }
    /**
     * Create new implementationSnippet in Atlas.
     * @param implementationSnippet
     * @return ImplementationSnippet
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/implementationSnippets")
    public ImplementationSnippet createImplementationSnippet(@PathVariable String userId,ImplementationSnippet implementationSnippet)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createImplementationSnippetById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ImplementationSnippet");
        if (constraint!=null) {
             constraint.preCreate(implementationSnippet);
        }

        EntityDetail entityDetail = ImplementationSnippetMapper.mapImplementationSnippetToOmrsEntityDetail(implementationSnippet);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ImplementationSnippet createdImplementationSnippet =  ImplementationSnippetMapper.mapOmrsEntityDetailToImplementationSnippet(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ImplementationSnippet="+ createdImplementationSnippet );
        }
        return createdImplementationSnippet;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/implementationSnippets/guid/{implementationSnippetGuid}")
    public ImplementationSnippet updateImplementationSnippet(@PathVariable String userId,@PathVariable String entityGuid, ImplementationSnippet implementationSnippet)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateImplementationSnippetById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ImplementationSnippetMapper.mapImplementationSnippetToOmrsEntityDetail(implementationSnippet);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ImplementationSnippet updatedImplementationSnippet =  ImplementationSnippetMapper.mapOmrsEntityDetailToImplementationSnippet(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ImplementationSnippet="+ updatedImplementationSnippet );
            }
            return updatedImplementationSnippet;
        }

    /**
     * Delete an implementationSnippet identified by its GUID. Delete is a soft delete, this means that the implementationSnippet has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the implementationSnippet
     * @return ImplementationSnippet
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/implementationSnippets/guid/{implementationSnippetGuid}")

    public void deleteImplementationSnippetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteImplementationSnippetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeImplementationSnippetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeImplementationSnippetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied implementationSnippet
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/implementationSnippets/{implementationSnippetGuid}/classifications")
    public ImplementationSnippet addImplementationSnippetClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addImplementationSnippetClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ImplementationSnippet implementationSnippetClassifications = ImplementationSnippetMapper.mapOmrsEntityDetailToImplementationSnippet(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ImplementationSnippet=" +  implementationSnippetClassifications);
         }
         return  implementationSnippetClassifications;
    }

    /**
     * Updates classifications to an existing implementationSnippet represented by a guid.
     * @param  entityGuid globally unique identifier for the implementationSnippet
     * @return classification for the given implementationSnippet guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/implementationSnippets/{implementationSnippetGuid}/classification")

    public ImplementationSnippet updateImplementationSnippetClassification(@PathVariable("userId") String userId,@PathVariable("implementationSnippetGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateImplementationSnippetClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ImplementationSnippet  implementationSnippetClassifications = ImplementationSnippetMapper.mapOmrsEntityDetailToImplementationSnippet(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  implementationSnippetClassifications;
    }

    /**
     * Deletes a given classification from an existing implementationSnippet represented by a guid.
     * @param entityGuid  globally unique identifier for the implementationSnippet
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/implementationSnippets/{implementationSnippetGuid}/classification/{name}")
    public ImplementationSnippet deleteImplementationSnippetClassification(@PathVariable("userId") String userId,@PathVariable("implementationSnippetGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteImplementationSnippetClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ImplementationSnippet declassifiedImplementationSnippet =  ImplementationSnippetMapper.mapOmrsEntityDetailToImplementationSnippet(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedImplementationSnippet;
    }

    /**
      * Get the relationships associated with entity implementationSnippet represented by a guid.
      * @param entityGuid  globally unique identifier for the implementationSnippet
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/implementationSnippets/guid/{entityGuid}/relationships")
    public List<Line> getImplementationSnippetRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getImplementationSnippetRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an userIdentity given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the userIdentities relationships.
     * @param entityGuid GUID for the entity
     * @return UserIdentity
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/userIdentities/guid/{entityGuid}")
    public UserIdentity getUserIdentityById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getUserIdentityById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        UserIdentity gotuserIdentity = UserIdentityMapper.mapOmrsEntityDetailToUserIdentity(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotuserIdentity );
        }
        return gotuserIdentity;

    }
    /**
     * Create new userIdentity in Atlas.
     * @param userIdentity
     * @return UserIdentity
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/userIdentities")
    public UserIdentity createUserIdentity(@PathVariable String userId,UserIdentity userIdentity)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createUserIdentityById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("UserIdentity");
        if (constraint!=null) {
             constraint.preCreate(userIdentity);
        }

        EntityDetail entityDetail = UserIdentityMapper.mapUserIdentityToOmrsEntityDetail(userIdentity);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        UserIdentity createdUserIdentity =  UserIdentityMapper.mapOmrsEntityDetailToUserIdentity(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created UserIdentity="+ createdUserIdentity );
        }
        return createdUserIdentity;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/userIdentities/guid/{userIdentityGuid}")
    public UserIdentity updateUserIdentity(@PathVariable String userId,@PathVariable String entityGuid, UserIdentity userIdentity)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateUserIdentityById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = UserIdentityMapper.mapUserIdentityToOmrsEntityDetail(userIdentity);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            UserIdentity updatedUserIdentity =  UserIdentityMapper.mapOmrsEntityDetailToUserIdentity(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated UserIdentity="+ updatedUserIdentity );
            }
            return updatedUserIdentity;
        }

    /**
     * Delete an userIdentity identified by its GUID. Delete is a soft delete, this means that the userIdentity has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the userIdentity
     * @return UserIdentity
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/userIdentities/guid/{userIdentityGuid}")

    public void deleteUserIdentityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteUserIdentityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeUserIdentityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeUserIdentityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied userIdentity
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/userIdentities/{userIdentityGuid}/classifications")
    public UserIdentity addUserIdentityClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addUserIdentityClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         UserIdentity userIdentityClassifications = UserIdentityMapper.mapOmrsEntityDetailToUserIdentity(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified UserIdentity=" +  userIdentityClassifications);
         }
         return  userIdentityClassifications;
    }

    /**
     * Updates classifications to an existing userIdentity represented by a guid.
     * @param  entityGuid globally unique identifier for the userIdentity
     * @return classification for the given userIdentity guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/userIdentities/{userIdentityGuid}/classification")

    public UserIdentity updateUserIdentityClassification(@PathVariable("userId") String userId,@PathVariable("userIdentityGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateUserIdentityClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           UserIdentity  userIdentityClassifications = UserIdentityMapper.mapOmrsEntityDetailToUserIdentity(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  userIdentityClassifications;
    }

    /**
     * Deletes a given classification from an existing userIdentity represented by a guid.
     * @param entityGuid  globally unique identifier for the userIdentity
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/userIdentities/{userIdentityGuid}/classification/{name}")
    public UserIdentity deleteUserIdentityClassification(@PathVariable("userId") String userId,@PathVariable("userIdentityGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteUserIdentityClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       UserIdentity declassifiedUserIdentity =  UserIdentityMapper.mapOmrsEntityDetailToUserIdentity(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedUserIdentity;
    }

    /**
      * Get the relationships associated with entity userIdentity represented by a guid.
      * @param entityGuid  globally unique identifier for the userIdentity
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/userIdentities/guid/{entityGuid}/relationships")
    public List<Line> getUserIdentityRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getUserIdentityRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an noteEntry given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the noteEntries relationships.
     * @param entityGuid GUID for the entity
     * @return NoteEntry
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/noteEntries/guid/{entityGuid}")
    public NoteEntry getNoteEntryById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getNoteEntryById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        NoteEntry gotnoteEntry = NoteEntryMapper.mapOmrsEntityDetailToNoteEntry(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotnoteEntry );
        }
        return gotnoteEntry;

    }
    /**
     * Create new noteEntry in Atlas.
     * @param noteEntry
     * @return NoteEntry
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/noteEntries")
    public NoteEntry createNoteEntry(@PathVariable String userId,NoteEntry noteEntry)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createNoteEntryById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("NoteEntry");
        if (constraint!=null) {
             constraint.preCreate(noteEntry);
        }

        EntityDetail entityDetail = NoteEntryMapper.mapNoteEntryToOmrsEntityDetail(noteEntry);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        NoteEntry createdNoteEntry =  NoteEntryMapper.mapOmrsEntityDetailToNoteEntry(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created NoteEntry="+ createdNoteEntry );
        }
        return createdNoteEntry;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/noteEntries/guid/{noteEntryGuid}")
    public NoteEntry updateNoteEntry(@PathVariable String userId,@PathVariable String entityGuid, NoteEntry noteEntry)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateNoteEntryById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = NoteEntryMapper.mapNoteEntryToOmrsEntityDetail(noteEntry);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            NoteEntry updatedNoteEntry =  NoteEntryMapper.mapOmrsEntityDetailToNoteEntry(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated NoteEntry="+ updatedNoteEntry );
            }
            return updatedNoteEntry;
        }

    /**
     * Delete an noteEntry identified by its GUID. Delete is a soft delete, this means that the noteEntry has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the noteEntry
     * @return NoteEntry
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/noteEntries/guid/{noteEntryGuid}")

    public void deleteNoteEntryByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteNoteEntryByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeNoteEntryByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeNoteEntryByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied noteEntry
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/noteEntries/{noteEntryGuid}/classifications")
    public NoteEntry addNoteEntryClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addNoteEntryClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         NoteEntry noteEntryClassifications = NoteEntryMapper.mapOmrsEntityDetailToNoteEntry(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified NoteEntry=" +  noteEntryClassifications);
         }
         return  noteEntryClassifications;
    }

    /**
     * Updates classifications to an existing noteEntry represented by a guid.
     * @param  entityGuid globally unique identifier for the noteEntry
     * @return classification for the given noteEntry guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/noteEntries/{noteEntryGuid}/classification")

    public NoteEntry updateNoteEntryClassification(@PathVariable("userId") String userId,@PathVariable("noteEntryGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateNoteEntryClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           NoteEntry  noteEntryClassifications = NoteEntryMapper.mapOmrsEntityDetailToNoteEntry(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  noteEntryClassifications;
    }

    /**
     * Deletes a given classification from an existing noteEntry represented by a guid.
     * @param entityGuid  globally unique identifier for the noteEntry
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/noteEntries/{noteEntryGuid}/classification/{name}")
    public NoteEntry deleteNoteEntryClassification(@PathVariable("userId") String userId,@PathVariable("noteEntryGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteNoteEntryClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       NoteEntry declassifiedNoteEntry =  NoteEntryMapper.mapOmrsEntityDetailToNoteEntry(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedNoteEntry;
    }

    /**
      * Get the relationships associated with entity noteEntry represented by a guid.
      * @param entityGuid  globally unique identifier for the noteEntry
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/noteEntries/guid/{entityGuid}/relationships")
    public List<Line> getNoteEntryRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getNoteEntryRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an propertyFacet given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the propertyFacets relationships.
     * @param entityGuid GUID for the entity
     * @return PropertyFacet
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/propertyFacets/guid/{entityGuid}")
    public PropertyFacet getPropertyFacetById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getPropertyFacetById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        PropertyFacet gotpropertyFacet = PropertyFacetMapper.mapOmrsEntityDetailToPropertyFacet(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotpropertyFacet );
        }
        return gotpropertyFacet;

    }
    /**
     * Create new propertyFacet in Atlas.
     * @param propertyFacet
     * @return PropertyFacet
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/propertyFacets")
    public PropertyFacet createPropertyFacet(@PathVariable String userId,PropertyFacet propertyFacet)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createPropertyFacetById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("PropertyFacet");
        if (constraint!=null) {
             constraint.preCreate(propertyFacet);
        }

        EntityDetail entityDetail = PropertyFacetMapper.mapPropertyFacetToOmrsEntityDetail(propertyFacet);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        PropertyFacet createdPropertyFacet =  PropertyFacetMapper.mapOmrsEntityDetailToPropertyFacet(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created PropertyFacet="+ createdPropertyFacet );
        }
        return createdPropertyFacet;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/propertyFacets/guid/{propertyFacetGuid}")
    public PropertyFacet updatePropertyFacet(@PathVariable String userId,@PathVariable String entityGuid, PropertyFacet propertyFacet)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updatePropertyFacetById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = PropertyFacetMapper.mapPropertyFacetToOmrsEntityDetail(propertyFacet);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            PropertyFacet updatedPropertyFacet =  PropertyFacetMapper.mapOmrsEntityDetailToPropertyFacet(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated PropertyFacet="+ updatedPropertyFacet );
            }
            return updatedPropertyFacet;
        }

    /**
     * Delete an propertyFacet identified by its GUID. Delete is a soft delete, this means that the propertyFacet has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the propertyFacet
     * @return PropertyFacet
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/propertyFacets/guid/{propertyFacetGuid}")

    public void deletePropertyFacetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deletePropertyFacetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgePropertyFacetByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgePropertyFacetByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied propertyFacet
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/propertyFacets/{propertyFacetGuid}/classifications")
    public PropertyFacet addPropertyFacetClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addPropertyFacetClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         PropertyFacet propertyFacetClassifications = PropertyFacetMapper.mapOmrsEntityDetailToPropertyFacet(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified PropertyFacet=" +  propertyFacetClassifications);
         }
         return  propertyFacetClassifications;
    }

    /**
     * Updates classifications to an existing propertyFacet represented by a guid.
     * @param  entityGuid globally unique identifier for the propertyFacet
     * @return classification for the given propertyFacet guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/propertyFacets/{propertyFacetGuid}/classification")

    public PropertyFacet updatePropertyFacetClassification(@PathVariable("userId") String userId,@PathVariable("propertyFacetGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updatePropertyFacetClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           PropertyFacet  propertyFacetClassifications = PropertyFacetMapper.mapOmrsEntityDetailToPropertyFacet(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  propertyFacetClassifications;
    }

    /**
     * Deletes a given classification from an existing propertyFacet represented by a guid.
     * @param entityGuid  globally unique identifier for the propertyFacet
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/propertyFacets/{propertyFacetGuid}/classification/{name}")
    public PropertyFacet deletePropertyFacetClassification(@PathVariable("userId") String userId,@PathVariable("propertyFacetGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deletePropertyFacetClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       PropertyFacet declassifiedPropertyFacet =  PropertyFacetMapper.mapOmrsEntityDetailToPropertyFacet(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedPropertyFacet;
    }

    /**
      * Get the relationships associated with entity propertyFacet represented by a guid.
      * @param entityGuid  globally unique identifier for the propertyFacet
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/propertyFacets/guid/{entityGuid}/relationships")
    public List<Line> getPropertyFacetRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getPropertyFacetRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an project given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the projects relationships.
     * @param entityGuid GUID for the entity
     * @return Project
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/projects/guid/{entityGuid}")
    public Project getProjectById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getProjectById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Project gotproject = ProjectMapper.mapOmrsEntityDetailToProject(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotproject );
        }
        return gotproject;

    }
    /**
     * Create new project in Atlas.
     * @param project
     * @return Project
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/projects")
    public Project createProject(@PathVariable String userId,Project project)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createProjectById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Project");
        if (constraint!=null) {
             constraint.preCreate(project);
        }

        EntityDetail entityDetail = ProjectMapper.mapProjectToOmrsEntityDetail(project);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Project createdProject =  ProjectMapper.mapOmrsEntityDetailToProject(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Project="+ createdProject );
        }
        return createdProject;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/projects/guid/{projectGuid}")
    public Project updateProject(@PathVariable String userId,@PathVariable String entityGuid, Project project)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateProjectById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ProjectMapper.mapProjectToOmrsEntityDetail(project);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Project updatedProject =  ProjectMapper.mapOmrsEntityDetailToProject(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Project="+ updatedProject );
            }
            return updatedProject;
        }

    /**
     * Delete an project identified by its GUID. Delete is a soft delete, this means that the project has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the project
     * @return Project
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/projects/guid/{projectGuid}")

    public void deleteProjectByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteProjectByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeProjectByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeProjectByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied project
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/projects/{projectGuid}/classifications")
    public Project addProjectClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addProjectClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Project projectClassifications = ProjectMapper.mapOmrsEntityDetailToProject(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Project=" +  projectClassifications);
         }
         return  projectClassifications;
    }

    /**
     * Updates classifications to an existing project represented by a guid.
     * @param  entityGuid globally unique identifier for the project
     * @return classification for the given project guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/projects/{projectGuid}/classification")

    public Project updateProjectClassification(@PathVariable("userId") String userId,@PathVariable("projectGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateProjectClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Project  projectClassifications = ProjectMapper.mapOmrsEntityDetailToProject(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  projectClassifications;
    }

    /**
     * Deletes a given classification from an existing project represented by a guid.
     * @param entityGuid  globally unique identifier for the project
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/projects/{projectGuid}/classification/{name}")
    public Project deleteProjectClassification(@PathVariable("userId") String userId,@PathVariable("projectGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteProjectClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Project declassifiedProject =  ProjectMapper.mapOmrsEntityDetailToProject(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedProject;
    }

    /**
      * Get the relationships associated with entity project represented by a guid.
      * @param entityGuid  globally unique identifier for the project
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/projects/guid/{entityGuid}/relationships")
    public List<Line> getProjectRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getProjectRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an hostCluster given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the hostClusters relationships.
     * @param entityGuid GUID for the entity
     * @return HostCluster
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/hostClusters/guid/{entityGuid}")
    public HostCluster getHostClusterById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getHostClusterById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        HostCluster gothostCluster = HostClusterMapper.mapOmrsEntityDetailToHostCluster(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gothostCluster );
        }
        return gothostCluster;

    }
    /**
     * Create new hostCluster in Atlas.
     * @param hostCluster
     * @return HostCluster
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/hostClusters")
    public HostCluster createHostCluster(@PathVariable String userId,HostCluster hostCluster)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createHostClusterById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("HostCluster");
        if (constraint!=null) {
             constraint.preCreate(hostCluster);
        }

        EntityDetail entityDetail = HostClusterMapper.mapHostClusterToOmrsEntityDetail(hostCluster);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        HostCluster createdHostCluster =  HostClusterMapper.mapOmrsEntityDetailToHostCluster(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created HostCluster="+ createdHostCluster );
        }
        return createdHostCluster;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/hostClusters/guid/{hostClusterGuid}")
    public HostCluster updateHostCluster(@PathVariable String userId,@PathVariable String entityGuid, HostCluster hostCluster)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateHostClusterById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = HostClusterMapper.mapHostClusterToOmrsEntityDetail(hostCluster);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            HostCluster updatedHostCluster =  HostClusterMapper.mapOmrsEntityDetailToHostCluster(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated HostCluster="+ updatedHostCluster );
            }
            return updatedHostCluster;
        }

    /**
     * Delete an hostCluster identified by its GUID. Delete is a soft delete, this means that the hostCluster has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the hostCluster
     * @return HostCluster
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/hostClusters/guid/{hostClusterGuid}")

    public void deleteHostClusterByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteHostClusterByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeHostClusterByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeHostClusterByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied hostCluster
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/hostClusters/{hostClusterGuid}/classifications")
    public HostCluster addHostClusterClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addHostClusterClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         HostCluster hostClusterClassifications = HostClusterMapper.mapOmrsEntityDetailToHostCluster(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified HostCluster=" +  hostClusterClassifications);
         }
         return  hostClusterClassifications;
    }

    /**
     * Updates classifications to an existing hostCluster represented by a guid.
     * @param  entityGuid globally unique identifier for the hostCluster
     * @return classification for the given hostCluster guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/hostClusters/{hostClusterGuid}/classification")

    public HostCluster updateHostClusterClassification(@PathVariable("userId") String userId,@PathVariable("hostClusterGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateHostClusterClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           HostCluster  hostClusterClassifications = HostClusterMapper.mapOmrsEntityDetailToHostCluster(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  hostClusterClassifications;
    }

    /**
     * Deletes a given classification from an existing hostCluster represented by a guid.
     * @param entityGuid  globally unique identifier for the hostCluster
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/hostClusters/{hostClusterGuid}/classification/{name}")
    public HostCluster deleteHostClusterClassification(@PathVariable("userId") String userId,@PathVariable("hostClusterGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteHostClusterClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       HostCluster declassifiedHostCluster =  HostClusterMapper.mapOmrsEntityDetailToHostCluster(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedHostCluster;
    }

    /**
      * Get the relationships associated with entity hostCluster represented by a guid.
      * @param entityGuid  globally unique identifier for the hostCluster
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/hostClusters/guid/{entityGuid}/relationships")
    public List<Line> getHostClusterRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getHostClusterRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an glossary given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the glossaries relationships.
     * @param entityGuid GUID for the entity
     * @return Glossary
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/glossaries/guid/{entityGuid}")
    public Glossary getGlossaryById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGlossaryById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Glossary gotglossary = GlossaryMapper.mapOmrsEntityDetailToGlossary(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotglossary );
        }
        return gotglossary;

    }
    /**
     * Create new glossary in Atlas.
     * @param glossary
     * @return Glossary
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/glossaries")
    public Glossary createGlossary(@PathVariable String userId,Glossary glossary)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGlossaryById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Glossary");
        if (constraint!=null) {
             constraint.preCreate(glossary);
        }

        EntityDetail entityDetail = GlossaryMapper.mapGlossaryToOmrsEntityDetail(glossary);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Glossary createdGlossary =  GlossaryMapper.mapOmrsEntityDetailToGlossary(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Glossary="+ createdGlossary );
        }
        return createdGlossary;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/glossaries/guid/{glossaryGuid}")
    public Glossary updateGlossary(@PathVariable String userId,@PathVariable String entityGuid, Glossary glossary)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGlossaryById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GlossaryMapper.mapGlossaryToOmrsEntityDetail(glossary);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Glossary updatedGlossary =  GlossaryMapper.mapOmrsEntityDetailToGlossary(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Glossary="+ updatedGlossary );
            }
            return updatedGlossary;
        }

    /**
     * Delete an glossary identified by its GUID. Delete is a soft delete, this means that the glossary has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the glossary
     * @return Glossary
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/glossaries/guid/{glossaryGuid}")

    public void deleteGlossaryByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGlossaryByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGlossaryByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGlossaryByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied glossary
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/glossaries/{glossaryGuid}/classifications")
    public Glossary addGlossaryClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGlossaryClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Glossary glossaryClassifications = GlossaryMapper.mapOmrsEntityDetailToGlossary(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Glossary=" +  glossaryClassifications);
         }
         return  glossaryClassifications;
    }

    /**
     * Updates classifications to an existing glossary represented by a guid.
     * @param  entityGuid globally unique identifier for the glossary
     * @return classification for the given glossary guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/glossaries/{glossaryGuid}/classification")

    public Glossary updateGlossaryClassification(@PathVariable("userId") String userId,@PathVariable("glossaryGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGlossaryClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Glossary  glossaryClassifications = GlossaryMapper.mapOmrsEntityDetailToGlossary(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  glossaryClassifications;
    }

    /**
     * Deletes a given classification from an existing glossary represented by a guid.
     * @param entityGuid  globally unique identifier for the glossary
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/glossaries/{glossaryGuid}/classification/{name}")
    public Glossary deleteGlossaryClassification(@PathVariable("userId") String userId,@PathVariable("glossaryGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGlossaryClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Glossary declassifiedGlossary =  GlossaryMapper.mapOmrsEntityDetailToGlossary(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGlossary;
    }

    /**
      * Get the relationships associated with entity glossary represented by a guid.
      * @param entityGuid  globally unique identifier for the glossary
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/glossaries/guid/{entityGuid}/relationships")
    public List<Line> getGlossaryRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGlossaryRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an glossaryCategory given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the glossaryCategories relationships.
     * @param entityGuid GUID for the entity
     * @return GlossaryCategory
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/glossaryCategories/guid/{entityGuid}")
    public GlossaryCategory getGlossaryCategoryById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGlossaryCategoryById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GlossaryCategory gotglossaryCategory = GlossaryCategoryMapper.mapOmrsEntityDetailToGlossaryCategory(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotglossaryCategory );
        }
        return gotglossaryCategory;

    }
    /**
     * Create new glossaryCategory in Atlas.
     * @param glossaryCategory
     * @return GlossaryCategory
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/glossaryCategories")
    public GlossaryCategory createGlossaryCategory(@PathVariable String userId,GlossaryCategory glossaryCategory)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGlossaryCategoryById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GlossaryCategory");
        if (constraint!=null) {
             constraint.preCreate(glossaryCategory);
        }

        EntityDetail entityDetail = GlossaryCategoryMapper.mapGlossaryCategoryToOmrsEntityDetail(glossaryCategory);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GlossaryCategory createdGlossaryCategory =  GlossaryCategoryMapper.mapOmrsEntityDetailToGlossaryCategory(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GlossaryCategory="+ createdGlossaryCategory );
        }
        return createdGlossaryCategory;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/glossaryCategories/guid/{glossaryCategoryGuid}")
    public GlossaryCategory updateGlossaryCategory(@PathVariable String userId,@PathVariable String entityGuid, GlossaryCategory glossaryCategory)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGlossaryCategoryById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GlossaryCategoryMapper.mapGlossaryCategoryToOmrsEntityDetail(glossaryCategory);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GlossaryCategory updatedGlossaryCategory =  GlossaryCategoryMapper.mapOmrsEntityDetailToGlossaryCategory(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GlossaryCategory="+ updatedGlossaryCategory );
            }
            return updatedGlossaryCategory;
        }

    /**
     * Delete an glossaryCategory identified by its GUID. Delete is a soft delete, this means that the glossaryCategory has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the glossaryCategory
     * @return GlossaryCategory
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/glossaryCategories/guid/{glossaryCategoryGuid}")

    public void deleteGlossaryCategoryByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGlossaryCategoryByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGlossaryCategoryByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGlossaryCategoryByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied glossaryCategory
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/glossaryCategories/{glossaryCategoryGuid}/classifications")
    public GlossaryCategory addGlossaryCategoryClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGlossaryCategoryClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GlossaryCategory glossaryCategoryClassifications = GlossaryCategoryMapper.mapOmrsEntityDetailToGlossaryCategory(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GlossaryCategory=" +  glossaryCategoryClassifications);
         }
         return  glossaryCategoryClassifications;
    }

    /**
     * Updates classifications to an existing glossaryCategory represented by a guid.
     * @param  entityGuid globally unique identifier for the glossaryCategory
     * @return classification for the given glossaryCategory guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/glossaryCategories/{glossaryCategoryGuid}/classification")

    public GlossaryCategory updateGlossaryCategoryClassification(@PathVariable("userId") String userId,@PathVariable("glossaryCategoryGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGlossaryCategoryClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GlossaryCategory  glossaryCategoryClassifications = GlossaryCategoryMapper.mapOmrsEntityDetailToGlossaryCategory(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  glossaryCategoryClassifications;
    }

    /**
     * Deletes a given classification from an existing glossaryCategory represented by a guid.
     * @param entityGuid  globally unique identifier for the glossaryCategory
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/glossaryCategories/{glossaryCategoryGuid}/classification/{name}")
    public GlossaryCategory deleteGlossaryCategoryClassification(@PathVariable("userId") String userId,@PathVariable("glossaryCategoryGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGlossaryCategoryClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GlossaryCategory declassifiedGlossaryCategory =  GlossaryCategoryMapper.mapOmrsEntityDetailToGlossaryCategory(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGlossaryCategory;
    }

    /**
      * Get the relationships associated with entity glossaryCategory represented by a guid.
      * @param entityGuid  globally unique identifier for the glossaryCategory
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/glossaryCategories/guid/{entityGuid}/relationships")
    public List<Line> getGlossaryCategoryRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGlossaryCategoryRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an mediaCollection given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the mediaCollections relationships.
     * @param entityGuid GUID for the entity
     * @return MediaCollection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/mediaCollections/guid/{entityGuid}")
    public MediaCollection getMediaCollectionById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getMediaCollectionById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        MediaCollection gotmediaCollection = MediaCollectionMapper.mapOmrsEntityDetailToMediaCollection(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotmediaCollection );
        }
        return gotmediaCollection;

    }
    /**
     * Create new mediaCollection in Atlas.
     * @param mediaCollection
     * @return MediaCollection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/mediaCollections")
    public MediaCollection createMediaCollection(@PathVariable String userId,MediaCollection mediaCollection)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createMediaCollectionById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("MediaCollection");
        if (constraint!=null) {
             constraint.preCreate(mediaCollection);
        }

        EntityDetail entityDetail = MediaCollectionMapper.mapMediaCollectionToOmrsEntityDetail(mediaCollection);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        MediaCollection createdMediaCollection =  MediaCollectionMapper.mapOmrsEntityDetailToMediaCollection(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created MediaCollection="+ createdMediaCollection );
        }
        return createdMediaCollection;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/mediaCollections/guid/{mediaCollectionGuid}")
    public MediaCollection updateMediaCollection(@PathVariable String userId,@PathVariable String entityGuid, MediaCollection mediaCollection)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateMediaCollectionById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = MediaCollectionMapper.mapMediaCollectionToOmrsEntityDetail(mediaCollection);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            MediaCollection updatedMediaCollection =  MediaCollectionMapper.mapOmrsEntityDetailToMediaCollection(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated MediaCollection="+ updatedMediaCollection );
            }
            return updatedMediaCollection;
        }

    /**
     * Delete an mediaCollection identified by its GUID. Delete is a soft delete, this means that the mediaCollection has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the mediaCollection
     * @return MediaCollection
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/mediaCollections/guid/{mediaCollectionGuid}")

    public void deleteMediaCollectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteMediaCollectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeMediaCollectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeMediaCollectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied mediaCollection
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/mediaCollections/{mediaCollectionGuid}/classifications")
    public MediaCollection addMediaCollectionClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addMediaCollectionClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         MediaCollection mediaCollectionClassifications = MediaCollectionMapper.mapOmrsEntityDetailToMediaCollection(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified MediaCollection=" +  mediaCollectionClassifications);
         }
         return  mediaCollectionClassifications;
    }

    /**
     * Updates classifications to an existing mediaCollection represented by a guid.
     * @param  entityGuid globally unique identifier for the mediaCollection
     * @return classification for the given mediaCollection guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/mediaCollections/{mediaCollectionGuid}/classification")

    public MediaCollection updateMediaCollectionClassification(@PathVariable("userId") String userId,@PathVariable("mediaCollectionGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateMediaCollectionClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           MediaCollection  mediaCollectionClassifications = MediaCollectionMapper.mapOmrsEntityDetailToMediaCollection(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  mediaCollectionClassifications;
    }

    /**
     * Deletes a given classification from an existing mediaCollection represented by a guid.
     * @param entityGuid  globally unique identifier for the mediaCollection
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/mediaCollections/{mediaCollectionGuid}/classification/{name}")
    public MediaCollection deleteMediaCollectionClassification(@PathVariable("userId") String userId,@PathVariable("mediaCollectionGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteMediaCollectionClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       MediaCollection declassifiedMediaCollection =  MediaCollectionMapper.mapOmrsEntityDetailToMediaCollection(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedMediaCollection;
    }

    /**
      * Get the relationships associated with entity mediaCollection represented by a guid.
      * @param entityGuid  globally unique identifier for the mediaCollection
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/mediaCollections/guid/{entityGuid}/relationships")
    public List<Line> getMediaCollectionRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getMediaCollectionRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an collection given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the collections relationships.
     * @param entityGuid GUID for the entity
     * @return Collection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/collections/guid/{entityGuid}")
    public Collection getCollectionById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getCollectionById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Collection gotcollection = CollectionMapper.mapOmrsEntityDetailToCollection(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcollection );
        }
        return gotcollection;

    }
    /**
     * Create new collection in Atlas.
     * @param collection
     * @return Collection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/collections")
    public Collection createCollection(@PathVariable String userId,Collection collection)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createCollectionById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Collection");
        if (constraint!=null) {
             constraint.preCreate(collection);
        }

        EntityDetail entityDetail = CollectionMapper.mapCollectionToOmrsEntityDetail(collection);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Collection createdCollection =  CollectionMapper.mapOmrsEntityDetailToCollection(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Collection="+ createdCollection );
        }
        return createdCollection;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/collections/guid/{collectionGuid}")
    public Collection updateCollection(@PathVariable String userId,@PathVariable String entityGuid, Collection collection)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateCollectionById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = CollectionMapper.mapCollectionToOmrsEntityDetail(collection);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Collection updatedCollection =  CollectionMapper.mapOmrsEntityDetailToCollection(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Collection="+ updatedCollection );
            }
            return updatedCollection;
        }

    /**
     * Delete an collection identified by its GUID. Delete is a soft delete, this means that the collection has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the collection
     * @return Collection
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/collections/guid/{collectionGuid}")

    public void deleteCollectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteCollectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeCollectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeCollectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied collection
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/collections/{collectionGuid}/classifications")
    public Collection addCollectionClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addCollectionClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Collection collectionClassifications = CollectionMapper.mapOmrsEntityDetailToCollection(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Collection=" +  collectionClassifications);
         }
         return  collectionClassifications;
    }

    /**
     * Updates classifications to an existing collection represented by a guid.
     * @param  entityGuid globally unique identifier for the collection
     * @return classification for the given collection guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/collections/{collectionGuid}/classification")

    public Collection updateCollectionClassification(@PathVariable("userId") String userId,@PathVariable("collectionGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateCollectionClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Collection  collectionClassifications = CollectionMapper.mapOmrsEntityDetailToCollection(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  collectionClassifications;
    }

    /**
     * Deletes a given classification from an existing collection represented by a guid.
     * @param entityGuid  globally unique identifier for the collection
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/collections/{collectionGuid}/classification/{name}")
    public Collection deleteCollectionClassification(@PathVariable("userId") String userId,@PathVariable("collectionGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteCollectionClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Collection declassifiedCollection =  CollectionMapper.mapOmrsEntityDetailToCollection(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedCollection;
    }

    /**
      * Get the relationships associated with entity collection represented by a guid.
      * @param entityGuid  globally unique identifier for the collection
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/collections/guid/{entityGuid}/relationships")
    public List<Line> getCollectionRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getCollectionRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an informalTag given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the informalTags relationships.
     * @param entityGuid GUID for the entity
     * @return InformalTag
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/informalTags/guid/{entityGuid}")
    public InformalTag getInformalTagById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getInformalTagById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        InformalTag gotinformalTag = InformalTagMapper.mapOmrsEntityDetailToInformalTag(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotinformalTag );
        }
        return gotinformalTag;

    }
    /**
     * Create new informalTag in Atlas.
     * @param informalTag
     * @return InformalTag
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/informalTags")
    public InformalTag createInformalTag(@PathVariable String userId,InformalTag informalTag)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createInformalTagById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("InformalTag");
        if (constraint!=null) {
             constraint.preCreate(informalTag);
        }

        EntityDetail entityDetail = InformalTagMapper.mapInformalTagToOmrsEntityDetail(informalTag);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        InformalTag createdInformalTag =  InformalTagMapper.mapOmrsEntityDetailToInformalTag(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created InformalTag="+ createdInformalTag );
        }
        return createdInformalTag;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/informalTags/guid/{informalTagGuid}")
    public InformalTag updateInformalTag(@PathVariable String userId,@PathVariable String entityGuid, InformalTag informalTag)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateInformalTagById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = InformalTagMapper.mapInformalTagToOmrsEntityDetail(informalTag);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            InformalTag updatedInformalTag =  InformalTagMapper.mapOmrsEntityDetailToInformalTag(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated InformalTag="+ updatedInformalTag );
            }
            return updatedInformalTag;
        }

    /**
     * Delete an informalTag identified by its GUID. Delete is a soft delete, this means that the informalTag has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the informalTag
     * @return InformalTag
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/informalTags/guid/{informalTagGuid}")

    public void deleteInformalTagByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteInformalTagByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeInformalTagByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeInformalTagByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied informalTag
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/informalTags/{informalTagGuid}/classifications")
    public InformalTag addInformalTagClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addInformalTagClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         InformalTag informalTagClassifications = InformalTagMapper.mapOmrsEntityDetailToInformalTag(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified InformalTag=" +  informalTagClassifications);
         }
         return  informalTagClassifications;
    }

    /**
     * Updates classifications to an existing informalTag represented by a guid.
     * @param  entityGuid globally unique identifier for the informalTag
     * @return classification for the given informalTag guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/informalTags/{informalTagGuid}/classification")

    public InformalTag updateInformalTagClassification(@PathVariable("userId") String userId,@PathVariable("informalTagGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateInformalTagClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           InformalTag  informalTagClassifications = InformalTagMapper.mapOmrsEntityDetailToInformalTag(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  informalTagClassifications;
    }

    /**
     * Deletes a given classification from an existing informalTag represented by a guid.
     * @param entityGuid  globally unique identifier for the informalTag
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/informalTags/{informalTagGuid}/classification/{name}")
    public InformalTag deleteInformalTagClassification(@PathVariable("userId") String userId,@PathVariable("informalTagGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteInformalTagClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       InformalTag declassifiedInformalTag =  InformalTagMapper.mapOmrsEntityDetailToInformalTag(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedInformalTag;
    }

    /**
      * Get the relationships associated with entity informalTag represented by a guid.
      * @param entityGuid  globally unique identifier for the informalTag
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/informalTags/guid/{entityGuid}/relationships")
    public List<Line> getInformalTagRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getInformalTagRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceZone given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceZones relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceZone
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceZones/guid/{entityGuid}")
    public GovernanceZone getGovernanceZoneById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceZoneById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceZone gotgovernanceZone = GovernanceZoneMapper.mapOmrsEntityDetailToGovernanceZone(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceZone );
        }
        return gotgovernanceZone;

    }
    /**
     * Create new governanceZone in Atlas.
     * @param governanceZone
     * @return GovernanceZone
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceZones")
    public GovernanceZone createGovernanceZone(@PathVariable String userId,GovernanceZone governanceZone)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceZoneById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceZone");
        if (constraint!=null) {
             constraint.preCreate(governanceZone);
        }

        EntityDetail entityDetail = GovernanceZoneMapper.mapGovernanceZoneToOmrsEntityDetail(governanceZone);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceZone createdGovernanceZone =  GovernanceZoneMapper.mapOmrsEntityDetailToGovernanceZone(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceZone="+ createdGovernanceZone );
        }
        return createdGovernanceZone;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceZones/guid/{governanceZoneGuid}")
    public GovernanceZone updateGovernanceZone(@PathVariable String userId,@PathVariable String entityGuid, GovernanceZone governanceZone)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceZoneById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceZoneMapper.mapGovernanceZoneToOmrsEntityDetail(governanceZone);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceZone updatedGovernanceZone =  GovernanceZoneMapper.mapOmrsEntityDetailToGovernanceZone(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceZone="+ updatedGovernanceZone );
            }
            return updatedGovernanceZone;
        }

    /**
     * Delete an governanceZone identified by its GUID. Delete is a soft delete, this means that the governanceZone has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceZone
     * @return GovernanceZone
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceZones/guid/{governanceZoneGuid}")

    public void deleteGovernanceZoneByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceZoneByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceZoneByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceZoneByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceZone
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceZones/{governanceZoneGuid}/classifications")
    public GovernanceZone addGovernanceZoneClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceZoneClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceZone governanceZoneClassifications = GovernanceZoneMapper.mapOmrsEntityDetailToGovernanceZone(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceZone=" +  governanceZoneClassifications);
         }
         return  governanceZoneClassifications;
    }

    /**
     * Updates classifications to an existing governanceZone represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceZone
     * @return classification for the given governanceZone guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceZones/{governanceZoneGuid}/classification")

    public GovernanceZone updateGovernanceZoneClassification(@PathVariable("userId") String userId,@PathVariable("governanceZoneGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceZoneClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceZone  governanceZoneClassifications = GovernanceZoneMapper.mapOmrsEntityDetailToGovernanceZone(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceZoneClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceZone represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceZone
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceZones/{governanceZoneGuid}/classification/{name}")
    public GovernanceZone deleteGovernanceZoneClassification(@PathVariable("userId") String userId,@PathVariable("governanceZoneGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceZoneClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceZone declassifiedGovernanceZone =  GovernanceZoneMapper.mapOmrsEntityDetailToGovernanceZone(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceZone;
    }

    /**
      * Get the relationships associated with entity governanceZone represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceZone
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceZones/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceZoneRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceZoneRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an person given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the persons relationships.
     * @param entityGuid GUID for the entity
     * @return Person
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/persons/guid/{entityGuid}")
    public Person getPersonById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getPersonById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Person gotperson = PersonMapper.mapOmrsEntityDetailToPerson(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotperson );
        }
        return gotperson;

    }
    /**
     * Create new person in Atlas.
     * @param person
     * @return Person
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/persons")
    public Person createPerson(@PathVariable String userId,Person person)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createPersonById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Person");
        if (constraint!=null) {
             constraint.preCreate(person);
        }

        EntityDetail entityDetail = PersonMapper.mapPersonToOmrsEntityDetail(person);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Person createdPerson =  PersonMapper.mapOmrsEntityDetailToPerson(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Person="+ createdPerson );
        }
        return createdPerson;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/persons/guid/{personGuid}")
    public Person updatePerson(@PathVariable String userId,@PathVariable String entityGuid, Person person)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updatePersonById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = PersonMapper.mapPersonToOmrsEntityDetail(person);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Person updatedPerson =  PersonMapper.mapOmrsEntityDetailToPerson(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Person="+ updatedPerson );
            }
            return updatedPerson;
        }

    /**
     * Delete an person identified by its GUID. Delete is a soft delete, this means that the person has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the person
     * @return Person
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/persons/guid/{personGuid}")

    public void deletePersonByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deletePersonByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgePersonByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgePersonByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied person
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/persons/{personGuid}/classifications")
    public Person addPersonClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addPersonClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Person personClassifications = PersonMapper.mapOmrsEntityDetailToPerson(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Person=" +  personClassifications);
         }
         return  personClassifications;
    }

    /**
     * Updates classifications to an existing person represented by a guid.
     * @param  entityGuid globally unique identifier for the person
     * @return classification for the given person guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/persons/{personGuid}/classification")

    public Person updatePersonClassification(@PathVariable("userId") String userId,@PathVariable("personGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updatePersonClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Person  personClassifications = PersonMapper.mapOmrsEntityDetailToPerson(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  personClassifications;
    }

    /**
     * Deletes a given classification from an existing person represented by a guid.
     * @param entityGuid  globally unique identifier for the person
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/persons/{personGuid}/classification/{name}")
    public Person deletePersonClassification(@PathVariable("userId") String userId,@PathVariable("personGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deletePersonClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Person declassifiedPerson =  PersonMapper.mapOmrsEntityDetailToPerson(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedPerson;
    }

    /**
      * Get the relationships associated with entity person represented by a guid.
      * @param entityGuid  globally unique identifier for the person
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/persons/guid/{entityGuid}/relationships")
    public List<Line> getPersonRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getPersonRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an application given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the applications relationships.
     * @param entityGuid GUID for the entity
     * @return Application
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/applications/guid/{entityGuid}")
    public Application getApplicationById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getApplicationById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Application gotapplication = ApplicationMapper.mapOmrsEntityDetailToApplication(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotapplication );
        }
        return gotapplication;

    }
    /**
     * Create new application in Atlas.
     * @param application
     * @return Application
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/applications")
    public Application createApplication(@PathVariable String userId,Application application)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createApplicationById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Application");
        if (constraint!=null) {
             constraint.preCreate(application);
        }

        EntityDetail entityDetail = ApplicationMapper.mapApplicationToOmrsEntityDetail(application);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Application createdApplication =  ApplicationMapper.mapOmrsEntityDetailToApplication(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Application="+ createdApplication );
        }
        return createdApplication;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/applications/guid/{applicationGuid}")
    public Application updateApplication(@PathVariable String userId,@PathVariable String entityGuid, Application application)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateApplicationById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ApplicationMapper.mapApplicationToOmrsEntityDetail(application);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Application updatedApplication =  ApplicationMapper.mapOmrsEntityDetailToApplication(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Application="+ updatedApplication );
            }
            return updatedApplication;
        }

    /**
     * Delete an application identified by its GUID. Delete is a soft delete, this means that the application has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the application
     * @return Application
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/applications/guid/{applicationGuid}")

    public void deleteApplicationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteApplicationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeApplicationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeApplicationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied application
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/applications/{applicationGuid}/classifications")
    public Application addApplicationClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addApplicationClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Application applicationClassifications = ApplicationMapper.mapOmrsEntityDetailToApplication(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Application=" +  applicationClassifications);
         }
         return  applicationClassifications;
    }

    /**
     * Updates classifications to an existing application represented by a guid.
     * @param  entityGuid globally unique identifier for the application
     * @return classification for the given application guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/applications/{applicationGuid}/classification")

    public Application updateApplicationClassification(@PathVariable("userId") String userId,@PathVariable("applicationGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateApplicationClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Application  applicationClassifications = ApplicationMapper.mapOmrsEntityDetailToApplication(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  applicationClassifications;
    }

    /**
     * Deletes a given classification from an existing application represented by a guid.
     * @param entityGuid  globally unique identifier for the application
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/applications/{applicationGuid}/classification/{name}")
    public Application deleteApplicationClassification(@PathVariable("userId") String userId,@PathVariable("applicationGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteApplicationClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Application declassifiedApplication =  ApplicationMapper.mapOmrsEntityDetailToApplication(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedApplication;
    }

    /**
      * Get the relationships associated with entity application represented by a guid.
      * @param entityGuid  globally unique identifier for the application
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/applications/guid/{entityGuid}/relationships")
    public List<Line> getApplicationRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getApplicationRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an virtualContainer given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the virtualContainers relationships.
     * @param entityGuid GUID for the entity
     * @return VirtualContainer
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/virtualContainers/guid/{entityGuid}")
    public VirtualContainer getVirtualContainerById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getVirtualContainerById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        VirtualContainer gotvirtualContainer = VirtualContainerMapper.mapOmrsEntityDetailToVirtualContainer(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotvirtualContainer );
        }
        return gotvirtualContainer;

    }
    /**
     * Create new virtualContainer in Atlas.
     * @param virtualContainer
     * @return VirtualContainer
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/virtualContainers")
    public VirtualContainer createVirtualContainer(@PathVariable String userId,VirtualContainer virtualContainer)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createVirtualContainerById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("VirtualContainer");
        if (constraint!=null) {
             constraint.preCreate(virtualContainer);
        }

        EntityDetail entityDetail = VirtualContainerMapper.mapVirtualContainerToOmrsEntityDetail(virtualContainer);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        VirtualContainer createdVirtualContainer =  VirtualContainerMapper.mapOmrsEntityDetailToVirtualContainer(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created VirtualContainer="+ createdVirtualContainer );
        }
        return createdVirtualContainer;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/virtualContainers/guid/{virtualContainerGuid}")
    public VirtualContainer updateVirtualContainer(@PathVariable String userId,@PathVariable String entityGuid, VirtualContainer virtualContainer)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateVirtualContainerById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = VirtualContainerMapper.mapVirtualContainerToOmrsEntityDetail(virtualContainer);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            VirtualContainer updatedVirtualContainer =  VirtualContainerMapper.mapOmrsEntityDetailToVirtualContainer(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated VirtualContainer="+ updatedVirtualContainer );
            }
            return updatedVirtualContainer;
        }

    /**
     * Delete an virtualContainer identified by its GUID. Delete is a soft delete, this means that the virtualContainer has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the virtualContainer
     * @return VirtualContainer
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/virtualContainers/guid/{virtualContainerGuid}")

    public void deleteVirtualContainerByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteVirtualContainerByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeVirtualContainerByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeVirtualContainerByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied virtualContainer
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/virtualContainers/{virtualContainerGuid}/classifications")
    public VirtualContainer addVirtualContainerClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addVirtualContainerClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         VirtualContainer virtualContainerClassifications = VirtualContainerMapper.mapOmrsEntityDetailToVirtualContainer(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified VirtualContainer=" +  virtualContainerClassifications);
         }
         return  virtualContainerClassifications;
    }

    /**
     * Updates classifications to an existing virtualContainer represented by a guid.
     * @param  entityGuid globally unique identifier for the virtualContainer
     * @return classification for the given virtualContainer guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/virtualContainers/{virtualContainerGuid}/classification")

    public VirtualContainer updateVirtualContainerClassification(@PathVariable("userId") String userId,@PathVariable("virtualContainerGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateVirtualContainerClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           VirtualContainer  virtualContainerClassifications = VirtualContainerMapper.mapOmrsEntityDetailToVirtualContainer(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  virtualContainerClassifications;
    }

    /**
     * Deletes a given classification from an existing virtualContainer represented by a guid.
     * @param entityGuid  globally unique identifier for the virtualContainer
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/virtualContainers/{virtualContainerGuid}/classification/{name}")
    public VirtualContainer deleteVirtualContainerClassification(@PathVariable("userId") String userId,@PathVariable("virtualContainerGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteVirtualContainerClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       VirtualContainer declassifiedVirtualContainer =  VirtualContainerMapper.mapOmrsEntityDetailToVirtualContainer(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedVirtualContainer;
    }

    /**
      * Get the relationships associated with entity virtualContainer represented by a guid.
      * @param entityGuid  globally unique identifier for the virtualContainer
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/virtualContainers/guid/{entityGuid}/relationships")
    public List<Line> getVirtualContainerRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getVirtualContainerRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceDriver given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceDrivers relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceDriver
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceDrivers/guid/{entityGuid}")
    public GovernanceDriver getGovernanceDriverById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceDriverById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceDriver gotgovernanceDriver = GovernanceDriverMapper.mapOmrsEntityDetailToGovernanceDriver(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceDriver );
        }
        return gotgovernanceDriver;

    }
    /**
     * Create new governanceDriver in Atlas.
     * @param governanceDriver
     * @return GovernanceDriver
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceDrivers")
    public GovernanceDriver createGovernanceDriver(@PathVariable String userId,GovernanceDriver governanceDriver)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceDriverById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceDriver");
        if (constraint!=null) {
             constraint.preCreate(governanceDriver);
        }

        EntityDetail entityDetail = GovernanceDriverMapper.mapGovernanceDriverToOmrsEntityDetail(governanceDriver);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceDriver createdGovernanceDriver =  GovernanceDriverMapper.mapOmrsEntityDetailToGovernanceDriver(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceDriver="+ createdGovernanceDriver );
        }
        return createdGovernanceDriver;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceDrivers/guid/{governanceDriverGuid}")
    public GovernanceDriver updateGovernanceDriver(@PathVariable String userId,@PathVariable String entityGuid, GovernanceDriver governanceDriver)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceDriverById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceDriverMapper.mapGovernanceDriverToOmrsEntityDetail(governanceDriver);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceDriver updatedGovernanceDriver =  GovernanceDriverMapper.mapOmrsEntityDetailToGovernanceDriver(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceDriver="+ updatedGovernanceDriver );
            }
            return updatedGovernanceDriver;
        }

    /**
     * Delete an governanceDriver identified by its GUID. Delete is a soft delete, this means that the governanceDriver has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceDriver
     * @return GovernanceDriver
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceDrivers/guid/{governanceDriverGuid}")

    public void deleteGovernanceDriverByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceDriverByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceDriverByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceDriverByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceDriver
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceDrivers/{governanceDriverGuid}/classifications")
    public GovernanceDriver addGovernanceDriverClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceDriverClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceDriver governanceDriverClassifications = GovernanceDriverMapper.mapOmrsEntityDetailToGovernanceDriver(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceDriver=" +  governanceDriverClassifications);
         }
         return  governanceDriverClassifications;
    }

    /**
     * Updates classifications to an existing governanceDriver represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceDriver
     * @return classification for the given governanceDriver guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceDrivers/{governanceDriverGuid}/classification")

    public GovernanceDriver updateGovernanceDriverClassification(@PathVariable("userId") String userId,@PathVariable("governanceDriverGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceDriverClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceDriver  governanceDriverClassifications = GovernanceDriverMapper.mapOmrsEntityDetailToGovernanceDriver(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceDriverClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceDriver represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceDriver
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceDrivers/{governanceDriverGuid}/classification/{name}")
    public GovernanceDriver deleteGovernanceDriverClassification(@PathVariable("userId") String userId,@PathVariable("governanceDriverGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceDriverClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceDriver declassifiedGovernanceDriver =  GovernanceDriverMapper.mapOmrsEntityDetailToGovernanceDriver(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceDriver;
    }

    /**
      * Get the relationships associated with entity governanceDriver represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceDriver
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceDrivers/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceDriverRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceDriverRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an meeting given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the meetings relationships.
     * @param entityGuid GUID for the entity
     * @return Meeting
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/meetings/guid/{entityGuid}")
    public Meeting getMeetingById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getMeetingById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Meeting gotmeeting = MeetingMapper.mapOmrsEntityDetailToMeeting(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotmeeting );
        }
        return gotmeeting;

    }
    /**
     * Create new meeting in Atlas.
     * @param meeting
     * @return Meeting
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/meetings")
    public Meeting createMeeting(@PathVariable String userId,Meeting meeting)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createMeetingById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Meeting");
        if (constraint!=null) {
             constraint.preCreate(meeting);
        }

        EntityDetail entityDetail = MeetingMapper.mapMeetingToOmrsEntityDetail(meeting);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Meeting createdMeeting =  MeetingMapper.mapOmrsEntityDetailToMeeting(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Meeting="+ createdMeeting );
        }
        return createdMeeting;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/meetings/guid/{meetingGuid}")
    public Meeting updateMeeting(@PathVariable String userId,@PathVariable String entityGuid, Meeting meeting)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateMeetingById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = MeetingMapper.mapMeetingToOmrsEntityDetail(meeting);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Meeting updatedMeeting =  MeetingMapper.mapOmrsEntityDetailToMeeting(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Meeting="+ updatedMeeting );
            }
            return updatedMeeting;
        }

    /**
     * Delete an meeting identified by its GUID. Delete is a soft delete, this means that the meeting has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the meeting
     * @return Meeting
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/meetings/guid/{meetingGuid}")

    public void deleteMeetingByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteMeetingByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeMeetingByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeMeetingByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied meeting
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/meetings/{meetingGuid}/classifications")
    public Meeting addMeetingClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addMeetingClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Meeting meetingClassifications = MeetingMapper.mapOmrsEntityDetailToMeeting(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Meeting=" +  meetingClassifications);
         }
         return  meetingClassifications;
    }

    /**
     * Updates classifications to an existing meeting represented by a guid.
     * @param  entityGuid globally unique identifier for the meeting
     * @return classification for the given meeting guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/meetings/{meetingGuid}/classification")

    public Meeting updateMeetingClassification(@PathVariable("userId") String userId,@PathVariable("meetingGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateMeetingClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Meeting  meetingClassifications = MeetingMapper.mapOmrsEntityDetailToMeeting(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  meetingClassifications;
    }

    /**
     * Deletes a given classification from an existing meeting represented by a guid.
     * @param entityGuid  globally unique identifier for the meeting
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/meetings/{meetingGuid}/classification/{name}")
    public Meeting deleteMeetingClassification(@PathVariable("userId") String userId,@PathVariable("meetingGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteMeetingClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Meeting declassifiedMeeting =  MeetingMapper.mapOmrsEntityDetailToMeeting(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedMeeting;
    }

    /**
      * Get the relationships associated with entity meeting represented by a guid.
      * @param entityGuid  globally unique identifier for the meeting
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/meetings/guid/{entityGuid}/relationships")
    public List<Line> getMeetingRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getMeetingRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an rating given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the ratings relationships.
     * @param entityGuid GUID for the entity
     * @return Rating
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/ratings/guid/{entityGuid}")
    public Rating getRatingById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getRatingById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Rating gotrating = RatingMapper.mapOmrsEntityDetailToRating(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotrating );
        }
        return gotrating;

    }
    /**
     * Create new rating in Atlas.
     * @param rating
     * @return Rating
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/ratings")
    public Rating createRating(@PathVariable String userId,Rating rating)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createRatingById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Rating");
        if (constraint!=null) {
             constraint.preCreate(rating);
        }

        EntityDetail entityDetail = RatingMapper.mapRatingToOmrsEntityDetail(rating);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Rating createdRating =  RatingMapper.mapOmrsEntityDetailToRating(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Rating="+ createdRating );
        }
        return createdRating;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/ratings/guid/{ratingGuid}")
    public Rating updateRating(@PathVariable String userId,@PathVariable String entityGuid, Rating rating)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateRatingById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = RatingMapper.mapRatingToOmrsEntityDetail(rating);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Rating updatedRating =  RatingMapper.mapOmrsEntityDetailToRating(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Rating="+ updatedRating );
            }
            return updatedRating;
        }

    /**
     * Delete an rating identified by its GUID. Delete is a soft delete, this means that the rating has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the rating
     * @return Rating
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/ratings/guid/{ratingGuid}")

    public void deleteRatingByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteRatingByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeRatingByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeRatingByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied rating
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/ratings/{ratingGuid}/classifications")
    public Rating addRatingClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addRatingClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Rating ratingClassifications = RatingMapper.mapOmrsEntityDetailToRating(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Rating=" +  ratingClassifications);
         }
         return  ratingClassifications;
    }

    /**
     * Updates classifications to an existing rating represented by a guid.
     * @param  entityGuid globally unique identifier for the rating
     * @return classification for the given rating guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/ratings/{ratingGuid}/classification")

    public Rating updateRatingClassification(@PathVariable("userId") String userId,@PathVariable("ratingGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateRatingClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Rating  ratingClassifications = RatingMapper.mapOmrsEntityDetailToRating(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  ratingClassifications;
    }

    /**
     * Deletes a given classification from an existing rating represented by a guid.
     * @param entityGuid  globally unique identifier for the rating
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/ratings/{ratingGuid}/classification/{name}")
    public Rating deleteRatingClassification(@PathVariable("userId") String userId,@PathVariable("ratingGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteRatingClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Rating declassifiedRating =  RatingMapper.mapOmrsEntityDetailToRating(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedRating;
    }

    /**
      * Get the relationships associated with entity rating represented by a guid.
      * @param entityGuid  globally unique identifier for the rating
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/ratings/guid/{entityGuid}/relationships")
    public List<Line> getRatingRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getRatingRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an projectCharter given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the projectCharters relationships.
     * @param entityGuid GUID for the entity
     * @return ProjectCharter
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/projectCharters/guid/{entityGuid}")
    public ProjectCharter getProjectCharterById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getProjectCharterById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ProjectCharter gotprojectCharter = ProjectCharterMapper.mapOmrsEntityDetailToProjectCharter(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotprojectCharter );
        }
        return gotprojectCharter;

    }
    /**
     * Create new projectCharter in Atlas.
     * @param projectCharter
     * @return ProjectCharter
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/projectCharters")
    public ProjectCharter createProjectCharter(@PathVariable String userId,ProjectCharter projectCharter)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createProjectCharterById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ProjectCharter");
        if (constraint!=null) {
             constraint.preCreate(projectCharter);
        }

        EntityDetail entityDetail = ProjectCharterMapper.mapProjectCharterToOmrsEntityDetail(projectCharter);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ProjectCharter createdProjectCharter =  ProjectCharterMapper.mapOmrsEntityDetailToProjectCharter(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ProjectCharter="+ createdProjectCharter );
        }
        return createdProjectCharter;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/projectCharters/guid/{projectCharterGuid}")
    public ProjectCharter updateProjectCharter(@PathVariable String userId,@PathVariable String entityGuid, ProjectCharter projectCharter)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateProjectCharterById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ProjectCharterMapper.mapProjectCharterToOmrsEntityDetail(projectCharter);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ProjectCharter updatedProjectCharter =  ProjectCharterMapper.mapOmrsEntityDetailToProjectCharter(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ProjectCharter="+ updatedProjectCharter );
            }
            return updatedProjectCharter;
        }

    /**
     * Delete an projectCharter identified by its GUID. Delete is a soft delete, this means that the projectCharter has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the projectCharter
     * @return ProjectCharter
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/projectCharters/guid/{projectCharterGuid}")

    public void deleteProjectCharterByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteProjectCharterByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeProjectCharterByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeProjectCharterByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied projectCharter
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/projectCharters/{projectCharterGuid}/classifications")
    public ProjectCharter addProjectCharterClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addProjectCharterClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ProjectCharter projectCharterClassifications = ProjectCharterMapper.mapOmrsEntityDetailToProjectCharter(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ProjectCharter=" +  projectCharterClassifications);
         }
         return  projectCharterClassifications;
    }

    /**
     * Updates classifications to an existing projectCharter represented by a guid.
     * @param  entityGuid globally unique identifier for the projectCharter
     * @return classification for the given projectCharter guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/projectCharters/{projectCharterGuid}/classification")

    public ProjectCharter updateProjectCharterClassification(@PathVariable("userId") String userId,@PathVariable("projectCharterGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateProjectCharterClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ProjectCharter  projectCharterClassifications = ProjectCharterMapper.mapOmrsEntityDetailToProjectCharter(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  projectCharterClassifications;
    }

    /**
     * Deletes a given classification from an existing projectCharter represented by a guid.
     * @param entityGuid  globally unique identifier for the projectCharter
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/projectCharters/{projectCharterGuid}/classification/{name}")
    public ProjectCharter deleteProjectCharterClassification(@PathVariable("userId") String userId,@PathVariable("projectCharterGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteProjectCharterClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ProjectCharter declassifiedProjectCharter =  ProjectCharterMapper.mapOmrsEntityDetailToProjectCharter(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedProjectCharter;
    }

    /**
      * Get the relationships associated with entity projectCharter represented by a guid.
      * @param entityGuid  globally unique identifier for the projectCharter
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/projectCharters/guid/{entityGuid}/relationships")
    public List<Line> getProjectCharterRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getProjectCharterRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an softwareServerCapability given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the softwareServerCapabilities relationships.
     * @param entityGuid GUID for the entity
     * @return SoftwareServerCapability
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/softwareServerCapabilities/guid/{entityGuid}")
    public SoftwareServerCapability getSoftwareServerCapabilityById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getSoftwareServerCapabilityById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        SoftwareServerCapability gotsoftwareServerCapability = SoftwareServerCapabilityMapper.mapOmrsEntityDetailToSoftwareServerCapability(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotsoftwareServerCapability );
        }
        return gotsoftwareServerCapability;

    }
    /**
     * Create new softwareServerCapability in Atlas.
     * @param softwareServerCapability
     * @return SoftwareServerCapability
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/softwareServerCapabilities")
    public SoftwareServerCapability createSoftwareServerCapability(@PathVariable String userId,SoftwareServerCapability softwareServerCapability)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createSoftwareServerCapabilityById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("SoftwareServerCapability");
        if (constraint!=null) {
             constraint.preCreate(softwareServerCapability);
        }

        EntityDetail entityDetail = SoftwareServerCapabilityMapper.mapSoftwareServerCapabilityToOmrsEntityDetail(softwareServerCapability);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        SoftwareServerCapability createdSoftwareServerCapability =  SoftwareServerCapabilityMapper.mapOmrsEntityDetailToSoftwareServerCapability(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created SoftwareServerCapability="+ createdSoftwareServerCapability );
        }
        return createdSoftwareServerCapability;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/softwareServerCapabilities/guid/{softwareServerCapabilityGuid}")
    public SoftwareServerCapability updateSoftwareServerCapability(@PathVariable String userId,@PathVariable String entityGuid, SoftwareServerCapability softwareServerCapability)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateSoftwareServerCapabilityById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = SoftwareServerCapabilityMapper.mapSoftwareServerCapabilityToOmrsEntityDetail(softwareServerCapability);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            SoftwareServerCapability updatedSoftwareServerCapability =  SoftwareServerCapabilityMapper.mapOmrsEntityDetailToSoftwareServerCapability(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated SoftwareServerCapability="+ updatedSoftwareServerCapability );
            }
            return updatedSoftwareServerCapability;
        }

    /**
     * Delete an softwareServerCapability identified by its GUID. Delete is a soft delete, this means that the softwareServerCapability has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the softwareServerCapability
     * @return SoftwareServerCapability
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/softwareServerCapabilities/guid/{softwareServerCapabilityGuid}")

    public void deleteSoftwareServerCapabilityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteSoftwareServerCapabilityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeSoftwareServerCapabilityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeSoftwareServerCapabilityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied softwareServerCapability
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/softwareServerCapabilities/{softwareServerCapabilityGuid}/classifications")
    public SoftwareServerCapability addSoftwareServerCapabilityClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addSoftwareServerCapabilityClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         SoftwareServerCapability softwareServerCapabilityClassifications = SoftwareServerCapabilityMapper.mapOmrsEntityDetailToSoftwareServerCapability(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified SoftwareServerCapability=" +  softwareServerCapabilityClassifications);
         }
         return  softwareServerCapabilityClassifications;
    }

    /**
     * Updates classifications to an existing softwareServerCapability represented by a guid.
     * @param  entityGuid globally unique identifier for the softwareServerCapability
     * @return classification for the given softwareServerCapability guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/softwareServerCapabilities/{softwareServerCapabilityGuid}/classification")

    public SoftwareServerCapability updateSoftwareServerCapabilityClassification(@PathVariable("userId") String userId,@PathVariable("softwareServerCapabilityGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateSoftwareServerCapabilityClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           SoftwareServerCapability  softwareServerCapabilityClassifications = SoftwareServerCapabilityMapper.mapOmrsEntityDetailToSoftwareServerCapability(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  softwareServerCapabilityClassifications;
    }

    /**
     * Deletes a given classification from an existing softwareServerCapability represented by a guid.
     * @param entityGuid  globally unique identifier for the softwareServerCapability
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/softwareServerCapabilities/{softwareServerCapabilityGuid}/classification/{name}")
    public SoftwareServerCapability deleteSoftwareServerCapabilityClassification(@PathVariable("userId") String userId,@PathVariable("softwareServerCapabilityGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteSoftwareServerCapabilityClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       SoftwareServerCapability declassifiedSoftwareServerCapability =  SoftwareServerCapabilityMapper.mapOmrsEntityDetailToSoftwareServerCapability(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedSoftwareServerCapability;
    }

    /**
      * Get the relationships associated with entity softwareServerCapability represented by a guid.
      * @param entityGuid  globally unique identifier for the softwareServerCapability
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/softwareServerCapabilities/guid/{entityGuid}/relationships")
    public List<Line> getSoftwareServerCapabilityRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getSoftwareServerCapabilityRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an licenseType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the licenseTypes relationships.
     * @param entityGuid GUID for the entity
     * @return LicenseType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/licenseTypes/guid/{entityGuid}")
    public LicenseType getLicenseTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getLicenseTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        LicenseType gotlicenseType = LicenseTypeMapper.mapOmrsEntityDetailToLicenseType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotlicenseType );
        }
        return gotlicenseType;

    }
    /**
     * Create new licenseType in Atlas.
     * @param licenseType
     * @return LicenseType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/licenseTypes")
    public LicenseType createLicenseType(@PathVariable String userId,LicenseType licenseType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createLicenseTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("LicenseType");
        if (constraint!=null) {
             constraint.preCreate(licenseType);
        }

        EntityDetail entityDetail = LicenseTypeMapper.mapLicenseTypeToOmrsEntityDetail(licenseType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        LicenseType createdLicenseType =  LicenseTypeMapper.mapOmrsEntityDetailToLicenseType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created LicenseType="+ createdLicenseType );
        }
        return createdLicenseType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/licenseTypes/guid/{licenseTypeGuid}")
    public LicenseType updateLicenseType(@PathVariable String userId,@PathVariable String entityGuid, LicenseType licenseType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateLicenseTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = LicenseTypeMapper.mapLicenseTypeToOmrsEntityDetail(licenseType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            LicenseType updatedLicenseType =  LicenseTypeMapper.mapOmrsEntityDetailToLicenseType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated LicenseType="+ updatedLicenseType );
            }
            return updatedLicenseType;
        }

    /**
     * Delete an licenseType identified by its GUID. Delete is a soft delete, this means that the licenseType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the licenseType
     * @return LicenseType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/licenseTypes/guid/{licenseTypeGuid}")

    public void deleteLicenseTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteLicenseTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeLicenseTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeLicenseTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied licenseType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/licenseTypes/{licenseTypeGuid}/classifications")
    public LicenseType addLicenseTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addLicenseTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         LicenseType licenseTypeClassifications = LicenseTypeMapper.mapOmrsEntityDetailToLicenseType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified LicenseType=" +  licenseTypeClassifications);
         }
         return  licenseTypeClassifications;
    }

    /**
     * Updates classifications to an existing licenseType represented by a guid.
     * @param  entityGuid globally unique identifier for the licenseType
     * @return classification for the given licenseType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/licenseTypes/{licenseTypeGuid}/classification")

    public LicenseType updateLicenseTypeClassification(@PathVariable("userId") String userId,@PathVariable("licenseTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateLicenseTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           LicenseType  licenseTypeClassifications = LicenseTypeMapper.mapOmrsEntityDetailToLicenseType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  licenseTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing licenseType represented by a guid.
     * @param entityGuid  globally unique identifier for the licenseType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/licenseTypes/{licenseTypeGuid}/classification/{name}")
    public LicenseType deleteLicenseTypeClassification(@PathVariable("userId") String userId,@PathVariable("licenseTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteLicenseTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       LicenseType declassifiedLicenseType =  LicenseTypeMapper.mapOmrsEntityDetailToLicenseType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedLicenseType;
    }

    /**
      * Get the relationships associated with entity licenseType represented by a guid.
      * @param entityGuid  globally unique identifier for the licenseType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/licenseTypes/guid/{entityGuid}/relationships")
    public List<Line> getLicenseTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getLicenseTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an graphVertex given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the graphVertexs relationships.
     * @param entityGuid GUID for the entity
     * @return GraphVertex
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/graphVertexs/guid/{entityGuid}")
    public GraphVertex getGraphVertexById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGraphVertexById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GraphVertex gotgraphVertex = GraphVertexMapper.mapOmrsEntityDetailToGraphVertex(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgraphVertex );
        }
        return gotgraphVertex;

    }
    /**
     * Create new graphVertex in Atlas.
     * @param graphVertex
     * @return GraphVertex
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/graphVertexs")
    public GraphVertex createGraphVertex(@PathVariable String userId,GraphVertex graphVertex)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGraphVertexById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GraphVertex");
        if (constraint!=null) {
             constraint.preCreate(graphVertex);
        }

        EntityDetail entityDetail = GraphVertexMapper.mapGraphVertexToOmrsEntityDetail(graphVertex);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GraphVertex createdGraphVertex =  GraphVertexMapper.mapOmrsEntityDetailToGraphVertex(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GraphVertex="+ createdGraphVertex );
        }
        return createdGraphVertex;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/graphVertexs/guid/{graphVertexGuid}")
    public GraphVertex updateGraphVertex(@PathVariable String userId,@PathVariable String entityGuid, GraphVertex graphVertex)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGraphVertexById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GraphVertexMapper.mapGraphVertexToOmrsEntityDetail(graphVertex);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GraphVertex updatedGraphVertex =  GraphVertexMapper.mapOmrsEntityDetailToGraphVertex(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GraphVertex="+ updatedGraphVertex );
            }
            return updatedGraphVertex;
        }

    /**
     * Delete an graphVertex identified by its GUID. Delete is a soft delete, this means that the graphVertex has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the graphVertex
     * @return GraphVertex
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/graphVertexs/guid/{graphVertexGuid}")

    public void deleteGraphVertexByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGraphVertexByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGraphVertexByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGraphVertexByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied graphVertex
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/graphVertexs/{graphVertexGuid}/classifications")
    public GraphVertex addGraphVertexClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGraphVertexClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GraphVertex graphVertexClassifications = GraphVertexMapper.mapOmrsEntityDetailToGraphVertex(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GraphVertex=" +  graphVertexClassifications);
         }
         return  graphVertexClassifications;
    }

    /**
     * Updates classifications to an existing graphVertex represented by a guid.
     * @param  entityGuid globally unique identifier for the graphVertex
     * @return classification for the given graphVertex guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/graphVertexs/{graphVertexGuid}/classification")

    public GraphVertex updateGraphVertexClassification(@PathVariable("userId") String userId,@PathVariable("graphVertexGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGraphVertexClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GraphVertex  graphVertexClassifications = GraphVertexMapper.mapOmrsEntityDetailToGraphVertex(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  graphVertexClassifications;
    }

    /**
     * Deletes a given classification from an existing graphVertex represented by a guid.
     * @param entityGuid  globally unique identifier for the graphVertex
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/graphVertexs/{graphVertexGuid}/classification/{name}")
    public GraphVertex deleteGraphVertexClassification(@PathVariable("userId") String userId,@PathVariable("graphVertexGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGraphVertexClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GraphVertex declassifiedGraphVertex =  GraphVertexMapper.mapOmrsEntityDetailToGraphVertex(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGraphVertex;
    }

    /**
      * Get the relationships associated with entity graphVertex represented by a guid.
      * @param entityGuid  globally unique identifier for the graphVertex
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/graphVertexs/guid/{entityGuid}/relationships")
    public List<Line> getGraphVertexRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGraphVertexRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an glossaryTerm given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the glossaryTerms relationships.
     * @param entityGuid GUID for the entity
     * @return GlossaryTerm
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/glossaryTerms/guid/{entityGuid}")
    public GlossaryTerm getGlossaryTermById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGlossaryTermById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GlossaryTerm gotglossaryTerm = GlossaryTermMapper.mapOmrsEntityDetailToGlossaryTerm(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotglossaryTerm );
        }
        return gotglossaryTerm;

    }
    /**
     * Create new glossaryTerm in Atlas.
     * @param glossaryTerm
     * @return GlossaryTerm
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/glossaryTerms")
    public GlossaryTerm createGlossaryTerm(@PathVariable String userId,GlossaryTerm glossaryTerm)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGlossaryTermById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GlossaryTerm");
        if (constraint!=null) {
             constraint.preCreate(glossaryTerm);
        }

        EntityDetail entityDetail = GlossaryTermMapper.mapGlossaryTermToOmrsEntityDetail(glossaryTerm);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GlossaryTerm createdGlossaryTerm =  GlossaryTermMapper.mapOmrsEntityDetailToGlossaryTerm(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GlossaryTerm="+ createdGlossaryTerm );
        }
        return createdGlossaryTerm;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/glossaryTerms/guid/{glossaryTermGuid}")
    public GlossaryTerm updateGlossaryTerm(@PathVariable String userId,@PathVariable String entityGuid, GlossaryTerm glossaryTerm)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGlossaryTermById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GlossaryTermMapper.mapGlossaryTermToOmrsEntityDetail(glossaryTerm);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GlossaryTerm updatedGlossaryTerm =  GlossaryTermMapper.mapOmrsEntityDetailToGlossaryTerm(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GlossaryTerm="+ updatedGlossaryTerm );
            }
            return updatedGlossaryTerm;
        }

    /**
     * Delete an glossaryTerm identified by its GUID. Delete is a soft delete, this means that the glossaryTerm has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the glossaryTerm
     * @return GlossaryTerm
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/glossaryTerms/guid/{glossaryTermGuid}")

    public void deleteGlossaryTermByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGlossaryTermByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGlossaryTermByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGlossaryTermByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied glossaryTerm
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/glossaryTerms/{glossaryTermGuid}/classifications")
    public GlossaryTerm addGlossaryTermClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGlossaryTermClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GlossaryTerm glossaryTermClassifications = GlossaryTermMapper.mapOmrsEntityDetailToGlossaryTerm(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GlossaryTerm=" +  glossaryTermClassifications);
         }
         return  glossaryTermClassifications;
    }

    /**
     * Updates classifications to an existing glossaryTerm represented by a guid.
     * @param  entityGuid globally unique identifier for the glossaryTerm
     * @return classification for the given glossaryTerm guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/glossaryTerms/{glossaryTermGuid}/classification")

    public GlossaryTerm updateGlossaryTermClassification(@PathVariable("userId") String userId,@PathVariable("glossaryTermGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGlossaryTermClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GlossaryTerm  glossaryTermClassifications = GlossaryTermMapper.mapOmrsEntityDetailToGlossaryTerm(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  glossaryTermClassifications;
    }

    /**
     * Deletes a given classification from an existing glossaryTerm represented by a guid.
     * @param entityGuid  globally unique identifier for the glossaryTerm
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/glossaryTerms/{glossaryTermGuid}/classification/{name}")
    public GlossaryTerm deleteGlossaryTermClassification(@PathVariable("userId") String userId,@PathVariable("glossaryTermGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGlossaryTermClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GlossaryTerm declassifiedGlossaryTerm =  GlossaryTermMapper.mapOmrsEntityDetailToGlossaryTerm(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGlossaryTerm;
    }

    /**
      * Get the relationships associated with entity glossaryTerm represented by a guid.
      * @param entityGuid  globally unique identifier for the glossaryTerm
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/glossaryTerms/guid/{entityGuid}/relationships")
    public List<Line> getGlossaryTermRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGlossaryTermRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an team given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the teams relationships.
     * @param entityGuid GUID for the entity
     * @return Team
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/teams/guid/{entityGuid}")
    public Team getTeamById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getTeamById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Team gotteam = TeamMapper.mapOmrsEntityDetailToTeam(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotteam );
        }
        return gotteam;

    }
    /**
     * Create new team in Atlas.
     * @param team
     * @return Team
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/teams")
    public Team createTeam(@PathVariable String userId,Team team)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createTeamById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Team");
        if (constraint!=null) {
             constraint.preCreate(team);
        }

        EntityDetail entityDetail = TeamMapper.mapTeamToOmrsEntityDetail(team);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Team createdTeam =  TeamMapper.mapOmrsEntityDetailToTeam(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Team="+ createdTeam );
        }
        return createdTeam;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/teams/guid/{teamGuid}")
    public Team updateTeam(@PathVariable String userId,@PathVariable String entityGuid, Team team)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateTeamById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = TeamMapper.mapTeamToOmrsEntityDetail(team);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Team updatedTeam =  TeamMapper.mapOmrsEntityDetailToTeam(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Team="+ updatedTeam );
            }
            return updatedTeam;
        }

    /**
     * Delete an team identified by its GUID. Delete is a soft delete, this means that the team has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the team
     * @return Team
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/teams/guid/{teamGuid}")

    public void deleteTeamByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteTeamByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeTeamByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeTeamByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied team
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/teams/{teamGuid}/classifications")
    public Team addTeamClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addTeamClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Team teamClassifications = TeamMapper.mapOmrsEntityDetailToTeam(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Team=" +  teamClassifications);
         }
         return  teamClassifications;
    }

    /**
     * Updates classifications to an existing team represented by a guid.
     * @param  entityGuid globally unique identifier for the team
     * @return classification for the given team guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/teams/{teamGuid}/classification")

    public Team updateTeamClassification(@PathVariable("userId") String userId,@PathVariable("teamGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateTeamClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Team  teamClassifications = TeamMapper.mapOmrsEntityDetailToTeam(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  teamClassifications;
    }

    /**
     * Deletes a given classification from an existing team represented by a guid.
     * @param entityGuid  globally unique identifier for the team
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/teams/{teamGuid}/classification/{name}")
    public Team deleteTeamClassification(@PathVariable("userId") String userId,@PathVariable("teamGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteTeamClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Team declassifiedTeam =  TeamMapper.mapOmrsEntityDetailToTeam(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedTeam;
    }

    /**
      * Get the relationships associated with entity team represented by a guid.
      * @param entityGuid  globally unique identifier for the team
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/teams/guid/{entityGuid}/relationships")
    public List<Line> getTeamRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getTeamRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an metadataCollection given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the metadataCollections relationships.
     * @param entityGuid GUID for the entity
     * @return MetadataCollection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/metadataCollections/guid/{entityGuid}")
    public MetadataCollection getMetadataCollectionById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getMetadataCollectionById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        MetadataCollection gotmetadataCollection = MetadataCollectionMapper.mapOmrsEntityDetailToMetadataCollection(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotmetadataCollection );
        }
        return gotmetadataCollection;

    }
    /**
     * Create new metadataCollection in Atlas.
     * @param metadataCollection
     * @return MetadataCollection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/metadataCollections")
    public MetadataCollection createMetadataCollection(@PathVariable String userId,MetadataCollection metadataCollection)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createMetadataCollectionById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("MetadataCollection");
        if (constraint!=null) {
             constraint.preCreate(metadataCollection);
        }

        EntityDetail entityDetail = MetadataCollectionMapper.mapMetadataCollectionToOmrsEntityDetail(metadataCollection);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        MetadataCollection createdMetadataCollection =  MetadataCollectionMapper.mapOmrsEntityDetailToMetadataCollection(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created MetadataCollection="+ createdMetadataCollection );
        }
        return createdMetadataCollection;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/metadataCollections/guid/{metadataCollectionGuid}")
    public MetadataCollection updateMetadataCollection(@PathVariable String userId,@PathVariable String entityGuid, MetadataCollection metadataCollection)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateMetadataCollectionById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = MetadataCollectionMapper.mapMetadataCollectionToOmrsEntityDetail(metadataCollection);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            MetadataCollection updatedMetadataCollection =  MetadataCollectionMapper.mapOmrsEntityDetailToMetadataCollection(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated MetadataCollection="+ updatedMetadataCollection );
            }
            return updatedMetadataCollection;
        }

    /**
     * Delete an metadataCollection identified by its GUID. Delete is a soft delete, this means that the metadataCollection has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the metadataCollection
     * @return MetadataCollection
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/metadataCollections/guid/{metadataCollectionGuid}")

    public void deleteMetadataCollectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteMetadataCollectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeMetadataCollectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeMetadataCollectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied metadataCollection
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/metadataCollections/{metadataCollectionGuid}/classifications")
    public MetadataCollection addMetadataCollectionClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addMetadataCollectionClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         MetadataCollection metadataCollectionClassifications = MetadataCollectionMapper.mapOmrsEntityDetailToMetadataCollection(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified MetadataCollection=" +  metadataCollectionClassifications);
         }
         return  metadataCollectionClassifications;
    }

    /**
     * Updates classifications to an existing metadataCollection represented by a guid.
     * @param  entityGuid globally unique identifier for the metadataCollection
     * @return classification for the given metadataCollection guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/metadataCollections/{metadataCollectionGuid}/classification")

    public MetadataCollection updateMetadataCollectionClassification(@PathVariable("userId") String userId,@PathVariable("metadataCollectionGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateMetadataCollectionClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           MetadataCollection  metadataCollectionClassifications = MetadataCollectionMapper.mapOmrsEntityDetailToMetadataCollection(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  metadataCollectionClassifications;
    }

    /**
     * Deletes a given classification from an existing metadataCollection represented by a guid.
     * @param entityGuid  globally unique identifier for the metadataCollection
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/metadataCollections/{metadataCollectionGuid}/classification/{name}")
    public MetadataCollection deleteMetadataCollectionClassification(@PathVariable("userId") String userId,@PathVariable("metadataCollectionGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteMetadataCollectionClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       MetadataCollection declassifiedMetadataCollection =  MetadataCollectionMapper.mapOmrsEntityDetailToMetadataCollection(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedMetadataCollection;
    }

    /**
      * Get the relationships associated with entity metadataCollection represented by a guid.
      * @param entityGuid  globally unique identifier for the metadataCollection
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/metadataCollections/guid/{entityGuid}/relationships")
    public List<Line> getMetadataCollectionRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getMetadataCollectionRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceControl given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceControls relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceControl
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceControls/guid/{entityGuid}")
    public GovernanceControl getGovernanceControlById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceControlById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceControl gotgovernanceControl = GovernanceControlMapper.mapOmrsEntityDetailToGovernanceControl(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceControl );
        }
        return gotgovernanceControl;

    }
    /**
     * Create new governanceControl in Atlas.
     * @param governanceControl
     * @return GovernanceControl
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceControls")
    public GovernanceControl createGovernanceControl(@PathVariable String userId,GovernanceControl governanceControl)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceControlById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceControl");
        if (constraint!=null) {
             constraint.preCreate(governanceControl);
        }

        EntityDetail entityDetail = GovernanceControlMapper.mapGovernanceControlToOmrsEntityDetail(governanceControl);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceControl createdGovernanceControl =  GovernanceControlMapper.mapOmrsEntityDetailToGovernanceControl(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceControl="+ createdGovernanceControl );
        }
        return createdGovernanceControl;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceControls/guid/{governanceControlGuid}")
    public GovernanceControl updateGovernanceControl(@PathVariable String userId,@PathVariable String entityGuid, GovernanceControl governanceControl)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceControlById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceControlMapper.mapGovernanceControlToOmrsEntityDetail(governanceControl);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceControl updatedGovernanceControl =  GovernanceControlMapper.mapOmrsEntityDetailToGovernanceControl(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceControl="+ updatedGovernanceControl );
            }
            return updatedGovernanceControl;
        }

    /**
     * Delete an governanceControl identified by its GUID. Delete is a soft delete, this means that the governanceControl has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceControl
     * @return GovernanceControl
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceControls/guid/{governanceControlGuid}")

    public void deleteGovernanceControlByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceControlByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceControlByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceControlByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceControl
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceControls/{governanceControlGuid}/classifications")
    public GovernanceControl addGovernanceControlClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceControlClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceControl governanceControlClassifications = GovernanceControlMapper.mapOmrsEntityDetailToGovernanceControl(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceControl=" +  governanceControlClassifications);
         }
         return  governanceControlClassifications;
    }

    /**
     * Updates classifications to an existing governanceControl represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceControl
     * @return classification for the given governanceControl guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceControls/{governanceControlGuid}/classification")

    public GovernanceControl updateGovernanceControlClassification(@PathVariable("userId") String userId,@PathVariable("governanceControlGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceControlClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceControl  governanceControlClassifications = GovernanceControlMapper.mapOmrsEntityDetailToGovernanceControl(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceControlClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceControl represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceControl
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceControls/{governanceControlGuid}/classification/{name}")
    public GovernanceControl deleteGovernanceControlClassification(@PathVariable("userId") String userId,@PathVariable("governanceControlGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceControlClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceControl declassifiedGovernanceControl =  GovernanceControlMapper.mapOmrsEntityDetailToGovernanceControl(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceControl;
    }

    /**
      * Get the relationships associated with entity governanceControl represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceControl
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceControls/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceControlRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceControlRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an topic given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the topics relationships.
     * @param entityGuid GUID for the entity
     * @return Topic
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/topics/guid/{entityGuid}")
    public Topic getTopicById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getTopicById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Topic gottopic = TopicMapper.mapOmrsEntityDetailToTopic(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gottopic );
        }
        return gottopic;

    }
    /**
     * Create new topic in Atlas.
     * @param topic
     * @return Topic
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/topics")
    public Topic createTopic(@PathVariable String userId,Topic topic)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createTopicById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Topic");
        if (constraint!=null) {
             constraint.preCreate(topic);
        }

        EntityDetail entityDetail = TopicMapper.mapTopicToOmrsEntityDetail(topic);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Topic createdTopic =  TopicMapper.mapOmrsEntityDetailToTopic(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Topic="+ createdTopic );
        }
        return createdTopic;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/topics/guid/{topicGuid}")
    public Topic updateTopic(@PathVariable String userId,@PathVariable String entityGuid, Topic topic)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateTopicById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = TopicMapper.mapTopicToOmrsEntityDetail(topic);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Topic updatedTopic =  TopicMapper.mapOmrsEntityDetailToTopic(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Topic="+ updatedTopic );
            }
            return updatedTopic;
        }

    /**
     * Delete an topic identified by its GUID. Delete is a soft delete, this means that the topic has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the topic
     * @return Topic
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/topics/guid/{topicGuid}")

    public void deleteTopicByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteTopicByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeTopicByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeTopicByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied topic
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/topics/{topicGuid}/classifications")
    public Topic addTopicClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addTopicClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Topic topicClassifications = TopicMapper.mapOmrsEntityDetailToTopic(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Topic=" +  topicClassifications);
         }
         return  topicClassifications;
    }

    /**
     * Updates classifications to an existing topic represented by a guid.
     * @param  entityGuid globally unique identifier for the topic
     * @return classification for the given topic guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/topics/{topicGuid}/classification")

    public Topic updateTopicClassification(@PathVariable("userId") String userId,@PathVariable("topicGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateTopicClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Topic  topicClassifications = TopicMapper.mapOmrsEntityDetailToTopic(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  topicClassifications;
    }

    /**
     * Deletes a given classification from an existing topic represented by a guid.
     * @param entityGuid  globally unique identifier for the topic
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/topics/{topicGuid}/classification/{name}")
    public Topic deleteTopicClassification(@PathVariable("userId") String userId,@PathVariable("topicGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteTopicClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Topic declassifiedTopic =  TopicMapper.mapOmrsEntityDetailToTopic(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedTopic;
    }

    /**
      * Get the relationships associated with entity topic represented by a guid.
      * @param entityGuid  globally unique identifier for the topic
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/topics/guid/{entityGuid}/relationships")
    public List<Line> getTopicRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getTopicRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an softwareServer given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the softwareServers relationships.
     * @param entityGuid GUID for the entity
     * @return SoftwareServer
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/softwareServers/guid/{entityGuid}")
    public SoftwareServer getSoftwareServerById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getSoftwareServerById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        SoftwareServer gotsoftwareServer = SoftwareServerMapper.mapOmrsEntityDetailToSoftwareServer(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotsoftwareServer );
        }
        return gotsoftwareServer;

    }
    /**
     * Create new softwareServer in Atlas.
     * @param softwareServer
     * @return SoftwareServer
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/softwareServers")
    public SoftwareServer createSoftwareServer(@PathVariable String userId,SoftwareServer softwareServer)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createSoftwareServerById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("SoftwareServer");
        if (constraint!=null) {
             constraint.preCreate(softwareServer);
        }

        EntityDetail entityDetail = SoftwareServerMapper.mapSoftwareServerToOmrsEntityDetail(softwareServer);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        SoftwareServer createdSoftwareServer =  SoftwareServerMapper.mapOmrsEntityDetailToSoftwareServer(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created SoftwareServer="+ createdSoftwareServer );
        }
        return createdSoftwareServer;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/softwareServers/guid/{softwareServerGuid}")
    public SoftwareServer updateSoftwareServer(@PathVariable String userId,@PathVariable String entityGuid, SoftwareServer softwareServer)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateSoftwareServerById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = SoftwareServerMapper.mapSoftwareServerToOmrsEntityDetail(softwareServer);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            SoftwareServer updatedSoftwareServer =  SoftwareServerMapper.mapOmrsEntityDetailToSoftwareServer(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated SoftwareServer="+ updatedSoftwareServer );
            }
            return updatedSoftwareServer;
        }

    /**
     * Delete an softwareServer identified by its GUID. Delete is a soft delete, this means that the softwareServer has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the softwareServer
     * @return SoftwareServer
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/softwareServers/guid/{softwareServerGuid}")

    public void deleteSoftwareServerByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteSoftwareServerByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeSoftwareServerByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeSoftwareServerByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied softwareServer
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/softwareServers/{softwareServerGuid}/classifications")
    public SoftwareServer addSoftwareServerClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addSoftwareServerClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         SoftwareServer softwareServerClassifications = SoftwareServerMapper.mapOmrsEntityDetailToSoftwareServer(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified SoftwareServer=" +  softwareServerClassifications);
         }
         return  softwareServerClassifications;
    }

    /**
     * Updates classifications to an existing softwareServer represented by a guid.
     * @param  entityGuid globally unique identifier for the softwareServer
     * @return classification for the given softwareServer guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/softwareServers/{softwareServerGuid}/classification")

    public SoftwareServer updateSoftwareServerClassification(@PathVariable("userId") String userId,@PathVariable("softwareServerGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateSoftwareServerClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           SoftwareServer  softwareServerClassifications = SoftwareServerMapper.mapOmrsEntityDetailToSoftwareServer(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  softwareServerClassifications;
    }

    /**
     * Deletes a given classification from an existing softwareServer represented by a guid.
     * @param entityGuid  globally unique identifier for the softwareServer
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/softwareServers/{softwareServerGuid}/classification/{name}")
    public SoftwareServer deleteSoftwareServerClassification(@PathVariable("userId") String userId,@PathVariable("softwareServerGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteSoftwareServerClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       SoftwareServer declassifiedSoftwareServer =  SoftwareServerMapper.mapOmrsEntityDetailToSoftwareServer(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedSoftwareServer;
    }

    /**
      * Get the relationships associated with entity softwareServer represented by a guid.
      * @param entityGuid  globally unique identifier for the softwareServer
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/softwareServers/guid/{entityGuid}/relationships")
    public List<Line> getSoftwareServerRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getSoftwareServerRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an deployedAPI given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the deployedAPIs relationships.
     * @param entityGuid GUID for the entity
     * @return DeployedAPI
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/deployedAPIs/guid/{entityGuid}")
    public DeployedAPI getDeployedAPIById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getDeployedAPIById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        DeployedAPI gotdeployedAPI = DeployedAPIMapper.mapOmrsEntityDetailToDeployedAPI(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotdeployedAPI );
        }
        return gotdeployedAPI;

    }
    /**
     * Create new deployedAPI in Atlas.
     * @param deployedAPI
     * @return DeployedAPI
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/deployedAPIs")
    public DeployedAPI createDeployedAPI(@PathVariable String userId,DeployedAPI deployedAPI)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createDeployedAPIById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("DeployedAPI");
        if (constraint!=null) {
             constraint.preCreate(deployedAPI);
        }

        EntityDetail entityDetail = DeployedAPIMapper.mapDeployedAPIToOmrsEntityDetail(deployedAPI);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        DeployedAPI createdDeployedAPI =  DeployedAPIMapper.mapOmrsEntityDetailToDeployedAPI(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created DeployedAPI="+ createdDeployedAPI );
        }
        return createdDeployedAPI;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/deployedAPIs/guid/{deployedAPIGuid}")
    public DeployedAPI updateDeployedAPI(@PathVariable String userId,@PathVariable String entityGuid, DeployedAPI deployedAPI)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateDeployedAPIById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = DeployedAPIMapper.mapDeployedAPIToOmrsEntityDetail(deployedAPI);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            DeployedAPI updatedDeployedAPI =  DeployedAPIMapper.mapOmrsEntityDetailToDeployedAPI(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated DeployedAPI="+ updatedDeployedAPI );
            }
            return updatedDeployedAPI;
        }

    /**
     * Delete an deployedAPI identified by its GUID. Delete is a soft delete, this means that the deployedAPI has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the deployedAPI
     * @return DeployedAPI
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/deployedAPIs/guid/{deployedAPIGuid}")

    public void deleteDeployedAPIByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteDeployedAPIByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeDeployedAPIByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeDeployedAPIByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied deployedAPI
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/deployedAPIs/{deployedAPIGuid}/classifications")
    public DeployedAPI addDeployedAPIClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addDeployedAPIClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         DeployedAPI deployedAPIClassifications = DeployedAPIMapper.mapOmrsEntityDetailToDeployedAPI(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified DeployedAPI=" +  deployedAPIClassifications);
         }
         return  deployedAPIClassifications;
    }

    /**
     * Updates classifications to an existing deployedAPI represented by a guid.
     * @param  entityGuid globally unique identifier for the deployedAPI
     * @return classification for the given deployedAPI guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/deployedAPIs/{deployedAPIGuid}/classification")

    public DeployedAPI updateDeployedAPIClassification(@PathVariable("userId") String userId,@PathVariable("deployedAPIGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateDeployedAPIClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           DeployedAPI  deployedAPIClassifications = DeployedAPIMapper.mapOmrsEntityDetailToDeployedAPI(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  deployedAPIClassifications;
    }

    /**
     * Deletes a given classification from an existing deployedAPI represented by a guid.
     * @param entityGuid  globally unique identifier for the deployedAPI
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/deployedAPIs/{deployedAPIGuid}/classification/{name}")
    public DeployedAPI deleteDeployedAPIClassification(@PathVariable("userId") String userId,@PathVariable("deployedAPIGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteDeployedAPIClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       DeployedAPI declassifiedDeployedAPI =  DeployedAPIMapper.mapOmrsEntityDetailToDeployedAPI(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedDeployedAPI;
    }

    /**
      * Get the relationships associated with entity deployedAPI represented by a guid.
      * @param entityGuid  globally unique identifier for the deployedAPI
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/deployedAPIs/guid/{entityGuid}/relationships")
    public List<Line> getDeployedAPIRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getDeployedAPIRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an mediaFile given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the mediaFiles relationships.
     * @param entityGuid GUID for the entity
     * @return MediaFile
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/mediaFiles/guid/{entityGuid}")
    public MediaFile getMediaFileById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getMediaFileById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        MediaFile gotmediaFile = MediaFileMapper.mapOmrsEntityDetailToMediaFile(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotmediaFile );
        }
        return gotmediaFile;

    }
    /**
     * Create new mediaFile in Atlas.
     * @param mediaFile
     * @return MediaFile
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/mediaFiles")
    public MediaFile createMediaFile(@PathVariable String userId,MediaFile mediaFile)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createMediaFileById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("MediaFile");
        if (constraint!=null) {
             constraint.preCreate(mediaFile);
        }

        EntityDetail entityDetail = MediaFileMapper.mapMediaFileToOmrsEntityDetail(mediaFile);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        MediaFile createdMediaFile =  MediaFileMapper.mapOmrsEntityDetailToMediaFile(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created MediaFile="+ createdMediaFile );
        }
        return createdMediaFile;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/mediaFiles/guid/{mediaFileGuid}")
    public MediaFile updateMediaFile(@PathVariable String userId,@PathVariable String entityGuid, MediaFile mediaFile)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateMediaFileById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = MediaFileMapper.mapMediaFileToOmrsEntityDetail(mediaFile);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            MediaFile updatedMediaFile =  MediaFileMapper.mapOmrsEntityDetailToMediaFile(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated MediaFile="+ updatedMediaFile );
            }
            return updatedMediaFile;
        }

    /**
     * Delete an mediaFile identified by its GUID. Delete is a soft delete, this means that the mediaFile has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the mediaFile
     * @return MediaFile
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/mediaFiles/guid/{mediaFileGuid}")

    public void deleteMediaFileByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteMediaFileByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeMediaFileByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeMediaFileByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied mediaFile
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/mediaFiles/{mediaFileGuid}/classifications")
    public MediaFile addMediaFileClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addMediaFileClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         MediaFile mediaFileClassifications = MediaFileMapper.mapOmrsEntityDetailToMediaFile(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified MediaFile=" +  mediaFileClassifications);
         }
         return  mediaFileClassifications;
    }

    /**
     * Updates classifications to an existing mediaFile represented by a guid.
     * @param  entityGuid globally unique identifier for the mediaFile
     * @return classification for the given mediaFile guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/mediaFiles/{mediaFileGuid}/classification")

    public MediaFile updateMediaFileClassification(@PathVariable("userId") String userId,@PathVariable("mediaFileGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateMediaFileClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           MediaFile  mediaFileClassifications = MediaFileMapper.mapOmrsEntityDetailToMediaFile(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  mediaFileClassifications;
    }

    /**
     * Deletes a given classification from an existing mediaFile represented by a guid.
     * @param entityGuid  globally unique identifier for the mediaFile
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/mediaFiles/{mediaFileGuid}/classification/{name}")
    public MediaFile deleteMediaFileClassification(@PathVariable("userId") String userId,@PathVariable("mediaFileGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteMediaFileClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       MediaFile declassifiedMediaFile =  MediaFileMapper.mapOmrsEntityDetailToMediaFile(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedMediaFile;
    }

    /**
      * Get the relationships associated with entity mediaFile represented by a guid.
      * @param entityGuid  globally unique identifier for the mediaFile
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/mediaFiles/guid/{entityGuid}/relationships")
    public List<Line> getMediaFileRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getMediaFileRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an comment given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the comments relationships.
     * @param entityGuid GUID for the entity
     * @return Comment
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/comments/guid/{entityGuid}")
    public Comment getCommentById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getCommentById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Comment gotcomment = CommentMapper.mapOmrsEntityDetailToComment(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcomment );
        }
        return gotcomment;

    }
    /**
     * Create new comment in Atlas.
     * @param comment
     * @return Comment
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/comments")
    public Comment createComment(@PathVariable String userId,Comment comment)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createCommentById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Comment");
        if (constraint!=null) {
             constraint.preCreate(comment);
        }

        EntityDetail entityDetail = CommentMapper.mapCommentToOmrsEntityDetail(comment);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Comment createdComment =  CommentMapper.mapOmrsEntityDetailToComment(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Comment="+ createdComment );
        }
        return createdComment;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/comments/guid/{commentGuid}")
    public Comment updateComment(@PathVariable String userId,@PathVariable String entityGuid, Comment comment)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateCommentById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = CommentMapper.mapCommentToOmrsEntityDetail(comment);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Comment updatedComment =  CommentMapper.mapOmrsEntityDetailToComment(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Comment="+ updatedComment );
            }
            return updatedComment;
        }

    /**
     * Delete an comment identified by its GUID. Delete is a soft delete, this means that the comment has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the comment
     * @return Comment
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/comments/guid/{commentGuid}")

    public void deleteCommentByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteCommentByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeCommentByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeCommentByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied comment
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/comments/{commentGuid}/classifications")
    public Comment addCommentClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addCommentClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Comment commentClassifications = CommentMapper.mapOmrsEntityDetailToComment(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Comment=" +  commentClassifications);
         }
         return  commentClassifications;
    }

    /**
     * Updates classifications to an existing comment represented by a guid.
     * @param  entityGuid globally unique identifier for the comment
     * @return classification for the given comment guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/comments/{commentGuid}/classification")

    public Comment updateCommentClassification(@PathVariable("userId") String userId,@PathVariable("commentGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateCommentClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Comment  commentClassifications = CommentMapper.mapOmrsEntityDetailToComment(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  commentClassifications;
    }

    /**
     * Deletes a given classification from an existing comment represented by a guid.
     * @param entityGuid  globally unique identifier for the comment
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/comments/{commentGuid}/classification/{name}")
    public Comment deleteCommentClassification(@PathVariable("userId") String userId,@PathVariable("commentGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteCommentClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Comment declassifiedComment =  CommentMapper.mapOmrsEntityDetailToComment(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedComment;
    }

    /**
      * Get the relationships associated with entity comment represented by a guid.
      * @param entityGuid  globally unique identifier for the comment
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/comments/guid/{entityGuid}/relationships")
    public List<Line> getCommentRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getCommentRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an relatedMedia given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the relatedMedias relationships.
     * @param entityGuid GUID for the entity
     * @return RelatedMedia
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relatedMedias/guid/{entityGuid}")
    public RelatedMedia getRelatedMediaById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getRelatedMediaById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        RelatedMedia gotrelatedMedia = RelatedMediaMapper.mapOmrsEntityDetailToRelatedMedia(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotrelatedMedia );
        }
        return gotrelatedMedia;

    }
    /**
     * Create new relatedMedia in Atlas.
     * @param relatedMedia
     * @return RelatedMedia
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relatedMedias")
    public RelatedMedia createRelatedMedia(@PathVariable String userId,RelatedMedia relatedMedia)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createRelatedMediaById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("RelatedMedia");
        if (constraint!=null) {
             constraint.preCreate(relatedMedia);
        }

        EntityDetail entityDetail = RelatedMediaMapper.mapRelatedMediaToOmrsEntityDetail(relatedMedia);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        RelatedMedia createdRelatedMedia =  RelatedMediaMapper.mapOmrsEntityDetailToRelatedMedia(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created RelatedMedia="+ createdRelatedMedia );
        }
        return createdRelatedMedia;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relatedMedias/guid/{relatedMediaGuid}")
    public RelatedMedia updateRelatedMedia(@PathVariable String userId,@PathVariable String entityGuid, RelatedMedia relatedMedia)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateRelatedMediaById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = RelatedMediaMapper.mapRelatedMediaToOmrsEntityDetail(relatedMedia);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            RelatedMedia updatedRelatedMedia =  RelatedMediaMapper.mapOmrsEntityDetailToRelatedMedia(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated RelatedMedia="+ updatedRelatedMedia );
            }
            return updatedRelatedMedia;
        }

    /**
     * Delete an relatedMedia identified by its GUID. Delete is a soft delete, this means that the relatedMedia has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the relatedMedia
     * @return RelatedMedia
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/relatedMedias/guid/{relatedMediaGuid}")

    public void deleteRelatedMediaByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteRelatedMediaByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeRelatedMediaByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeRelatedMediaByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied relatedMedia
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relatedMedias/{relatedMediaGuid}/classifications")
    public RelatedMedia addRelatedMediaClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addRelatedMediaClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         RelatedMedia relatedMediaClassifications = RelatedMediaMapper.mapOmrsEntityDetailToRelatedMedia(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified RelatedMedia=" +  relatedMediaClassifications);
         }
         return  relatedMediaClassifications;
    }

    /**
     * Updates classifications to an existing relatedMedia represented by a guid.
     * @param  entityGuid globally unique identifier for the relatedMedia
     * @return classification for the given relatedMedia guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relatedMedias/{relatedMediaGuid}/classification")

    public RelatedMedia updateRelatedMediaClassification(@PathVariable("userId") String userId,@PathVariable("relatedMediaGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateRelatedMediaClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           RelatedMedia  relatedMediaClassifications = RelatedMediaMapper.mapOmrsEntityDetailToRelatedMedia(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  relatedMediaClassifications;
    }

    /**
     * Deletes a given classification from an existing relatedMedia represented by a guid.
     * @param entityGuid  globally unique identifier for the relatedMedia
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/relatedMedias/{relatedMediaGuid}/classification/{name}")
    public RelatedMedia deleteRelatedMediaClassification(@PathVariable("userId") String userId,@PathVariable("relatedMediaGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteRelatedMediaClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       RelatedMedia declassifiedRelatedMedia =  RelatedMediaMapper.mapOmrsEntityDetailToRelatedMedia(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedRelatedMedia;
    }

    /**
      * Get the relationships associated with entity relatedMedia represented by a guid.
      * @param entityGuid  globally unique identifier for the relatedMedia
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relatedMedias/guid/{entityGuid}/relationships")
    public List<Line> getRelatedMediaRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getRelatedMediaRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an connectorType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the connectorTypes relationships.
     * @param entityGuid GUID for the entity
     * @return ConnectorType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/connectorTypes/guid/{entityGuid}")
    public ConnectorType getConnectorTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getConnectorTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ConnectorType gotconnectorType = ConnectorTypeMapper.mapOmrsEntityDetailToConnectorType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotconnectorType );
        }
        return gotconnectorType;

    }
    /**
     * Create new connectorType in Atlas.
     * @param connectorType
     * @return ConnectorType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/connectorTypes")
    public ConnectorType createConnectorType(@PathVariable String userId,ConnectorType connectorType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createConnectorTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ConnectorType");
        if (constraint!=null) {
             constraint.preCreate(connectorType);
        }

        EntityDetail entityDetail = ConnectorTypeMapper.mapConnectorTypeToOmrsEntityDetail(connectorType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ConnectorType createdConnectorType =  ConnectorTypeMapper.mapOmrsEntityDetailToConnectorType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ConnectorType="+ createdConnectorType );
        }
        return createdConnectorType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/connectorTypes/guid/{connectorTypeGuid}")
    public ConnectorType updateConnectorType(@PathVariable String userId,@PathVariable String entityGuid, ConnectorType connectorType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateConnectorTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ConnectorTypeMapper.mapConnectorTypeToOmrsEntityDetail(connectorType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ConnectorType updatedConnectorType =  ConnectorTypeMapper.mapOmrsEntityDetailToConnectorType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ConnectorType="+ updatedConnectorType );
            }
            return updatedConnectorType;
        }

    /**
     * Delete an connectorType identified by its GUID. Delete is a soft delete, this means that the connectorType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the connectorType
     * @return ConnectorType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/connectorTypes/guid/{connectorTypeGuid}")

    public void deleteConnectorTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteConnectorTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeConnectorTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeConnectorTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied connectorType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/connectorTypes/{connectorTypeGuid}/classifications")
    public ConnectorType addConnectorTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addConnectorTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ConnectorType connectorTypeClassifications = ConnectorTypeMapper.mapOmrsEntityDetailToConnectorType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ConnectorType=" +  connectorTypeClassifications);
         }
         return  connectorTypeClassifications;
    }

    /**
     * Updates classifications to an existing connectorType represented by a guid.
     * @param  entityGuid globally unique identifier for the connectorType
     * @return classification for the given connectorType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/connectorTypes/{connectorTypeGuid}/classification")

    public ConnectorType updateConnectorTypeClassification(@PathVariable("userId") String userId,@PathVariable("connectorTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateConnectorTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ConnectorType  connectorTypeClassifications = ConnectorTypeMapper.mapOmrsEntityDetailToConnectorType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  connectorTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing connectorType represented by a guid.
     * @param entityGuid  globally unique identifier for the connectorType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/connectorTypes/{connectorTypeGuid}/classification/{name}")
    public ConnectorType deleteConnectorTypeClassification(@PathVariable("userId") String userId,@PathVariable("connectorTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteConnectorTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ConnectorType declassifiedConnectorType =  ConnectorTypeMapper.mapOmrsEntityDetailToConnectorType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedConnectorType;
    }

    /**
      * Get the relationships associated with entity connectorType represented by a guid.
      * @param entityGuid  globally unique identifier for the connectorType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/connectorTypes/guid/{entityGuid}/relationships")
    public List<Line> getConnectorTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getConnectorTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an cohortMember given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the cohortMembers relationships.
     * @param entityGuid GUID for the entity
     * @return CohortMember
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/cohortMembers/guid/{entityGuid}")
    public CohortMember getCohortMemberById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getCohortMemberById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        CohortMember gotcohortMember = CohortMemberMapper.mapOmrsEntityDetailToCohortMember(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcohortMember );
        }
        return gotcohortMember;

    }
    /**
     * Create new cohortMember in Atlas.
     * @param cohortMember
     * @return CohortMember
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/cohortMembers")
    public CohortMember createCohortMember(@PathVariable String userId,CohortMember cohortMember)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createCohortMemberById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("CohortMember");
        if (constraint!=null) {
             constraint.preCreate(cohortMember);
        }

        EntityDetail entityDetail = CohortMemberMapper.mapCohortMemberToOmrsEntityDetail(cohortMember);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        CohortMember createdCohortMember =  CohortMemberMapper.mapOmrsEntityDetailToCohortMember(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created CohortMember="+ createdCohortMember );
        }
        return createdCohortMember;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/cohortMembers/guid/{cohortMemberGuid}")
    public CohortMember updateCohortMember(@PathVariable String userId,@PathVariable String entityGuid, CohortMember cohortMember)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateCohortMemberById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = CohortMemberMapper.mapCohortMemberToOmrsEntityDetail(cohortMember);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            CohortMember updatedCohortMember =  CohortMemberMapper.mapOmrsEntityDetailToCohortMember(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated CohortMember="+ updatedCohortMember );
            }
            return updatedCohortMember;
        }

    /**
     * Delete an cohortMember identified by its GUID. Delete is a soft delete, this means that the cohortMember has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the cohortMember
     * @return CohortMember
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/cohortMembers/guid/{cohortMemberGuid}")

    public void deleteCohortMemberByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteCohortMemberByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeCohortMemberByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeCohortMemberByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied cohortMember
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/cohortMembers/{cohortMemberGuid}/classifications")
    public CohortMember addCohortMemberClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addCohortMemberClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         CohortMember cohortMemberClassifications = CohortMemberMapper.mapOmrsEntityDetailToCohortMember(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified CohortMember=" +  cohortMemberClassifications);
         }
         return  cohortMemberClassifications;
    }

    /**
     * Updates classifications to an existing cohortMember represented by a guid.
     * @param  entityGuid globally unique identifier for the cohortMember
     * @return classification for the given cohortMember guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/cohortMembers/{cohortMemberGuid}/classification")

    public CohortMember updateCohortMemberClassification(@PathVariable("userId") String userId,@PathVariable("cohortMemberGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateCohortMemberClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           CohortMember  cohortMemberClassifications = CohortMemberMapper.mapOmrsEntityDetailToCohortMember(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  cohortMemberClassifications;
    }

    /**
     * Deletes a given classification from an existing cohortMember represented by a guid.
     * @param entityGuid  globally unique identifier for the cohortMember
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/cohortMembers/{cohortMemberGuid}/classification/{name}")
    public CohortMember deleteCohortMemberClassification(@PathVariable("userId") String userId,@PathVariable("cohortMemberGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteCohortMemberClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       CohortMember declassifiedCohortMember =  CohortMemberMapper.mapOmrsEntityDetailToCohortMember(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedCohortMember;
    }

    /**
      * Get the relationships associated with entity cohortMember represented by a guid.
      * @param entityGuid  globally unique identifier for the cohortMember
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/cohortMembers/guid/{entityGuid}/relationships")
    public List<Line> getCohortMemberRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getCohortMemberRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an complexSchemaType given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the complexSchemaTypes relationships.
     * @param entityGuid GUID for the entity
     * @return ComplexSchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/complexSchemaTypes/guid/{entityGuid}")
    public ComplexSchemaType getComplexSchemaTypeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getComplexSchemaTypeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ComplexSchemaType gotcomplexSchemaType = ComplexSchemaTypeMapper.mapOmrsEntityDetailToComplexSchemaType(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcomplexSchemaType );
        }
        return gotcomplexSchemaType;

    }
    /**
     * Create new complexSchemaType in Atlas.
     * @param complexSchemaType
     * @return ComplexSchemaType
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/complexSchemaTypes")
    public ComplexSchemaType createComplexSchemaType(@PathVariable String userId,ComplexSchemaType complexSchemaType)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createComplexSchemaTypeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ComplexSchemaType");
        if (constraint!=null) {
             constraint.preCreate(complexSchemaType);
        }

        EntityDetail entityDetail = ComplexSchemaTypeMapper.mapComplexSchemaTypeToOmrsEntityDetail(complexSchemaType);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ComplexSchemaType createdComplexSchemaType =  ComplexSchemaTypeMapper.mapOmrsEntityDetailToComplexSchemaType(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ComplexSchemaType="+ createdComplexSchemaType );
        }
        return createdComplexSchemaType;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/complexSchemaTypes/guid/{complexSchemaTypeGuid}")
    public ComplexSchemaType updateComplexSchemaType(@PathVariable String userId,@PathVariable String entityGuid, ComplexSchemaType complexSchemaType)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateComplexSchemaTypeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ComplexSchemaTypeMapper.mapComplexSchemaTypeToOmrsEntityDetail(complexSchemaType);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ComplexSchemaType updatedComplexSchemaType =  ComplexSchemaTypeMapper.mapOmrsEntityDetailToComplexSchemaType(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ComplexSchemaType="+ updatedComplexSchemaType );
            }
            return updatedComplexSchemaType;
        }

    /**
     * Delete an complexSchemaType identified by its GUID. Delete is a soft delete, this means that the complexSchemaType has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the complexSchemaType
     * @return ComplexSchemaType
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/complexSchemaTypes/guid/{complexSchemaTypeGuid}")

    public void deleteComplexSchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteComplexSchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeComplexSchemaTypeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeComplexSchemaTypeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied complexSchemaType
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/complexSchemaTypes/{complexSchemaTypeGuid}/classifications")
    public ComplexSchemaType addComplexSchemaTypeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addComplexSchemaTypeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ComplexSchemaType complexSchemaTypeClassifications = ComplexSchemaTypeMapper.mapOmrsEntityDetailToComplexSchemaType(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ComplexSchemaType=" +  complexSchemaTypeClassifications);
         }
         return  complexSchemaTypeClassifications;
    }

    /**
     * Updates classifications to an existing complexSchemaType represented by a guid.
     * @param  entityGuid globally unique identifier for the complexSchemaType
     * @return classification for the given complexSchemaType guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/complexSchemaTypes/{complexSchemaTypeGuid}/classification")

    public ComplexSchemaType updateComplexSchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("complexSchemaTypeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateComplexSchemaTypeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ComplexSchemaType  complexSchemaTypeClassifications = ComplexSchemaTypeMapper.mapOmrsEntityDetailToComplexSchemaType(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  complexSchemaTypeClassifications;
    }

    /**
     * Deletes a given classification from an existing complexSchemaType represented by a guid.
     * @param entityGuid  globally unique identifier for the complexSchemaType
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/complexSchemaTypes/{complexSchemaTypeGuid}/classification/{name}")
    public ComplexSchemaType deleteComplexSchemaTypeClassification(@PathVariable("userId") String userId,@PathVariable("complexSchemaTypeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteComplexSchemaTypeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ComplexSchemaType declassifiedComplexSchemaType =  ComplexSchemaTypeMapper.mapOmrsEntityDetailToComplexSchemaType(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedComplexSchemaType;
    }

    /**
      * Get the relationships associated with entity complexSchemaType represented by a guid.
      * @param entityGuid  globally unique identifier for the complexSchemaType
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/complexSchemaTypes/guid/{entityGuid}/relationships")
    public List<Line> getComplexSchemaTypeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getComplexSchemaTypeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceMetric given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceMetrics relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceMetric
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceMetrics/guid/{entityGuid}")
    public GovernanceMetric getGovernanceMetricById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceMetricById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceMetric gotgovernanceMetric = GovernanceMetricMapper.mapOmrsEntityDetailToGovernanceMetric(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceMetric );
        }
        return gotgovernanceMetric;

    }
    /**
     * Create new governanceMetric in Atlas.
     * @param governanceMetric
     * @return GovernanceMetric
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceMetrics")
    public GovernanceMetric createGovernanceMetric(@PathVariable String userId,GovernanceMetric governanceMetric)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceMetricById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceMetric");
        if (constraint!=null) {
             constraint.preCreate(governanceMetric);
        }

        EntityDetail entityDetail = GovernanceMetricMapper.mapGovernanceMetricToOmrsEntityDetail(governanceMetric);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceMetric createdGovernanceMetric =  GovernanceMetricMapper.mapOmrsEntityDetailToGovernanceMetric(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceMetric="+ createdGovernanceMetric );
        }
        return createdGovernanceMetric;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceMetrics/guid/{governanceMetricGuid}")
    public GovernanceMetric updateGovernanceMetric(@PathVariable String userId,@PathVariable String entityGuid, GovernanceMetric governanceMetric)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceMetricById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceMetricMapper.mapGovernanceMetricToOmrsEntityDetail(governanceMetric);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceMetric updatedGovernanceMetric =  GovernanceMetricMapper.mapOmrsEntityDetailToGovernanceMetric(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceMetric="+ updatedGovernanceMetric );
            }
            return updatedGovernanceMetric;
        }

    /**
     * Delete an governanceMetric identified by its GUID. Delete is a soft delete, this means that the governanceMetric has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceMetric
     * @return GovernanceMetric
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceMetrics/guid/{governanceMetricGuid}")

    public void deleteGovernanceMetricByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceMetricByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceMetricByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceMetricByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceMetric
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceMetrics/{governanceMetricGuid}/classifications")
    public GovernanceMetric addGovernanceMetricClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceMetricClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceMetric governanceMetricClassifications = GovernanceMetricMapper.mapOmrsEntityDetailToGovernanceMetric(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceMetric=" +  governanceMetricClassifications);
         }
         return  governanceMetricClassifications;
    }

    /**
     * Updates classifications to an existing governanceMetric represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceMetric
     * @return classification for the given governanceMetric guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceMetrics/{governanceMetricGuid}/classification")

    public GovernanceMetric updateGovernanceMetricClassification(@PathVariable("userId") String userId,@PathVariable("governanceMetricGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceMetricClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceMetric  governanceMetricClassifications = GovernanceMetricMapper.mapOmrsEntityDetailToGovernanceMetric(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceMetricClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceMetric represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceMetric
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceMetrics/{governanceMetricGuid}/classification/{name}")
    public GovernanceMetric deleteGovernanceMetricClassification(@PathVariable("userId") String userId,@PathVariable("governanceMetricGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceMetricClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceMetric declassifiedGovernanceMetric =  GovernanceMetricMapper.mapOmrsEntityDetailToGovernanceMetric(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceMetric;
    }

    /**
      * Get the relationships associated with entity governanceMetric represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceMetric
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceMetrics/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceMetricRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceMetricRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an externalId given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the externalIds relationships.
     * @param entityGuid GUID for the entity
     * @return ExternalId
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/externalIds/guid/{entityGuid}")
    public ExternalId getExternalIdById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getExternalIdById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ExternalId gotexternalId = ExternalIdMapper.mapOmrsEntityDetailToExternalId(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotexternalId );
        }
        return gotexternalId;

    }
    /**
     * Create new externalId in Atlas.
     * @param externalId
     * @return ExternalId
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/externalIds")
    public ExternalId createExternalId(@PathVariable String userId,ExternalId externalId)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createExternalIdById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ExternalId");
        if (constraint!=null) {
             constraint.preCreate(externalId);
        }

        EntityDetail entityDetail = ExternalIdMapper.mapExternalIdToOmrsEntityDetail(externalId);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ExternalId createdExternalId =  ExternalIdMapper.mapOmrsEntityDetailToExternalId(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ExternalId="+ createdExternalId );
        }
        return createdExternalId;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/externalIds/guid/{externalIdGuid}")
    public ExternalId updateExternalId(@PathVariable String userId,@PathVariable String entityGuid, ExternalId externalId)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateExternalIdById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ExternalIdMapper.mapExternalIdToOmrsEntityDetail(externalId);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ExternalId updatedExternalId =  ExternalIdMapper.mapOmrsEntityDetailToExternalId(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ExternalId="+ updatedExternalId );
            }
            return updatedExternalId;
        }

    /**
     * Delete an externalId identified by its GUID. Delete is a soft delete, this means that the externalId has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the externalId
     * @return ExternalId
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/externalIds/guid/{externalIdGuid}")

    public void deleteExternalIdByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteExternalIdByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeExternalIdByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeExternalIdByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied externalId
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/externalIds/{externalIdGuid}/classifications")
    public ExternalId addExternalIdClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addExternalIdClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ExternalId externalIdClassifications = ExternalIdMapper.mapOmrsEntityDetailToExternalId(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ExternalId=" +  externalIdClassifications);
         }
         return  externalIdClassifications;
    }

    /**
     * Updates classifications to an existing externalId represented by a guid.
     * @param  entityGuid globally unique identifier for the externalId
     * @return classification for the given externalId guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/externalIds/{externalIdGuid}/classification")

    public ExternalId updateExternalIdClassification(@PathVariable("userId") String userId,@PathVariable("externalIdGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateExternalIdClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ExternalId  externalIdClassifications = ExternalIdMapper.mapOmrsEntityDetailToExternalId(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  externalIdClassifications;
    }

    /**
     * Deletes a given classification from an existing externalId represented by a guid.
     * @param entityGuid  globally unique identifier for the externalId
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/externalIds/{externalIdGuid}/classification/{name}")
    public ExternalId deleteExternalIdClassification(@PathVariable("userId") String userId,@PathVariable("externalIdGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteExternalIdClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ExternalId declassifiedExternalId =  ExternalIdMapper.mapOmrsEntityDetailToExternalId(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedExternalId;
    }

    /**
      * Get the relationships associated with entity externalId represented by a guid.
      * @param entityGuid  globally unique identifier for the externalId
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/externalIds/guid/{entityGuid}/relationships")
    public List<Line> getExternalIdRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getExternalIdRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an connection given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the connections relationships.
     * @param entityGuid GUID for the entity
     * @return Connection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/connections/guid/{entityGuid}")
    public Connection getConnectionById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getConnectionById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Connection gotconnection = ConnectionMapper.mapOmrsEntityDetailToConnection(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotconnection );
        }
        return gotconnection;

    }
    /**
     * Create new connection in Atlas.
     * @param connection
     * @return Connection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/connections")
    public Connection createConnection(@PathVariable String userId,Connection connection)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createConnectionById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Connection");
        if (constraint!=null) {
             constraint.preCreate(connection);
        }

        EntityDetail entityDetail = ConnectionMapper.mapConnectionToOmrsEntityDetail(connection);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Connection createdConnection =  ConnectionMapper.mapOmrsEntityDetailToConnection(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Connection="+ createdConnection );
        }
        return createdConnection;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/connections/guid/{connectionGuid}")
    public Connection updateConnection(@PathVariable String userId,@PathVariable String entityGuid, Connection connection)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateConnectionById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ConnectionMapper.mapConnectionToOmrsEntityDetail(connection);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Connection updatedConnection =  ConnectionMapper.mapOmrsEntityDetailToConnection(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Connection="+ updatedConnection );
            }
            return updatedConnection;
        }

    /**
     * Delete an connection identified by its GUID. Delete is a soft delete, this means that the connection has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the connection
     * @return Connection
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/connections/guid/{connectionGuid}")

    public void deleteConnectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteConnectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeConnectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeConnectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied connection
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/connections/{connectionGuid}/classifications")
    public Connection addConnectionClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addConnectionClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Connection connectionClassifications = ConnectionMapper.mapOmrsEntityDetailToConnection(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Connection=" +  connectionClassifications);
         }
         return  connectionClassifications;
    }

    /**
     * Updates classifications to an existing connection represented by a guid.
     * @param  entityGuid globally unique identifier for the connection
     * @return classification for the given connection guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/connections/{connectionGuid}/classification")

    public Connection updateConnectionClassification(@PathVariable("userId") String userId,@PathVariable("connectionGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateConnectionClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Connection  connectionClassifications = ConnectionMapper.mapOmrsEntityDetailToConnection(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  connectionClassifications;
    }

    /**
     * Deletes a given classification from an existing connection represented by a guid.
     * @param entityGuid  globally unique identifier for the connection
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/connections/{connectionGuid}/classification/{name}")
    public Connection deleteConnectionClassification(@PathVariable("userId") String userId,@PathVariable("connectionGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteConnectionClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Connection declassifiedConnection =  ConnectionMapper.mapOmrsEntityDetailToConnection(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedConnection;
    }

    /**
      * Get the relationships associated with entity connection represented by a guid.
      * @param entityGuid  globally unique identifier for the connection
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/connections/guid/{entityGuid}/relationships")
    public List<Line> getConnectionRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getConnectionRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an host given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the hosts relationships.
     * @param entityGuid GUID for the entity
     * @return Host
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/hosts/guid/{entityGuid}")
    public Host getHostById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getHostById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Host gothost = HostMapper.mapOmrsEntityDetailToHost(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gothost );
        }
        return gothost;

    }
    /**
     * Create new host in Atlas.
     * @param host
     * @return Host
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/hosts")
    public Host createHost(@PathVariable String userId,Host host)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createHostById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Host");
        if (constraint!=null) {
             constraint.preCreate(host);
        }

        EntityDetail entityDetail = HostMapper.mapHostToOmrsEntityDetail(host);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Host createdHost =  HostMapper.mapOmrsEntityDetailToHost(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Host="+ createdHost );
        }
        return createdHost;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/hosts/guid/{hostGuid}")
    public Host updateHost(@PathVariable String userId,@PathVariable String entityGuid, Host host)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateHostById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = HostMapper.mapHostToOmrsEntityDetail(host);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Host updatedHost =  HostMapper.mapOmrsEntityDetailToHost(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Host="+ updatedHost );
            }
            return updatedHost;
        }

    /**
     * Delete an host identified by its GUID. Delete is a soft delete, this means that the host has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the host
     * @return Host
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/hosts/guid/{hostGuid}")

    public void deleteHostByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteHostByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeHostByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeHostByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied host
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/hosts/{hostGuid}/classifications")
    public Host addHostClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addHostClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Host hostClassifications = HostMapper.mapOmrsEntityDetailToHost(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Host=" +  hostClassifications);
         }
         return  hostClassifications;
    }

    /**
     * Updates classifications to an existing host represented by a guid.
     * @param  entityGuid globally unique identifier for the host
     * @return classification for the given host guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/hosts/{hostGuid}/classification")

    public Host updateHostClassification(@PathVariable("userId") String userId,@PathVariable("hostGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateHostClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Host  hostClassifications = HostMapper.mapOmrsEntityDetailToHost(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  hostClassifications;
    }

    /**
     * Deletes a given classification from an existing host represented by a guid.
     * @param entityGuid  globally unique identifier for the host
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/hosts/{hostGuid}/classification/{name}")
    public Host deleteHostClassification(@PathVariable("userId") String userId,@PathVariable("hostGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteHostClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Host declassifiedHost =  HostMapper.mapOmrsEntityDetailToHost(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedHost;
    }

    /**
      * Get the relationships associated with entity host represented by a guid.
      * @param entityGuid  globally unique identifier for the host
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/hosts/guid/{entityGuid}/relationships")
    public List<Line> getHostRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getHostRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an subscriberList given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the subscriberLists relationships.
     * @param entityGuid GUID for the entity
     * @return SubscriberList
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/subscriberLists/guid/{entityGuid}")
    public SubscriberList getSubscriberListById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getSubscriberListById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        SubscriberList gotsubscriberList = SubscriberListMapper.mapOmrsEntityDetailToSubscriberList(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotsubscriberList );
        }
        return gotsubscriberList;

    }
    /**
     * Create new subscriberList in Atlas.
     * @param subscriberList
     * @return SubscriberList
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/subscriberLists")
    public SubscriberList createSubscriberList(@PathVariable String userId,SubscriberList subscriberList)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createSubscriberListById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("SubscriberList");
        if (constraint!=null) {
             constraint.preCreate(subscriberList);
        }

        EntityDetail entityDetail = SubscriberListMapper.mapSubscriberListToOmrsEntityDetail(subscriberList);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        SubscriberList createdSubscriberList =  SubscriberListMapper.mapOmrsEntityDetailToSubscriberList(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created SubscriberList="+ createdSubscriberList );
        }
        return createdSubscriberList;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/subscriberLists/guid/{subscriberListGuid}")
    public SubscriberList updateSubscriberList(@PathVariable String userId,@PathVariable String entityGuid, SubscriberList subscriberList)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateSubscriberListById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = SubscriberListMapper.mapSubscriberListToOmrsEntityDetail(subscriberList);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            SubscriberList updatedSubscriberList =  SubscriberListMapper.mapOmrsEntityDetailToSubscriberList(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated SubscriberList="+ updatedSubscriberList );
            }
            return updatedSubscriberList;
        }

    /**
     * Delete an subscriberList identified by its GUID. Delete is a soft delete, this means that the subscriberList has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the subscriberList
     * @return SubscriberList
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/subscriberLists/guid/{subscriberListGuid}")

    public void deleteSubscriberListByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteSubscriberListByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeSubscriberListByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeSubscriberListByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied subscriberList
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/subscriberLists/{subscriberListGuid}/classifications")
    public SubscriberList addSubscriberListClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addSubscriberListClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         SubscriberList subscriberListClassifications = SubscriberListMapper.mapOmrsEntityDetailToSubscriberList(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified SubscriberList=" +  subscriberListClassifications);
         }
         return  subscriberListClassifications;
    }

    /**
     * Updates classifications to an existing subscriberList represented by a guid.
     * @param  entityGuid globally unique identifier for the subscriberList
     * @return classification for the given subscriberList guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/subscriberLists/{subscriberListGuid}/classification")

    public SubscriberList updateSubscriberListClassification(@PathVariable("userId") String userId,@PathVariable("subscriberListGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateSubscriberListClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           SubscriberList  subscriberListClassifications = SubscriberListMapper.mapOmrsEntityDetailToSubscriberList(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  subscriberListClassifications;
    }

    /**
     * Deletes a given classification from an existing subscriberList represented by a guid.
     * @param entityGuid  globally unique identifier for the subscriberList
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/subscriberLists/{subscriberListGuid}/classification/{name}")
    public SubscriberList deleteSubscriberListClassification(@PathVariable("userId") String userId,@PathVariable("subscriberListGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteSubscriberListClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       SubscriberList declassifiedSubscriberList =  SubscriberListMapper.mapOmrsEntityDetailToSubscriberList(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedSubscriberList;
    }

    /**
      * Get the relationships associated with entity subscriberList represented by a guid.
      * @param entityGuid  globally unique identifier for the subscriberList
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/subscriberLists/guid/{entityGuid}/relationships")
    public List<Line> getSubscriberListRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getSubscriberListRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceRule given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceRules relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceRule
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceRules/guid/{entityGuid}")
    public GovernanceRule getGovernanceRuleById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceRuleById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceRule gotgovernanceRule = GovernanceRuleMapper.mapOmrsEntityDetailToGovernanceRule(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceRule );
        }
        return gotgovernanceRule;

    }
    /**
     * Create new governanceRule in Atlas.
     * @param governanceRule
     * @return GovernanceRule
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceRules")
    public GovernanceRule createGovernanceRule(@PathVariable String userId,GovernanceRule governanceRule)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceRuleById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceRule");
        if (constraint!=null) {
             constraint.preCreate(governanceRule);
        }

        EntityDetail entityDetail = GovernanceRuleMapper.mapGovernanceRuleToOmrsEntityDetail(governanceRule);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceRule createdGovernanceRule =  GovernanceRuleMapper.mapOmrsEntityDetailToGovernanceRule(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceRule="+ createdGovernanceRule );
        }
        return createdGovernanceRule;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceRules/guid/{governanceRuleGuid}")
    public GovernanceRule updateGovernanceRule(@PathVariable String userId,@PathVariable String entityGuid, GovernanceRule governanceRule)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceRuleById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceRuleMapper.mapGovernanceRuleToOmrsEntityDetail(governanceRule);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceRule updatedGovernanceRule =  GovernanceRuleMapper.mapOmrsEntityDetailToGovernanceRule(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceRule="+ updatedGovernanceRule );
            }
            return updatedGovernanceRule;
        }

    /**
     * Delete an governanceRule identified by its GUID. Delete is a soft delete, this means that the governanceRule has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceRule
     * @return GovernanceRule
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceRules/guid/{governanceRuleGuid}")

    public void deleteGovernanceRuleByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceRuleByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceRuleByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceRuleByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceRule
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceRules/{governanceRuleGuid}/classifications")
    public GovernanceRule addGovernanceRuleClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceRuleClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceRule governanceRuleClassifications = GovernanceRuleMapper.mapOmrsEntityDetailToGovernanceRule(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceRule=" +  governanceRuleClassifications);
         }
         return  governanceRuleClassifications;
    }

    /**
     * Updates classifications to an existing governanceRule represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceRule
     * @return classification for the given governanceRule guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceRules/{governanceRuleGuid}/classification")

    public GovernanceRule updateGovernanceRuleClassification(@PathVariable("userId") String userId,@PathVariable("governanceRuleGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceRuleClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceRule  governanceRuleClassifications = GovernanceRuleMapper.mapOmrsEntityDetailToGovernanceRule(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceRuleClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceRule represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceRule
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceRules/{governanceRuleGuid}/classification/{name}")
    public GovernanceRule deleteGovernanceRuleClassification(@PathVariable("userId") String userId,@PathVariable("governanceRuleGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceRuleClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceRule declassifiedGovernanceRule =  GovernanceRuleMapper.mapOmrsEntityDetailToGovernanceRule(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceRule;
    }

    /**
      * Get the relationships associated with entity governanceRule represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceRule
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceRules/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceRuleRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceRuleRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an metadataRepositoryCohort given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the metadataRepositoryCohorts relationships.
     * @param entityGuid GUID for the entity
     * @return MetadataRepositoryCohort
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/metadataRepositoryCohorts/guid/{entityGuid}")
    public MetadataRepositoryCohort getMetadataRepositoryCohortById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getMetadataRepositoryCohortById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        MetadataRepositoryCohort gotmetadataRepositoryCohort = MetadataRepositoryCohortMapper.mapOmrsEntityDetailToMetadataRepositoryCohort(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotmetadataRepositoryCohort );
        }
        return gotmetadataRepositoryCohort;

    }
    /**
     * Create new metadataRepositoryCohort in Atlas.
     * @param metadataRepositoryCohort
     * @return MetadataRepositoryCohort
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/metadataRepositoryCohorts")
    public MetadataRepositoryCohort createMetadataRepositoryCohort(@PathVariable String userId,MetadataRepositoryCohort metadataRepositoryCohort)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createMetadataRepositoryCohortById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("MetadataRepositoryCohort");
        if (constraint!=null) {
             constraint.preCreate(metadataRepositoryCohort);
        }

        EntityDetail entityDetail = MetadataRepositoryCohortMapper.mapMetadataRepositoryCohortToOmrsEntityDetail(metadataRepositoryCohort);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        MetadataRepositoryCohort createdMetadataRepositoryCohort =  MetadataRepositoryCohortMapper.mapOmrsEntityDetailToMetadataRepositoryCohort(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created MetadataRepositoryCohort="+ createdMetadataRepositoryCohort );
        }
        return createdMetadataRepositoryCohort;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/metadataRepositoryCohorts/guid/{metadataRepositoryCohortGuid}")
    public MetadataRepositoryCohort updateMetadataRepositoryCohort(@PathVariable String userId,@PathVariable String entityGuid, MetadataRepositoryCohort metadataRepositoryCohort)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateMetadataRepositoryCohortById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = MetadataRepositoryCohortMapper.mapMetadataRepositoryCohortToOmrsEntityDetail(metadataRepositoryCohort);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            MetadataRepositoryCohort updatedMetadataRepositoryCohort =  MetadataRepositoryCohortMapper.mapOmrsEntityDetailToMetadataRepositoryCohort(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated MetadataRepositoryCohort="+ updatedMetadataRepositoryCohort );
            }
            return updatedMetadataRepositoryCohort;
        }

    /**
     * Delete an metadataRepositoryCohort identified by its GUID. Delete is a soft delete, this means that the metadataRepositoryCohort has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the metadataRepositoryCohort
     * @return MetadataRepositoryCohort
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/metadataRepositoryCohorts/guid/{metadataRepositoryCohortGuid}")

    public void deleteMetadataRepositoryCohortByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteMetadataRepositoryCohortByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeMetadataRepositoryCohortByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeMetadataRepositoryCohortByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied metadataRepositoryCohort
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/metadataRepositoryCohorts/{metadataRepositoryCohortGuid}/classifications")
    public MetadataRepositoryCohort addMetadataRepositoryCohortClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addMetadataRepositoryCohortClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         MetadataRepositoryCohort metadataRepositoryCohortClassifications = MetadataRepositoryCohortMapper.mapOmrsEntityDetailToMetadataRepositoryCohort(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified MetadataRepositoryCohort=" +  metadataRepositoryCohortClassifications);
         }
         return  metadataRepositoryCohortClassifications;
    }

    /**
     * Updates classifications to an existing metadataRepositoryCohort represented by a guid.
     * @param  entityGuid globally unique identifier for the metadataRepositoryCohort
     * @return classification for the given metadataRepositoryCohort guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/metadataRepositoryCohorts/{metadataRepositoryCohortGuid}/classification")

    public MetadataRepositoryCohort updateMetadataRepositoryCohortClassification(@PathVariable("userId") String userId,@PathVariable("metadataRepositoryCohortGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateMetadataRepositoryCohortClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           MetadataRepositoryCohort  metadataRepositoryCohortClassifications = MetadataRepositoryCohortMapper.mapOmrsEntityDetailToMetadataRepositoryCohort(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  metadataRepositoryCohortClassifications;
    }

    /**
     * Deletes a given classification from an existing metadataRepositoryCohort represented by a guid.
     * @param entityGuid  globally unique identifier for the metadataRepositoryCohort
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/metadataRepositoryCohorts/{metadataRepositoryCohortGuid}/classification/{name}")
    public MetadataRepositoryCohort deleteMetadataRepositoryCohortClassification(@PathVariable("userId") String userId,@PathVariable("metadataRepositoryCohortGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteMetadataRepositoryCohortClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       MetadataRepositoryCohort declassifiedMetadataRepositoryCohort =  MetadataRepositoryCohortMapper.mapOmrsEntityDetailToMetadataRepositoryCohort(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedMetadataRepositoryCohort;
    }

    /**
      * Get the relationships associated with entity metadataRepositoryCohort represented by a guid.
      * @param entityGuid  globally unique identifier for the metadataRepositoryCohort
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/metadataRepositoryCohorts/guid/{entityGuid}/relationships")
    public List<Line> getMetadataRepositoryCohortRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getMetadataRepositoryCohortRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an noteLog given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the noteLogs relationships.
     * @param entityGuid GUID for the entity
     * @return NoteLog
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/noteLogs/guid/{entityGuid}")
    public NoteLog getNoteLogById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getNoteLogById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        NoteLog gotnoteLog = NoteLogMapper.mapOmrsEntityDetailToNoteLog(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotnoteLog );
        }
        return gotnoteLog;

    }
    /**
     * Create new noteLog in Atlas.
     * @param noteLog
     * @return NoteLog
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/noteLogs")
    public NoteLog createNoteLog(@PathVariable String userId,NoteLog noteLog)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createNoteLogById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("NoteLog");
        if (constraint!=null) {
             constraint.preCreate(noteLog);
        }

        EntityDetail entityDetail = NoteLogMapper.mapNoteLogToOmrsEntityDetail(noteLog);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        NoteLog createdNoteLog =  NoteLogMapper.mapOmrsEntityDetailToNoteLog(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created NoteLog="+ createdNoteLog );
        }
        return createdNoteLog;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/noteLogs/guid/{noteLogGuid}")
    public NoteLog updateNoteLog(@PathVariable String userId,@PathVariable String entityGuid, NoteLog noteLog)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateNoteLogById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = NoteLogMapper.mapNoteLogToOmrsEntityDetail(noteLog);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            NoteLog updatedNoteLog =  NoteLogMapper.mapOmrsEntityDetailToNoteLog(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated NoteLog="+ updatedNoteLog );
            }
            return updatedNoteLog;
        }

    /**
     * Delete an noteLog identified by its GUID. Delete is a soft delete, this means that the noteLog has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the noteLog
     * @return NoteLog
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/noteLogs/guid/{noteLogGuid}")

    public void deleteNoteLogByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteNoteLogByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeNoteLogByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeNoteLogByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied noteLog
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/noteLogs/{noteLogGuid}/classifications")
    public NoteLog addNoteLogClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addNoteLogClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         NoteLog noteLogClassifications = NoteLogMapper.mapOmrsEntityDetailToNoteLog(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified NoteLog=" +  noteLogClassifications);
         }
         return  noteLogClassifications;
    }

    /**
     * Updates classifications to an existing noteLog represented by a guid.
     * @param  entityGuid globally unique identifier for the noteLog
     * @return classification for the given noteLog guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/noteLogs/{noteLogGuid}/classification")

    public NoteLog updateNoteLogClassification(@PathVariable("userId") String userId,@PathVariable("noteLogGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateNoteLogClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           NoteLog  noteLogClassifications = NoteLogMapper.mapOmrsEntityDetailToNoteLog(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  noteLogClassifications;
    }

    /**
     * Deletes a given classification from an existing noteLog represented by a guid.
     * @param entityGuid  globally unique identifier for the noteLog
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/noteLogs/{noteLogGuid}/classification/{name}")
    public NoteLog deleteNoteLogClassification(@PathVariable("userId") String userId,@PathVariable("noteLogGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteNoteLogClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       NoteLog declassifiedNoteLog =  NoteLogMapper.mapOmrsEntityDetailToNoteLog(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedNoteLog;
    }

    /**
      * Get the relationships associated with entity noteLog represented by a guid.
      * @param entityGuid  globally unique identifier for the noteLog
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/noteLogs/guid/{entityGuid}/relationships")
    public List<Line> getNoteLogRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getNoteLogRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an externalGlossaryLink given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the externalGlossaryLinks relationships.
     * @param entityGuid GUID for the entity
     * @return ExternalGlossaryLink
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/externalGlossaryLinks/guid/{entityGuid}")
    public ExternalGlossaryLink getExternalGlossaryLinkById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getExternalGlossaryLinkById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        ExternalGlossaryLink gotexternalGlossaryLink = ExternalGlossaryLinkMapper.mapOmrsEntityDetailToExternalGlossaryLink(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotexternalGlossaryLink );
        }
        return gotexternalGlossaryLink;

    }
    /**
     * Create new externalGlossaryLink in Atlas.
     * @param externalGlossaryLink
     * @return ExternalGlossaryLink
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/externalGlossaryLinks")
    public ExternalGlossaryLink createExternalGlossaryLink(@PathVariable String userId,ExternalGlossaryLink externalGlossaryLink)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createExternalGlossaryLinkById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("ExternalGlossaryLink");
        if (constraint!=null) {
             constraint.preCreate(externalGlossaryLink);
        }

        EntityDetail entityDetail = ExternalGlossaryLinkMapper.mapExternalGlossaryLinkToOmrsEntityDetail(externalGlossaryLink);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        ExternalGlossaryLink createdExternalGlossaryLink =  ExternalGlossaryLinkMapper.mapOmrsEntityDetailToExternalGlossaryLink(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created ExternalGlossaryLink="+ createdExternalGlossaryLink );
        }
        return createdExternalGlossaryLink;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/externalGlossaryLinks/guid/{externalGlossaryLinkGuid}")
    public ExternalGlossaryLink updateExternalGlossaryLink(@PathVariable String userId,@PathVariable String entityGuid, ExternalGlossaryLink externalGlossaryLink)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateExternalGlossaryLinkById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = ExternalGlossaryLinkMapper.mapExternalGlossaryLinkToOmrsEntityDetail(externalGlossaryLink);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            ExternalGlossaryLink updatedExternalGlossaryLink =  ExternalGlossaryLinkMapper.mapOmrsEntityDetailToExternalGlossaryLink(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated ExternalGlossaryLink="+ updatedExternalGlossaryLink );
            }
            return updatedExternalGlossaryLink;
        }

    /**
     * Delete an externalGlossaryLink identified by its GUID. Delete is a soft delete, this means that the externalGlossaryLink has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the externalGlossaryLink
     * @return ExternalGlossaryLink
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/externalGlossaryLinks/guid/{externalGlossaryLinkGuid}")

    public void deleteExternalGlossaryLinkByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteExternalGlossaryLinkByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeExternalGlossaryLinkByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeExternalGlossaryLinkByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied externalGlossaryLink
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/externalGlossaryLinks/{externalGlossaryLinkGuid}/classifications")
    public ExternalGlossaryLink addExternalGlossaryLinkClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addExternalGlossaryLinkClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         ExternalGlossaryLink externalGlossaryLinkClassifications = ExternalGlossaryLinkMapper.mapOmrsEntityDetailToExternalGlossaryLink(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified ExternalGlossaryLink=" +  externalGlossaryLinkClassifications);
         }
         return  externalGlossaryLinkClassifications;
    }

    /**
     * Updates classifications to an existing externalGlossaryLink represented by a guid.
     * @param  entityGuid globally unique identifier for the externalGlossaryLink
     * @return classification for the given externalGlossaryLink guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/externalGlossaryLinks/{externalGlossaryLinkGuid}/classification")

    public ExternalGlossaryLink updateExternalGlossaryLinkClassification(@PathVariable("userId") String userId,@PathVariable("externalGlossaryLinkGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateExternalGlossaryLinkClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           ExternalGlossaryLink  externalGlossaryLinkClassifications = ExternalGlossaryLinkMapper.mapOmrsEntityDetailToExternalGlossaryLink(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  externalGlossaryLinkClassifications;
    }

    /**
     * Deletes a given classification from an existing externalGlossaryLink represented by a guid.
     * @param entityGuid  globally unique identifier for the externalGlossaryLink
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/externalGlossaryLinks/{externalGlossaryLinkGuid}/classification/{name}")
    public ExternalGlossaryLink deleteExternalGlossaryLinkClassification(@PathVariable("userId") String userId,@PathVariable("externalGlossaryLinkGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteExternalGlossaryLinkClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       ExternalGlossaryLink declassifiedExternalGlossaryLink =  ExternalGlossaryLinkMapper.mapOmrsEntityDetailToExternalGlossaryLink(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedExternalGlossaryLink;
    }

    /**
      * Get the relationships associated with entity externalGlossaryLink represented by a guid.
      * @param entityGuid  globally unique identifier for the externalGlossaryLink
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/externalGlossaryLinks/guid/{entityGuid}/relationships")
    public List<Line> getExternalGlossaryLinkRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getExternalGlossaryLinkRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an virtualConnection given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the virtualConnections relationships.
     * @param entityGuid GUID for the entity
     * @return VirtualConnection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/virtualConnections/guid/{entityGuid}")
    public VirtualConnection getVirtualConnectionById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getVirtualConnectionById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        VirtualConnection gotvirtualConnection = VirtualConnectionMapper.mapOmrsEntityDetailToVirtualConnection(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotvirtualConnection );
        }
        return gotvirtualConnection;

    }
    /**
     * Create new virtualConnection in Atlas.
     * @param virtualConnection
     * @return VirtualConnection
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/virtualConnections")
    public VirtualConnection createVirtualConnection(@PathVariable String userId,VirtualConnection virtualConnection)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createVirtualConnectionById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("VirtualConnection");
        if (constraint!=null) {
             constraint.preCreate(virtualConnection);
        }

        EntityDetail entityDetail = VirtualConnectionMapper.mapVirtualConnectionToOmrsEntityDetail(virtualConnection);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        VirtualConnection createdVirtualConnection =  VirtualConnectionMapper.mapOmrsEntityDetailToVirtualConnection(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created VirtualConnection="+ createdVirtualConnection );
        }
        return createdVirtualConnection;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/virtualConnections/guid/{virtualConnectionGuid}")
    public VirtualConnection updateVirtualConnection(@PathVariable String userId,@PathVariable String entityGuid, VirtualConnection virtualConnection)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateVirtualConnectionById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = VirtualConnectionMapper.mapVirtualConnectionToOmrsEntityDetail(virtualConnection);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            VirtualConnection updatedVirtualConnection =  VirtualConnectionMapper.mapOmrsEntityDetailToVirtualConnection(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated VirtualConnection="+ updatedVirtualConnection );
            }
            return updatedVirtualConnection;
        }

    /**
     * Delete an virtualConnection identified by its GUID. Delete is a soft delete, this means that the virtualConnection has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the virtualConnection
     * @return VirtualConnection
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/virtualConnections/guid/{virtualConnectionGuid}")

    public void deleteVirtualConnectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteVirtualConnectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeVirtualConnectionByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeVirtualConnectionByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied virtualConnection
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/virtualConnections/{virtualConnectionGuid}/classifications")
    public VirtualConnection addVirtualConnectionClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addVirtualConnectionClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         VirtualConnection virtualConnectionClassifications = VirtualConnectionMapper.mapOmrsEntityDetailToVirtualConnection(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified VirtualConnection=" +  virtualConnectionClassifications);
         }
         return  virtualConnectionClassifications;
    }

    /**
     * Updates classifications to an existing virtualConnection represented by a guid.
     * @param  entityGuid globally unique identifier for the virtualConnection
     * @return classification for the given virtualConnection guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/virtualConnections/{virtualConnectionGuid}/classification")

    public VirtualConnection updateVirtualConnectionClassification(@PathVariable("userId") String userId,@PathVariable("virtualConnectionGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateVirtualConnectionClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           VirtualConnection  virtualConnectionClassifications = VirtualConnectionMapper.mapOmrsEntityDetailToVirtualConnection(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  virtualConnectionClassifications;
    }

    /**
     * Deletes a given classification from an existing virtualConnection represented by a guid.
     * @param entityGuid  globally unique identifier for the virtualConnection
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/virtualConnections/{virtualConnectionGuid}/classification/{name}")
    public VirtualConnection deleteVirtualConnectionClassification(@PathVariable("userId") String userId,@PathVariable("virtualConnectionGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteVirtualConnectionClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       VirtualConnection declassifiedVirtualConnection =  VirtualConnectionMapper.mapOmrsEntityDetailToVirtualConnection(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedVirtualConnection;
    }

    /**
      * Get the relationships associated with entity virtualConnection represented by a guid.
      * @param entityGuid  globally unique identifier for the virtualConnection
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/virtualConnections/guid/{entityGuid}/relationships")
    public List<Line> getVirtualConnectionRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getVirtualConnectionRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an regulation given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the regulations relationships.
     * @param entityGuid GUID for the entity
     * @return Regulation
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/regulations/guid/{entityGuid}")
    public Regulation getRegulationById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getRegulationById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Regulation gotregulation = RegulationMapper.mapOmrsEntityDetailToRegulation(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotregulation );
        }
        return gotregulation;

    }
    /**
     * Create new regulation in Atlas.
     * @param regulation
     * @return Regulation
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/regulations")
    public Regulation createRegulation(@PathVariable String userId,Regulation regulation)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createRegulationById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Regulation");
        if (constraint!=null) {
             constraint.preCreate(regulation);
        }

        EntityDetail entityDetail = RegulationMapper.mapRegulationToOmrsEntityDetail(regulation);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Regulation createdRegulation =  RegulationMapper.mapOmrsEntityDetailToRegulation(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Regulation="+ createdRegulation );
        }
        return createdRegulation;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/regulations/guid/{regulationGuid}")
    public Regulation updateRegulation(@PathVariable String userId,@PathVariable String entityGuid, Regulation regulation)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateRegulationById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = RegulationMapper.mapRegulationToOmrsEntityDetail(regulation);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Regulation updatedRegulation =  RegulationMapper.mapOmrsEntityDetailToRegulation(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Regulation="+ updatedRegulation );
            }
            return updatedRegulation;
        }

    /**
     * Delete an regulation identified by its GUID. Delete is a soft delete, this means that the regulation has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the regulation
     * @return Regulation
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/regulations/guid/{regulationGuid}")

    public void deleteRegulationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteRegulationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeRegulationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeRegulationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied regulation
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/regulations/{regulationGuid}/classifications")
    public Regulation addRegulationClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addRegulationClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Regulation regulationClassifications = RegulationMapper.mapOmrsEntityDetailToRegulation(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Regulation=" +  regulationClassifications);
         }
         return  regulationClassifications;
    }

    /**
     * Updates classifications to an existing regulation represented by a guid.
     * @param  entityGuid globally unique identifier for the regulation
     * @return classification for the given regulation guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/regulations/{regulationGuid}/classification")

    public Regulation updateRegulationClassification(@PathVariable("userId") String userId,@PathVariable("regulationGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateRegulationClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Regulation  regulationClassifications = RegulationMapper.mapOmrsEntityDetailToRegulation(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  regulationClassifications;
    }

    /**
     * Deletes a given classification from an existing regulation represented by a guid.
     * @param entityGuid  globally unique identifier for the regulation
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/regulations/{regulationGuid}/classification/{name}")
    public Regulation deleteRegulationClassification(@PathVariable("userId") String userId,@PathVariable("regulationGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteRegulationClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Regulation declassifiedRegulation =  RegulationMapper.mapOmrsEntityDetailToRegulation(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedRegulation;
    }

    /**
      * Get the relationships associated with entity regulation represented by a guid.
      * @param entityGuid  globally unique identifier for the regulation
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/regulations/guid/{entityGuid}/relationships")
    public List<Line> getRegulationRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getRegulationRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an governanceProcess given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the governanceProcesses relationships.
     * @param entityGuid GUID for the entity
     * @return GovernanceProcess
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceProcesses/guid/{entityGuid}")
    public GovernanceProcess getGovernanceProcessById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGovernanceProcessById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GovernanceProcess gotgovernanceProcess = GovernanceProcessMapper.mapOmrsEntityDetailToGovernanceProcess(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgovernanceProcess );
        }
        return gotgovernanceProcess;

    }
    /**
     * Create new governanceProcess in Atlas.
     * @param governanceProcess
     * @return GovernanceProcess
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceProcesses")
    public GovernanceProcess createGovernanceProcess(@PathVariable String userId,GovernanceProcess governanceProcess)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGovernanceProcessById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GovernanceProcess");
        if (constraint!=null) {
             constraint.preCreate(governanceProcess);
        }

        EntityDetail entityDetail = GovernanceProcessMapper.mapGovernanceProcessToOmrsEntityDetail(governanceProcess);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GovernanceProcess createdGovernanceProcess =  GovernanceProcessMapper.mapOmrsEntityDetailToGovernanceProcess(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GovernanceProcess="+ createdGovernanceProcess );
        }
        return createdGovernanceProcess;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceProcesses/guid/{governanceProcessGuid}")
    public GovernanceProcess updateGovernanceProcess(@PathVariable String userId,@PathVariable String entityGuid, GovernanceProcess governanceProcess)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGovernanceProcessById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GovernanceProcessMapper.mapGovernanceProcessToOmrsEntityDetail(governanceProcess);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GovernanceProcess updatedGovernanceProcess =  GovernanceProcessMapper.mapOmrsEntityDetailToGovernanceProcess(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GovernanceProcess="+ updatedGovernanceProcess );
            }
            return updatedGovernanceProcess;
        }

    /**
     * Delete an governanceProcess identified by its GUID. Delete is a soft delete, this means that the governanceProcess has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the governanceProcess
     * @return GovernanceProcess
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceProcesses/guid/{governanceProcessGuid}")

    public void deleteGovernanceProcessByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGovernanceProcessByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGovernanceProcessByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGovernanceProcessByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied governanceProcess
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/governanceProcesses/{governanceProcessGuid}/classifications")
    public GovernanceProcess addGovernanceProcessClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGovernanceProcessClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GovernanceProcess governanceProcessClassifications = GovernanceProcessMapper.mapOmrsEntityDetailToGovernanceProcess(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GovernanceProcess=" +  governanceProcessClassifications);
         }
         return  governanceProcessClassifications;
    }

    /**
     * Updates classifications to an existing governanceProcess represented by a guid.
     * @param  entityGuid globally unique identifier for the governanceProcess
     * @return classification for the given governanceProcess guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/governanceProcesses/{governanceProcessGuid}/classification")

    public GovernanceProcess updateGovernanceProcessClassification(@PathVariable("userId") String userId,@PathVariable("governanceProcessGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGovernanceProcessClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GovernanceProcess  governanceProcessClassifications = GovernanceProcessMapper.mapOmrsEntityDetailToGovernanceProcess(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  governanceProcessClassifications;
    }

    /**
     * Deletes a given classification from an existing governanceProcess represented by a guid.
     * @param entityGuid  globally unique identifier for the governanceProcess
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/governanceProcesses/{governanceProcessGuid}/classification/{name}")
    public GovernanceProcess deleteGovernanceProcessClassification(@PathVariable("userId") String userId,@PathVariable("governanceProcessGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGovernanceProcessClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GovernanceProcess declassifiedGovernanceProcess =  GovernanceProcessMapper.mapOmrsEntityDetailToGovernanceProcess(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGovernanceProcess;
    }

    /**
      * Get the relationships associated with entity governanceProcess represented by a guid.
      * @param entityGuid  globally unique identifier for the governanceProcess
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/governanceProcesses/guid/{entityGuid}/relationships")
    public List<Line> getGovernanceProcessRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGovernanceProcessRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an schemaAttribute given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the schemaAttributes relationships.
     * @param entityGuid GUID for the entity
     * @return SchemaAttribute
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/schemaAttributes/guid/{entityGuid}")
    public SchemaAttribute getSchemaAttributeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getSchemaAttributeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        SchemaAttribute gotschemaAttribute = SchemaAttributeMapper.mapOmrsEntityDetailToSchemaAttribute(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotschemaAttribute );
        }
        return gotschemaAttribute;

    }
    /**
     * Create new schemaAttribute in Atlas.
     * @param schemaAttribute
     * @return SchemaAttribute
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/schemaAttributes")
    public SchemaAttribute createSchemaAttribute(@PathVariable String userId,SchemaAttribute schemaAttribute)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createSchemaAttributeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("SchemaAttribute");
        if (constraint!=null) {
             constraint.preCreate(schemaAttribute);
        }

        EntityDetail entityDetail = SchemaAttributeMapper.mapSchemaAttributeToOmrsEntityDetail(schemaAttribute);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        SchemaAttribute createdSchemaAttribute =  SchemaAttributeMapper.mapOmrsEntityDetailToSchemaAttribute(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created SchemaAttribute="+ createdSchemaAttribute );
        }
        return createdSchemaAttribute;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/schemaAttributes/guid/{schemaAttributeGuid}")
    public SchemaAttribute updateSchemaAttribute(@PathVariable String userId,@PathVariable String entityGuid, SchemaAttribute schemaAttribute)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateSchemaAttributeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = SchemaAttributeMapper.mapSchemaAttributeToOmrsEntityDetail(schemaAttribute);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            SchemaAttribute updatedSchemaAttribute =  SchemaAttributeMapper.mapOmrsEntityDetailToSchemaAttribute(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated SchemaAttribute="+ updatedSchemaAttribute );
            }
            return updatedSchemaAttribute;
        }

    /**
     * Delete an schemaAttribute identified by its GUID. Delete is a soft delete, this means that the schemaAttribute has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the schemaAttribute
     * @return SchemaAttribute
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/schemaAttributes/guid/{schemaAttributeGuid}")

    public void deleteSchemaAttributeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteSchemaAttributeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeSchemaAttributeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeSchemaAttributeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied schemaAttribute
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/schemaAttributes/{schemaAttributeGuid}/classifications")
    public SchemaAttribute addSchemaAttributeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addSchemaAttributeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         SchemaAttribute schemaAttributeClassifications = SchemaAttributeMapper.mapOmrsEntityDetailToSchemaAttribute(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified SchemaAttribute=" +  schemaAttributeClassifications);
         }
         return  schemaAttributeClassifications;
    }

    /**
     * Updates classifications to an existing schemaAttribute represented by a guid.
     * @param  entityGuid globally unique identifier for the schemaAttribute
     * @return classification for the given schemaAttribute guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/schemaAttributes/{schemaAttributeGuid}/classification")

    public SchemaAttribute updateSchemaAttributeClassification(@PathVariable("userId") String userId,@PathVariable("schemaAttributeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateSchemaAttributeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           SchemaAttribute  schemaAttributeClassifications = SchemaAttributeMapper.mapOmrsEntityDetailToSchemaAttribute(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  schemaAttributeClassifications;
    }

    /**
     * Deletes a given classification from an existing schemaAttribute represented by a guid.
     * @param entityGuid  globally unique identifier for the schemaAttribute
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/schemaAttributes/{schemaAttributeGuid}/classification/{name}")
    public SchemaAttribute deleteSchemaAttributeClassification(@PathVariable("userId") String userId,@PathVariable("schemaAttributeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteSchemaAttributeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       SchemaAttribute declassifiedSchemaAttribute =  SchemaAttributeMapper.mapOmrsEntityDetailToSchemaAttribute(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedSchemaAttribute;
    }

    /**
      * Get the relationships associated with entity schemaAttribute represented by a guid.
      * @param entityGuid  globally unique identifier for the schemaAttribute
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/schemaAttributes/guid/{entityGuid}/relationships")
    public List<Line> getSchemaAttributeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getSchemaAttributeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an graphEdge given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the graphEdges relationships.
     * @param entityGuid GUID for the entity
     * @return GraphEdge
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/graphEdges/guid/{entityGuid}")
    public GraphEdge getGraphEdgeById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getGraphEdgeById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        GraphEdge gotgraphEdge = GraphEdgeMapper.mapOmrsEntityDetailToGraphEdge(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotgraphEdge );
        }
        return gotgraphEdge;

    }
    /**
     * Create new graphEdge in Atlas.
     * @param graphEdge
     * @return GraphEdge
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/graphEdges")
    public GraphEdge createGraphEdge(@PathVariable String userId,GraphEdge graphEdge)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createGraphEdgeById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("GraphEdge");
        if (constraint!=null) {
             constraint.preCreate(graphEdge);
        }

        EntityDetail entityDetail = GraphEdgeMapper.mapGraphEdgeToOmrsEntityDetail(graphEdge);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        GraphEdge createdGraphEdge =  GraphEdgeMapper.mapOmrsEntityDetailToGraphEdge(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created GraphEdge="+ createdGraphEdge );
        }
        return createdGraphEdge;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/graphEdges/guid/{graphEdgeGuid}")
    public GraphEdge updateGraphEdge(@PathVariable String userId,@PathVariable String entityGuid, GraphEdge graphEdge)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateGraphEdgeById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = GraphEdgeMapper.mapGraphEdgeToOmrsEntityDetail(graphEdge);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            GraphEdge updatedGraphEdge =  GraphEdgeMapper.mapOmrsEntityDetailToGraphEdge(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated GraphEdge="+ updatedGraphEdge );
            }
            return updatedGraphEdge;
        }

    /**
     * Delete an graphEdge identified by its GUID. Delete is a soft delete, this means that the graphEdge has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the graphEdge
     * @return GraphEdge
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/graphEdges/guid/{graphEdgeGuid}")

    public void deleteGraphEdgeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteGraphEdgeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeGraphEdgeByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeGraphEdgeByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied graphEdge
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/graphEdges/{graphEdgeGuid}/classifications")
    public GraphEdge addGraphEdgeClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addGraphEdgeClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         GraphEdge graphEdgeClassifications = GraphEdgeMapper.mapOmrsEntityDetailToGraphEdge(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified GraphEdge=" +  graphEdgeClassifications);
         }
         return  graphEdgeClassifications;
    }

    /**
     * Updates classifications to an existing graphEdge represented by a guid.
     * @param  entityGuid globally unique identifier for the graphEdge
     * @return classification for the given graphEdge guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/graphEdges/{graphEdgeGuid}/classification")

    public GraphEdge updateGraphEdgeClassification(@PathVariable("userId") String userId,@PathVariable("graphEdgeGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateGraphEdgeClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           GraphEdge  graphEdgeClassifications = GraphEdgeMapper.mapOmrsEntityDetailToGraphEdge(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  graphEdgeClassifications;
    }

    /**
     * Deletes a given classification from an existing graphEdge represented by a guid.
     * @param entityGuid  globally unique identifier for the graphEdge
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/graphEdges/{graphEdgeGuid}/classification/{name}")
    public GraphEdge deleteGraphEdgeClassification(@PathVariable("userId") String userId,@PathVariable("graphEdgeGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteGraphEdgeClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       GraphEdge declassifiedGraphEdge =  GraphEdgeMapper.mapOmrsEntityDetailToGraphEdge(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedGraphEdge;
    }

    /**
      * Get the relationships associated with entity graphEdge represented by a guid.
      * @param entityGuid  globally unique identifier for the graphEdge
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/graphEdges/guid/{entityGuid}/relationships")
    public List<Line> getGraphEdgeRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getGraphEdgeRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an community given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the communities relationships.
     * @param entityGuid GUID for the entity
     * @return Community
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/communities/guid/{entityGuid}")
    public Community getCommunityById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getCommunityById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Community gotcommunity = CommunityMapper.mapOmrsEntityDetailToCommunity(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotcommunity );
        }
        return gotcommunity;

    }
    /**
     * Create new community in Atlas.
     * @param community
     * @return Community
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/communities")
    public Community createCommunity(@PathVariable String userId,Community community)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createCommunityById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Community");
        if (constraint!=null) {
             constraint.preCreate(community);
        }

        EntityDetail entityDetail = CommunityMapper.mapCommunityToOmrsEntityDetail(community);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Community createdCommunity =  CommunityMapper.mapOmrsEntityDetailToCommunity(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Community="+ createdCommunity );
        }
        return createdCommunity;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/communities/guid/{communityGuid}")
    public Community updateCommunity(@PathVariable String userId,@PathVariable String entityGuid, Community community)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateCommunityById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = CommunityMapper.mapCommunityToOmrsEntityDetail(community);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Community updatedCommunity =  CommunityMapper.mapOmrsEntityDetailToCommunity(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Community="+ updatedCommunity );
            }
            return updatedCommunity;
        }

    /**
     * Delete an community identified by its GUID. Delete is a soft delete, this means that the community has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the community
     * @return Community
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/communities/guid/{communityGuid}")

    public void deleteCommunityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteCommunityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeCommunityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeCommunityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied community
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/communities/{communityGuid}/classifications")
    public Community addCommunityClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addCommunityClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Community communityClassifications = CommunityMapper.mapOmrsEntityDetailToCommunity(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Community=" +  communityClassifications);
         }
         return  communityClassifications;
    }

    /**
     * Updates classifications to an existing community represented by a guid.
     * @param  entityGuid globally unique identifier for the community
     * @return classification for the given community guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/communities/{communityGuid}/classification")

    public Community updateCommunityClassification(@PathVariable("userId") String userId,@PathVariable("communityGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateCommunityClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Community  communityClassifications = CommunityMapper.mapOmrsEntityDetailToCommunity(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  communityClassifications;
    }

    /**
     * Deletes a given classification from an existing community represented by a guid.
     * @param entityGuid  globally unique identifier for the community
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/communities/{communityGuid}/classification/{name}")
    public Community deleteCommunityClassification(@PathVariable("userId") String userId,@PathVariable("communityGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteCommunityClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Community declassifiedCommunity =  CommunityMapper.mapOmrsEntityDetailToCommunity(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedCommunity;
    }

    /**
      * Get the relationships associated with entity community represented by a guid.
      * @param entityGuid  globally unique identifier for the community
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/communities/guid/{entityGuid}/relationships")
    public List<Line> getCommunityRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getCommunityRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an location given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the locations relationships.
     * @param entityGuid GUID for the entity
     * @return Location
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/locations/guid/{entityGuid}")
    public Location getLocationById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getLocationById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        Location gotlocation = LocationMapper.mapOmrsEntityDetailToLocation(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotlocation );
        }
        return gotlocation;

    }
    /**
     * Create new location in Atlas.
     * @param location
     * @return Location
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/locations")
    public Location createLocation(@PathVariable String userId,Location location)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createLocationById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("Location");
        if (constraint!=null) {
             constraint.preCreate(location);
        }

        EntityDetail entityDetail = LocationMapper.mapLocationToOmrsEntityDetail(location);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        Location createdLocation =  LocationMapper.mapOmrsEntityDetailToLocation(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created Location="+ createdLocation );
        }
        return createdLocation;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/locations/guid/{locationGuid}")
    public Location updateLocation(@PathVariable String userId,@PathVariable String entityGuid, Location location)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateLocationById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = LocationMapper.mapLocationToOmrsEntityDetail(location);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            Location updatedLocation =  LocationMapper.mapOmrsEntityDetailToLocation(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated Location="+ updatedLocation );
            }
            return updatedLocation;
        }

    /**
     * Delete an location identified by its GUID. Delete is a soft delete, this means that the location has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the location
     * @return Location
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/locations/guid/{locationGuid}")

    public void deleteLocationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteLocationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeLocationByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeLocationByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied location
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/locations/{locationGuid}/classifications")
    public Location addLocationClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addLocationClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         Location locationClassifications = LocationMapper.mapOmrsEntityDetailToLocation(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified Location=" +  locationClassifications);
         }
         return  locationClassifications;
    }

    /**
     * Updates classifications to an existing location represented by a guid.
     * @param  entityGuid globally unique identifier for the location
     * @return classification for the given location guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/locations/{locationGuid}/classification")

    public Location updateLocationClassification(@PathVariable("userId") String userId,@PathVariable("locationGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateLocationClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           Location  locationClassifications = LocationMapper.mapOmrsEntityDetailToLocation(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  locationClassifications;
    }

    /**
     * Deletes a given classification from an existing location represented by a guid.
     * @param entityGuid  globally unique identifier for the location
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/locations/{locationGuid}/classification/{name}")
    public Location deleteLocationClassification(@PathVariable("userId") String userId,@PathVariable("locationGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteLocationClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       Location declassifiedLocation =  LocationMapper.mapOmrsEntityDetailToLocation(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedLocation;
    }

    /**
      * Get the relationships associated with entity location represented by a guid.
      * @param entityGuid  globally unique identifier for the location
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/locations/guid/{entityGuid}/relationships")
    public List<Line> getLocationRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getLocationRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an businessCapability given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the businessCapabilities relationships.
     * @param entityGuid GUID for the entity
     * @return BusinessCapability
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/businessCapabilities/guid/{entityGuid}")
    public BusinessCapability getBusinessCapabilityById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getBusinessCapabilityById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        BusinessCapability gotbusinessCapability = BusinessCapabilityMapper.mapOmrsEntityDetailToBusinessCapability(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotbusinessCapability );
        }
        return gotbusinessCapability;

    }
    /**
     * Create new businessCapability in Atlas.
     * @param businessCapability
     * @return BusinessCapability
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/businessCapabilities")
    public BusinessCapability createBusinessCapability(@PathVariable String userId,BusinessCapability businessCapability)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createBusinessCapabilityById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("BusinessCapability");
        if (constraint!=null) {
             constraint.preCreate(businessCapability);
        }

        EntityDetail entityDetail = BusinessCapabilityMapper.mapBusinessCapabilityToOmrsEntityDetail(businessCapability);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        BusinessCapability createdBusinessCapability =  BusinessCapabilityMapper.mapOmrsEntityDetailToBusinessCapability(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created BusinessCapability="+ createdBusinessCapability );
        }
        return createdBusinessCapability;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/businessCapabilities/guid/{businessCapabilityGuid}")
    public BusinessCapability updateBusinessCapability(@PathVariable String userId,@PathVariable String entityGuid, BusinessCapability businessCapability)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateBusinessCapabilityById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = BusinessCapabilityMapper.mapBusinessCapabilityToOmrsEntityDetail(businessCapability);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            BusinessCapability updatedBusinessCapability =  BusinessCapabilityMapper.mapOmrsEntityDetailToBusinessCapability(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated BusinessCapability="+ updatedBusinessCapability );
            }
            return updatedBusinessCapability;
        }

    /**
     * Delete an businessCapability identified by its GUID. Delete is a soft delete, this means that the businessCapability has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the businessCapability
     * @return BusinessCapability
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/businessCapabilities/guid/{businessCapabilityGuid}")

    public void deleteBusinessCapabilityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteBusinessCapabilityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeBusinessCapabilityByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeBusinessCapabilityByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied businessCapability
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/businessCapabilities/{businessCapabilityGuid}/classifications")
    public BusinessCapability addBusinessCapabilityClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addBusinessCapabilityClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         BusinessCapability businessCapabilityClassifications = BusinessCapabilityMapper.mapOmrsEntityDetailToBusinessCapability(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified BusinessCapability=" +  businessCapabilityClassifications);
         }
         return  businessCapabilityClassifications;
    }

    /**
     * Updates classifications to an existing businessCapability represented by a guid.
     * @param  entityGuid globally unique identifier for the businessCapability
     * @return classification for the given businessCapability guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/businessCapabilities/{businessCapabilityGuid}/classification")

    public BusinessCapability updateBusinessCapabilityClassification(@PathVariable("userId") String userId,@PathVariable("businessCapabilityGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateBusinessCapabilityClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           BusinessCapability  businessCapabilityClassifications = BusinessCapabilityMapper.mapOmrsEntityDetailToBusinessCapability(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  businessCapabilityClassifications;
    }

    /**
     * Deletes a given classification from an existing businessCapability represented by a guid.
     * @param entityGuid  globally unique identifier for the businessCapability
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/businessCapabilities/{businessCapabilityGuid}/classification/{name}")
    public BusinessCapability deleteBusinessCapabilityClassification(@PathVariable("userId") String userId,@PathVariable("businessCapabilityGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteBusinessCapabilityClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       BusinessCapability declassifiedBusinessCapability =  BusinessCapabilityMapper.mapOmrsEntityDetailToBusinessCapability(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedBusinessCapability;
    }

    /**
      * Get the relationships associated with entity businessCapability represented by a guid.
      * @param entityGuid  globally unique identifier for the businessCapability
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/businessCapabilities/guid/{entityGuid}/relationships")
    public List<Line> getBusinessCapabilityRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getBusinessCapabilityRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
    /**
     * Fetch complete definition of an schemaLinkElement given its GUID.
     * The limit and offset paging parameters limit the number elements returned in each of the schemaLinkElements relationships.
     * @param entityGuid GUID for the entity
     * @return SchemaLinkElement
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

 
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/schemaLinkElements/guid/{entityGuid}")
    public SchemaLinkElement getSchemaLinkElementById(@PathVariable String userId,@PathVariable String entityGuid)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException
    {
        final String methodName = "getSchemaLinkElementById";
        if (log.isDebugEnabled()) {
          log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
            
        SchemaLinkElement gotschemaLinkElement = SchemaLinkElementMapper.mapOmrsEntityDetailToSchemaLinkElement(omrsEntityDetail);
        if (log.isDebugEnabled()) {
         
             log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid+",entity="+ gotschemaLinkElement );
        }
        return gotschemaLinkElement;

    }
    /**
     * Create new schemaLinkElement in Atlas.
     * @param schemaLinkElement
     * @return SchemaLinkElement
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
     * exceptions on call
     * ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/schemaLinkElements")
    public SchemaLinkElement createSchemaLinkElement(@PathVariable String userId,SchemaLinkElement schemaLinkElement)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, StatusNotSupportedException, TypeException
    {

        final String methodName = "createSchemaLinkElementById";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId=" + userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        SubjectAreaConstraint constraint = SubjectAreaConstraintsFactory.getSubjectAreaConstraint("SchemaLinkElement");
        if (constraint!=null) {
             constraint.preCreate(schemaLinkElement);
        }

        EntityDetail entityDetail = SchemaLinkElementMapper.mapSchemaLinkElementToOmrsEntityDetail(schemaLinkElement);
        EntityDetail addedOMRSEntityDetail = oMRSAPIHelper.callOMRSAddEntity(userId,entityDetail);

        SchemaLinkElement createdSchemaLinkElement =  SchemaLinkElementMapper.mapOmrsEntityDetailToSchemaLinkElement(addedOMRSEntityDetail);
        if (log.isDebugEnabled()) {
              log.debug("<== successful method : " + methodName + ",userId="+userId+", created SchemaLinkElement="+ createdSchemaLinkElement );
        }
        return createdSchemaLinkElement;
    }

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/schemaLinkElements/guid/{schemaLinkElementGuid}")
    public SchemaLinkElement updateSchemaLinkElement(@PathVariable String userId,@PathVariable String entityGuid, SchemaLinkElement schemaLinkElement)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,UnrecognizedGUIDException
    {

            final String methodName = "updateSchemaLinkElementById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId=" + userId);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail entityDetail = SchemaLinkElementMapper.mapSchemaLinkElementToOmrsEntityDetail(schemaLinkElement);
            // TODO the type guid needs to be set in the supplied entityDetail

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSUpdateEntity(userId,entityDetail);

            SchemaLinkElement updatedSchemaLinkElement =  SchemaLinkElementMapper.mapOmrsEntityDetailToSchemaLinkElement(updatedOMRSEntityDetail);
            if (log.isDebugEnabled()) {
                    log.debug("<== successful method: " + methodName + ",userId=" + userId + ",updated SchemaLinkElement="+ updatedSchemaLinkElement );
            }
            return updatedSchemaLinkElement;
        }

    /**
     * Delete an schemaLinkElement identified by its GUID. Delete is a soft delete, this means that the schemaLinkElement has its status changed to
     * deleted. Soft deletion support os optional, so this call may fail. Soft deletes can be undone using the restore call.
     * If it is required that an entity is really deleted (a hard delete) then the purge call should be used.
     *
     * @param  entityGuid GUID for the schemaLinkElement
     * @return SchemaLinkElement
     */

    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/schemaLinkElements/guid/{schemaLinkElementGuid}")

    public void deleteSchemaLinkElementByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException,  FunctionNotSupportedException, InvalidParameterException, UnrecognizedGUIDException
    {
         final String methodName = "deleteSchemaLinkElementByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSDeleteEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    public void purgeSchemaLinkElementByGuid(@PathVariable String userId,@PathVariable final String entityGuid)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, EntityNotDeletedException, GUIDNotPurgedException {
        final String methodName = "purgeSchemaLinkElementByGuid";
         if (log.isDebugEnabled()) {
              log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);
         RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
         String typeName = omrsEntityDetail.getType().getTypeDefName();
         String typeGuid = omrsEntityDetail.getType().getTypeDefGUID();
         oMRSAPIHelper.callOMRSPurgeEntity(userId,typeName,typeGuid,entityGuid);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
    }

    /**
     * Add classifications to the supplied schemaLinkElement
     * @param entityGuid
     * @param classifications
     * @throws UserNotAuthorizedException, RepositoryErrorException, InvalidParameterException,
            // exceptions on call
            ConnectorCheckedException, ConnectionCheckedException, EntityProxyOnlyException
     */
    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/schemaLinkElements/{schemaLinkElementGuid}/classifications")
    public SchemaLinkElement addSchemaLinkElementClassifications(@PathVariable String userId,@PathVariable final String entityGuid, List<Classification> classifications)
           throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException, UnrecognizedGUIDException {
        final String methodName = "addSchemaLinkElementClassifications";
         if (log.isDebugEnabled()) {
             log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
         }
         RestValidator.validateUserIdNotNull(className,methodName,userId);


         for (Classification classification:classifications) {
             InstanceProperties instanceProperties = classification.obtainInstanceProperties();
             String name =classification.getClassificationName();
             RestValidator.validateNameNotNull(className,methodName,name,"classifications");
             oMRSAPIHelper.callOMRSClassifyEntity(userId,
                 entityGuid,
                 name,
                 instanceProperties);
         }

         EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

         SchemaLinkElement schemaLinkElementClassifications = SchemaLinkElementMapper.mapOmrsEntityDetailToSchemaLinkElement(omrsEntityDetail);
         if (log.isDebugEnabled()) {
             log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",classified SchemaLinkElement=" +  schemaLinkElementClassifications);
         }
         return  schemaLinkElementClassifications;
    }

    /**
     * Updates classifications to an existing schemaLinkElement represented by a guid.
     * @param  entityGuid globally unique identifier for the schemaLinkElement
     * @return classification for the given schemaLinkElement guid
     */

    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/schemaLinkElements/{schemaLinkElementGuid}/classification")

    public SchemaLinkElement updateSchemaLinkElementClassification(@PathVariable("userId") String userId,@PathVariable("schemaLinkElementGuid") final String entityGuid, List<Classification> classificationsToUpdate)
        throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

        final String methodName = "updateSchemaLinkElementClassifications";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

            EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);

            List<String> existingClassificationNames = new ArrayList();
            for (org.odpi.openmetadata.repositoryservices.connectors.stores.metadatacollectionstore.properties.instances.Classification existingClassification:omrsEntityDetail.getClassifications()) {
                 String name = existingClassification.getName();
            }
            for (Classification classification:classificationsToUpdate) {
                 String name = classification.getClassificationName();
                 // Only allow updates of classifications that already exist.
                 if (!existingClassificationNames.contains(name)) {
                     SubjectAreaErrorCode errorCode = SubjectAreaErrorCode.UPDATE_REQUESTED_ON_A_NON_EXISTENT_CLASSIFICATION;
                     String errorMessage = errorCode.getErrorMessageId()
                            + errorCode.getFormattedErrorMessage(
                               name,
                              "classificationsToUpdate",
                              methodName,
                             entityGuid
                             );
                      log.error(errorMessage);
                      throw new InvalidParameterException(errorCode.getHTTPErrorCode(),
                                          className,
                                          methodName,
                                          errorMessage,
                                          errorCode.getSystemAction(),
                                          errorCode.getUserAction());
                 }
            }
            for (Classification classification:classificationsToUpdate) {
                 InstanceProperties instanceProperties = classification.obtainInstanceProperties();
                 String name =classification.getClassificationName();
                 //remove existing classification
                 oMRSAPIHelper.callOMRSDeClassifyEntity(userId,
                     entityGuid,
                     name);
                 // re-add with the new properties.
                 oMRSAPIHelper.callOMRSClassifyEntity(userId,
                     entityGuid,
                     name,
                     instanceProperties);
            }

            EntityDetail updatedOMRSEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
           SchemaLinkElement  schemaLinkElementClassifications = SchemaLinkElementMapper.mapOmrsEntityDetailToSchemaLinkElement(updatedOMRSEntityDetail);

            if (log.isDebugEnabled()) {
                   log.debug("<== Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
            }
             return  schemaLinkElementClassifications;
    }

    /**
     * Deletes a given classification from an existing schemaLinkElement represented by a guid.
     * @param entityGuid  globally unique identifier for the schemaLinkElement
     * @param name name of the classification
     */
    @RequestMapping(method = RequestMethod.DELETE, path = "users/{userId}/schemaLinkElements/{schemaLinkElementGuid}/classification/{name}")
    public SchemaLinkElement deleteSchemaLinkElementClassification(@PathVariable("userId") String userId,@PathVariable("schemaLinkElementGuid") String entityGuid,
            @PathVariable("name") final String name)
        throws PropertyServerException, UserNotAuthorizedException, org.odpi.openmetadata.accessservices.subjectarea.ffdc.exceptions.InvalidParameterException, ClassificationException,  UnrecognizedGUIDException {

       final String methodName = "deleteSchemaLinkElementClassification";
       if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       RestValidator.validateUserIdNotNull(className,methodName,userId);
       RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");


       oMRSAPIHelper.callOMRSDeClassifyEntity(userId, entityGuid,name);
       EntityDetail omrsEntityDetail = oMRSAPIHelper.callOMRSGetEntityByGuid(userId,entityGuid);
       SchemaLinkElement declassifiedSchemaLinkElement =  SchemaLinkElementMapper.mapOmrsEntityDetailToSchemaLinkElement(omrsEntityDetail);
       if (log.isDebugEnabled()) {
           log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+entityGuid+",name="+name);
       }
       return declassifiedSchemaLinkElement;
    }

    /**
      * Get the relationships associated with entity schemaLinkElement represented by a guid.
      * @param entityGuid  globally unique identifier for the schemaLinkElement
      */
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/schemaLinkElements/guid/{entityGuid}/relationships")
    public List<Line> getSchemaLinkElementRelationships(@PathVariable String userId,@PathVariable String entityGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, TypeException, FunctionNotSupportedException, PagingException, UnrecognizedGUIDException {
        final String methodName = "getSchemaLinkElementRelationships";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);
        RestValidator.validateGUIDNotNull(className,methodName,entityGuid,"entityGuid");

        List<Line> lines = new ArrayList<>();

        List<Relationship> omrsRelationships = oMRSAPIHelper.callGetRelationshipsForEntity( userId,entityGuid);
        for (Relationship omrsRelationship:omrsRelationships){
           String name = omrsRelationship.getType().getTypeDefName();
            if (name.equals("AcceptedAnswer")) {
                AcceptedAnswer acceptedAnswer= AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(omrsRelationship);
                lines.add(acceptedAnswer);
            }
        }
        if (log.isDebugEnabled()) {
            log.debug("<== successful method : " + methodName + ",userId="+userId+",guid="+entityGuid);
        }
        return lines;
    }
     // Relationships


    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/usedInContexts")

    public UsedInContext createUsedInContextRelationship(@PathVariable("userId") String userId,UsedInContext relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createUsedInContextRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = UsedInContextMapper.mapUsedInContextToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        UsedInContext reclassifiedUsedInContext =  UsedInContextMapper.mapOmrsRelationshipToUsedInContext(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedUsedInContext;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/usedInContexts")

    public UsedInContext getUsedInContextRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getUsedInContextRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            UsedInContext gotUsedInContext = UsedInContextMapper.mapOmrsRelationshipToUsedInContext(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotUsedInContext;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/usedInContexts")
    public UsedInContext updateUsedInContextRelationship(@PathVariable("userId") String userId,UsedInContext usedInContext)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateUsedInContextRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = UsedInContextMapper.mapUsedInContextToOmrsRelationship(usedInContext);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        UsedInContext updatedUsedInContext = UsedInContextMapper.mapOmrsRelationshipToUsedInContext(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedUsedInContext;
    }

     public void deleteUsedInContextRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteUsedInContextRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("UsedInContext")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type usedInContext
             }
     }
     public void purgeUsedInContextRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeUsedInContextRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("UsedInContext")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type usedInContext
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/leaderships")

    public Leadership createLeadershipRelationship(@PathVariable("userId") String userId,Leadership relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createLeadershipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = LeadershipMapper.mapLeadershipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Leadership reclassifiedLeadership =  LeadershipMapper.mapOmrsRelationshipToLeadership(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedLeadership;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/leaderships")

    public Leadership getLeadershipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getLeadershipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Leadership gotLeadership = LeadershipMapper.mapOmrsRelationshipToLeadership(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotLeadership;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/leaderships")
    public Leadership updateLeadershipRelationship(@PathVariable("userId") String userId,Leadership leadership)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateLeadershipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = LeadershipMapper.mapLeadershipToOmrsRelationship(leadership);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Leadership updatedLeadership = LeadershipMapper.mapOmrsRelationshipToLeadership(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedLeadership;
    }

     public void deleteLeadershipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteLeadershipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Leadership")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type leadership
             }
     }
     public void purgeLeadershipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeLeadershipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Leadership")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type leadership
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attachedComments")

    public AttachedComment createAttachedCommentRelationship(@PathVariable("userId") String userId,AttachedComment relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttachedCommentRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttachedCommentMapper.mapAttachedCommentToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttachedComment reclassifiedAttachedComment =  AttachedCommentMapper.mapOmrsRelationshipToAttachedComment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttachedComment;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attachedComments")

    public AttachedComment getAttachedCommentRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttachedCommentRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttachedComment gotAttachedComment = AttachedCommentMapper.mapOmrsRelationshipToAttachedComment(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttachedComment;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attachedComments")
    public AttachedComment updateAttachedCommentRelationship(@PathVariable("userId") String userId,AttachedComment attachedComment)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttachedCommentRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttachedCommentMapper.mapAttachedCommentToOmrsRelationship(attachedComment);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttachedComment updatedAttachedComment = AttachedCommentMapper.mapOmrsRelationshipToAttachedComment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttachedComment;
    }

     public void deleteAttachedCommentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttachedCommentRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttachedComment")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attachedComment
             }
     }
     public void purgeAttachedCommentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttachedCommentRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttachedComment")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attachedComment
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/contactThroughs")

    public ContactThrough createContactThroughRelationship(@PathVariable("userId") String userId,ContactThrough relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createContactThroughRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ContactThroughMapper.mapContactThroughToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ContactThrough reclassifiedContactThrough =  ContactThroughMapper.mapOmrsRelationshipToContactThrough(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedContactThrough;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/contactThroughs")

    public ContactThrough getContactThroughRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getContactThroughRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ContactThrough gotContactThrough = ContactThroughMapper.mapOmrsRelationshipToContactThrough(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotContactThrough;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/contactThroughs")
    public ContactThrough updateContactThroughRelationship(@PathVariable("userId") String userId,ContactThrough contactThrough)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateContactThroughRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ContactThroughMapper.mapContactThroughToOmrsRelationship(contactThrough);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ContactThrough updatedContactThrough = ContactThroughMapper.mapOmrsRelationshipToContactThrough(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedContactThrough;
    }

     public void deleteContactThroughRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteContactThroughRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ContactThrough")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type contactThrough
             }
     }
     public void purgeContactThroughRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeContactThroughRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ContactThrough")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type contactThrough
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/licenses")

    public License createLicenseRelationship(@PathVariable("userId") String userId,License relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createLicenseRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = LicenseMapper.mapLicenseToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        License reclassifiedLicense =  LicenseMapper.mapOmrsRelationshipToLicense(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedLicense;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/licenses")

    public License getLicenseRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getLicenseRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            License gotLicense = LicenseMapper.mapOmrsRelationshipToLicense(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotLicense;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/licenses")
    public License updateLicenseRelationship(@PathVariable("userId") String userId,License license)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateLicenseRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = LicenseMapper.mapLicenseToOmrsRelationship(license);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        License updatedLicense = LicenseMapper.mapOmrsRelationshipToLicense(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedLicense;
    }

     public void deleteLicenseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteLicenseRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("License")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type license
             }
     }
     public void purgeLicenseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeLicenseRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("License")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type license
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/zoneGovernances")

    public ZoneGovernance createZoneGovernanceRelationship(@PathVariable("userId") String userId,ZoneGovernance relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createZoneGovernanceRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ZoneGovernanceMapper.mapZoneGovernanceToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ZoneGovernance reclassifiedZoneGovernance =  ZoneGovernanceMapper.mapOmrsRelationshipToZoneGovernance(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedZoneGovernance;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/zoneGovernances")

    public ZoneGovernance getZoneGovernanceRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getZoneGovernanceRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ZoneGovernance gotZoneGovernance = ZoneGovernanceMapper.mapOmrsRelationshipToZoneGovernance(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotZoneGovernance;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/zoneGovernances")
    public ZoneGovernance updateZoneGovernanceRelationship(@PathVariable("userId") String userId,ZoneGovernance zoneGovernance)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateZoneGovernanceRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ZoneGovernanceMapper.mapZoneGovernanceToOmrsRelationship(zoneGovernance);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ZoneGovernance updatedZoneGovernance = ZoneGovernanceMapper.mapOmrsRelationshipToZoneGovernance(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedZoneGovernance;
    }

     public void deleteZoneGovernanceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteZoneGovernanceRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ZoneGovernance")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type zoneGovernance
             }
     }
     public void purgeZoneGovernanceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeZoneGovernanceRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ZoneGovernance")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type zoneGovernance
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/folderHierarchies")

    public FolderHierarchy createFolderHierarchyRelationship(@PathVariable("userId") String userId,FolderHierarchy relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createFolderHierarchyRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = FolderHierarchyMapper.mapFolderHierarchyToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        FolderHierarchy reclassifiedFolderHierarchy =  FolderHierarchyMapper.mapOmrsRelationshipToFolderHierarchy(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedFolderHierarchy;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/folderHierarchies")

    public FolderHierarchy getFolderHierarchyRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getFolderHierarchyRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            FolderHierarchy gotFolderHierarchy = FolderHierarchyMapper.mapOmrsRelationshipToFolderHierarchy(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotFolderHierarchy;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/folderHierarchies")
    public FolderHierarchy updateFolderHierarchyRelationship(@PathVariable("userId") String userId,FolderHierarchy folderHierarchy)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateFolderHierarchyRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = FolderHierarchyMapper.mapFolderHierarchyToOmrsRelationship(folderHierarchy);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        FolderHierarchy updatedFolderHierarchy = FolderHierarchyMapper.mapOmrsRelationshipToFolderHierarchy(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedFolderHierarchy;
    }

     public void deleteFolderHierarchyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteFolderHierarchyRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("FolderHierarchy")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type folderHierarchy
             }
     }
     public void purgeFolderHierarchyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeFolderHierarchyRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("FolderHierarchy")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type folderHierarchy
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/hostClusterMembers")

    public HostClusterMember createHostClusterMemberRelationship(@PathVariable("userId") String userId,HostClusterMember relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createHostClusterMemberRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = HostClusterMemberMapper.mapHostClusterMemberToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        HostClusterMember reclassifiedHostClusterMember =  HostClusterMemberMapper.mapOmrsRelationshipToHostClusterMember(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedHostClusterMember;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/hostClusterMembers")

    public HostClusterMember getHostClusterMemberRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getHostClusterMemberRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            HostClusterMember gotHostClusterMember = HostClusterMemberMapper.mapOmrsRelationshipToHostClusterMember(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotHostClusterMember;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/hostClusterMembers")
    public HostClusterMember updateHostClusterMemberRelationship(@PathVariable("userId") String userId,HostClusterMember hostClusterMember)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateHostClusterMemberRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = HostClusterMemberMapper.mapHostClusterMemberToOmrsRelationship(hostClusterMember);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        HostClusterMember updatedHostClusterMember = HostClusterMemberMapper.mapOmrsRelationshipToHostClusterMember(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedHostClusterMember;
    }

     public void deleteHostClusterMemberRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteHostClusterMemberRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("HostClusterMember")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type hostClusterMember
             }
     }
     public void purgeHostClusterMemberRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeHostClusterMemberRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("HostClusterMember")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type hostClusterMember
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/libraryCategoryReferences")

    public LibraryCategoryReference createLibraryCategoryReferenceRelationship(@PathVariable("userId") String userId,LibraryCategoryReference relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createLibraryCategoryReferenceRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = LibraryCategoryReferenceMapper.mapLibraryCategoryReferenceToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        LibraryCategoryReference reclassifiedLibraryCategoryReference =  LibraryCategoryReferenceMapper.mapOmrsRelationshipToLibraryCategoryReference(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedLibraryCategoryReference;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/libraryCategoryReferences")

    public LibraryCategoryReference getLibraryCategoryReferenceRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getLibraryCategoryReferenceRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            LibraryCategoryReference gotLibraryCategoryReference = LibraryCategoryReferenceMapper.mapOmrsRelationshipToLibraryCategoryReference(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotLibraryCategoryReference;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/libraryCategoryReferences")
    public LibraryCategoryReference updateLibraryCategoryReferenceRelationship(@PathVariable("userId") String userId,LibraryCategoryReference libraryCategoryReference)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateLibraryCategoryReferenceRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = LibraryCategoryReferenceMapper.mapLibraryCategoryReferenceToOmrsRelationship(libraryCategoryReference);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        LibraryCategoryReference updatedLibraryCategoryReference = LibraryCategoryReferenceMapper.mapOmrsRelationshipToLibraryCategoryReference(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedLibraryCategoryReference;
    }

     public void deleteLibraryCategoryReferenceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteLibraryCategoryReferenceRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("LibraryCategoryReference")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type libraryCategoryReference
             }
     }
     public void purgeLibraryCategoryReferenceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeLibraryCategoryReferenceRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("LibraryCategoryReference")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type libraryCategoryReference
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectCharterLinks")

    public ProjectCharterLink createProjectCharterLinkRelationship(@PathVariable("userId") String userId,ProjectCharterLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectCharterLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectCharterLinkMapper.mapProjectCharterLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectCharterLink reclassifiedProjectCharterLink =  ProjectCharterLinkMapper.mapOmrsRelationshipToProjectCharterLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectCharterLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectCharterLinks")

    public ProjectCharterLink getProjectCharterLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectCharterLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectCharterLink gotProjectCharterLink = ProjectCharterLinkMapper.mapOmrsRelationshipToProjectCharterLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectCharterLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectCharterLinks")
    public ProjectCharterLink updateProjectCharterLinkRelationship(@PathVariable("userId") String userId,ProjectCharterLink projectCharterLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectCharterLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectCharterLinkMapper.mapProjectCharterLinkToOmrsRelationship(projectCharterLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectCharterLink updatedProjectCharterLink = ProjectCharterLinkMapper.mapOmrsRelationshipToProjectCharterLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectCharterLink;
    }

     public void deleteProjectCharterLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectCharterLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectCharterLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectCharterLink
             }
     }
     public void purgeProjectCharterLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectCharterLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectCharterLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectCharterLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/profileIdentities")

    public ProfileIdentity createProfileIdentityRelationship(@PathVariable("userId") String userId,ProfileIdentity relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProfileIdentityRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProfileIdentityMapper.mapProfileIdentityToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProfileIdentity reclassifiedProfileIdentity =  ProfileIdentityMapper.mapOmrsRelationshipToProfileIdentity(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProfileIdentity;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/profileIdentities")

    public ProfileIdentity getProfileIdentityRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProfileIdentityRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProfileIdentity gotProfileIdentity = ProfileIdentityMapper.mapOmrsRelationshipToProfileIdentity(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProfileIdentity;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/profileIdentities")
    public ProfileIdentity updateProfileIdentityRelationship(@PathVariable("userId") String userId,ProfileIdentity profileIdentity)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProfileIdentityRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProfileIdentityMapper.mapProfileIdentityToOmrsRelationship(profileIdentity);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProfileIdentity updatedProfileIdentity = ProfileIdentityMapper.mapOmrsRelationshipToProfileIdentity(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProfileIdentity;
    }

     public void deleteProfileIdentityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProfileIdentityRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProfileIdentity")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type profileIdentity
             }
     }
     public void purgeProfileIdentityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProfileIdentityRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProfileIdentity")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type profileIdentity
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/toDoSources")

    public ToDoSource createToDoSourceRelationship(@PathVariable("userId") String userId,ToDoSource relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createToDoSourceRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ToDoSourceMapper.mapToDoSourceToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ToDoSource reclassifiedToDoSource =  ToDoSourceMapper.mapOmrsRelationshipToToDoSource(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedToDoSource;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/toDoSources")

    public ToDoSource getToDoSourceRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getToDoSourceRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ToDoSource gotToDoSource = ToDoSourceMapper.mapOmrsRelationshipToToDoSource(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotToDoSource;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/toDoSources")
    public ToDoSource updateToDoSourceRelationship(@PathVariable("userId") String userId,ToDoSource toDoSource)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateToDoSourceRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ToDoSourceMapper.mapToDoSourceToOmrsRelationship(toDoSource);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ToDoSource updatedToDoSource = ToDoSourceMapper.mapOmrsRelationshipToToDoSource(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedToDoSource;
    }

     public void deleteToDoSourceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteToDoSourceRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ToDoSource")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type toDoSource
             }
     }
     public void purgeToDoSourceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeToDoSourceRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ToDoSource")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type toDoSource
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/translations")

    public Translation createTranslationRelationship(@PathVariable("userId") String userId,Translation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTranslationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TranslationMapper.mapTranslationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Translation reclassifiedTranslation =  TranslationMapper.mapOmrsRelationshipToTranslation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTranslation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/translations")

    public Translation getTranslationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTranslationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Translation gotTranslation = TranslationMapper.mapOmrsRelationshipToTranslation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTranslation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/translations")
    public Translation updateTranslationRelationship(@PathVariable("userId") String userId,Translation translation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTranslationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TranslationMapper.mapTranslationToOmrsRelationship(translation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Translation updatedTranslation = TranslationMapper.mapOmrsRelationshipToTranslation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTranslation;
    }

     public void deleteTranslationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTranslationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Translation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type translation
             }
     }
     public void purgeTranslationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTranslationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Translation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type translation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/schemaLinkToTypes")

    public SchemaLinkToType createSchemaLinkToTypeRelationship(@PathVariable("userId") String userId,SchemaLinkToType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSchemaLinkToTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SchemaLinkToTypeMapper.mapSchemaLinkToTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        SchemaLinkToType reclassifiedSchemaLinkToType =  SchemaLinkToTypeMapper.mapOmrsRelationshipToSchemaLinkToType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSchemaLinkToType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/schemaLinkToTypes")

    public SchemaLinkToType getSchemaLinkToTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSchemaLinkToTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            SchemaLinkToType gotSchemaLinkToType = SchemaLinkToTypeMapper.mapOmrsRelationshipToSchemaLinkToType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSchemaLinkToType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/schemaLinkToTypes")
    public SchemaLinkToType updateSchemaLinkToTypeRelationship(@PathVariable("userId") String userId,SchemaLinkToType schemaLinkToType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSchemaLinkToTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SchemaLinkToTypeMapper.mapSchemaLinkToTypeToOmrsRelationship(schemaLinkToType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        SchemaLinkToType updatedSchemaLinkToType = SchemaLinkToTypeMapper.mapOmrsRelationshipToSchemaLinkToType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSchemaLinkToType;
    }

     public void deleteSchemaLinkToTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSchemaLinkToTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("SchemaLinkToType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type schemaLinkToType
             }
     }
     public void purgeSchemaLinkToTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSchemaLinkToTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("SchemaLinkToType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type schemaLinkToType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/communityResourceses")

    public CommunityResources createCommunityResourcesRelationship(@PathVariable("userId") String userId,CommunityResources relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCommunityResourcesRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CommunityResourcesMapper.mapCommunityResourcesToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        CommunityResources reclassifiedCommunityResources =  CommunityResourcesMapper.mapOmrsRelationshipToCommunityResources(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCommunityResources;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/communityResourceses")

    public CommunityResources getCommunityResourcesRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCommunityResourcesRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            CommunityResources gotCommunityResources = CommunityResourcesMapper.mapOmrsRelationshipToCommunityResources(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCommunityResources;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/communityResourceses")
    public CommunityResources updateCommunityResourcesRelationship(@PathVariable("userId") String userId,CommunityResources communityResources)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCommunityResourcesRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CommunityResourcesMapper.mapCommunityResourcesToOmrsRelationship(communityResources);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        CommunityResources updatedCommunityResources = CommunityResourcesMapper.mapOmrsRelationshipToCommunityResources(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCommunityResources;
    }

     public void deleteCommunityResourcesRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCommunityResourcesRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("CommunityResources")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type communityResources
             }
     }
     public void purgeCommunityResourcesRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCommunityResourcesRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("CommunityResources")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type communityResources
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/dataContentForDataSets")

    public DataContentForDataSet createDataContentForDataSetRelationship(@PathVariable("userId") String userId,DataContentForDataSet relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createDataContentForDataSetRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = DataContentForDataSetMapper.mapDataContentForDataSetToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        DataContentForDataSet reclassifiedDataContentForDataSet =  DataContentForDataSetMapper.mapOmrsRelationshipToDataContentForDataSet(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedDataContentForDataSet;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/dataContentForDataSets")

    public DataContentForDataSet getDataContentForDataSetRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getDataContentForDataSetRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            DataContentForDataSet gotDataContentForDataSet = DataContentForDataSetMapper.mapOmrsRelationshipToDataContentForDataSet(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotDataContentForDataSet;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/dataContentForDataSets")
    public DataContentForDataSet updateDataContentForDataSetRelationship(@PathVariable("userId") String userId,DataContentForDataSet dataContentForDataSet)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateDataContentForDataSetRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = DataContentForDataSetMapper.mapDataContentForDataSetToOmrsRelationship(dataContentForDataSet);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        DataContentForDataSet updatedDataContentForDataSet = DataContentForDataSetMapper.mapOmrsRelationshipToDataContentForDataSet(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedDataContentForDataSet;
    }

     public void deleteDataContentForDataSetRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteDataContentForDataSetRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("DataContentForDataSet")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type dataContentForDataSet
             }
     }
     public void purgeDataContentForDataSetRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeDataContentForDataSetRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("DataContentForDataSet")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type dataContentForDataSet
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/serverEndpoints")

    public ServerEndpoint createServerEndpointRelationship(@PathVariable("userId") String userId,ServerEndpoint relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createServerEndpointRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ServerEndpointMapper.mapServerEndpointToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ServerEndpoint reclassifiedServerEndpoint =  ServerEndpointMapper.mapOmrsRelationshipToServerEndpoint(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedServerEndpoint;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/serverEndpoints")

    public ServerEndpoint getServerEndpointRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getServerEndpointRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ServerEndpoint gotServerEndpoint = ServerEndpointMapper.mapOmrsRelationshipToServerEndpoint(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotServerEndpoint;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/serverEndpoints")
    public ServerEndpoint updateServerEndpointRelationship(@PathVariable("userId") String userId,ServerEndpoint serverEndpoint)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateServerEndpointRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ServerEndpointMapper.mapServerEndpointToOmrsRelationship(serverEndpoint);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ServerEndpoint updatedServerEndpoint = ServerEndpointMapper.mapOmrsRelationshipToServerEndpoint(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedServerEndpoint;
    }

     public void deleteServerEndpointRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteServerEndpointRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ServerEndpoint")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type serverEndpoint
             }
     }
     public void purgeServerEndpointRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeServerEndpointRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ServerEndpoint")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type serverEndpoint
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/externalIdLinks")

    public ExternalIdLink createExternalIdLinkRelationship(@PathVariable("userId") String userId,ExternalIdLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createExternalIdLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ExternalIdLinkMapper.mapExternalIdLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ExternalIdLink reclassifiedExternalIdLink =  ExternalIdLinkMapper.mapOmrsRelationshipToExternalIdLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedExternalIdLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/externalIdLinks")

    public ExternalIdLink getExternalIdLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getExternalIdLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ExternalIdLink gotExternalIdLink = ExternalIdLinkMapper.mapOmrsRelationshipToExternalIdLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotExternalIdLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/externalIdLinks")
    public ExternalIdLink updateExternalIdLinkRelationship(@PathVariable("userId") String userId,ExternalIdLink externalIdLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateExternalIdLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ExternalIdLinkMapper.mapExternalIdLinkToOmrsRelationship(externalIdLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ExternalIdLink updatedExternalIdLink = ExternalIdLinkMapper.mapOmrsRelationshipToExternalIdLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedExternalIdLink;
    }

     public void deleteExternalIdLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteExternalIdLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ExternalIdLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type externalIdLink
             }
     }
     public void purgeExternalIdLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeExternalIdLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ExternalIdLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type externalIdLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/categoryHierarchyLinks")

    public CategoryHierarchyLink createCategoryHierarchyLinkRelationship(@PathVariable("userId") String userId,CategoryHierarchyLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCategoryHierarchyLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CategoryHierarchyLinkMapper.mapCategoryHierarchyLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        CategoryHierarchyLink reclassifiedCategoryHierarchyLink =  CategoryHierarchyLinkMapper.mapOmrsRelationshipToCategoryHierarchyLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCategoryHierarchyLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/categoryHierarchyLinks")

    public CategoryHierarchyLink getCategoryHierarchyLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCategoryHierarchyLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            CategoryHierarchyLink gotCategoryHierarchyLink = CategoryHierarchyLinkMapper.mapOmrsRelationshipToCategoryHierarchyLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCategoryHierarchyLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/categoryHierarchyLinks")
    public CategoryHierarchyLink updateCategoryHierarchyLinkRelationship(@PathVariable("userId") String userId,CategoryHierarchyLink categoryHierarchyLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCategoryHierarchyLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CategoryHierarchyLinkMapper.mapCategoryHierarchyLinkToOmrsRelationship(categoryHierarchyLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        CategoryHierarchyLink updatedCategoryHierarchyLink = CategoryHierarchyLinkMapper.mapOmrsRelationshipToCategoryHierarchyLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCategoryHierarchyLink;
    }

     public void deleteCategoryHierarchyLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCategoryHierarchyLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("CategoryHierarchyLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type categoryHierarchyLink
             }
     }
     public void purgeCategoryHierarchyLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCategoryHierarchyLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("CategoryHierarchyLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type categoryHierarchyLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/preferredTerms")

    public PreferredTerm createPreferredTermRelationship(@PathVariable("userId") String userId,PreferredTerm relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createPreferredTermRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = PreferredTermMapper.mapPreferredTermToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        PreferredTerm reclassifiedPreferredTerm =  PreferredTermMapper.mapOmrsRelationshipToPreferredTerm(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedPreferredTerm;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/preferredTerms")

    public PreferredTerm getPreferredTermRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getPreferredTermRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            PreferredTerm gotPreferredTerm = PreferredTermMapper.mapOmrsRelationshipToPreferredTerm(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotPreferredTerm;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/preferredTerms")
    public PreferredTerm updatePreferredTermRelationship(@PathVariable("userId") String userId,PreferredTerm preferredTerm)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updatePreferredTermRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = PreferredTermMapper.mapPreferredTermToOmrsRelationship(preferredTerm);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        PreferredTerm updatedPreferredTerm = PreferredTermMapper.mapOmrsRelationshipToPreferredTerm(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedPreferredTerm;
    }

     public void deletePreferredTermRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deletePreferredTermRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("PreferredTerm")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type preferredTerm
             }
     }
     public void purgePreferredTermRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgePreferredTermRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("PreferredTerm")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type preferredTerm
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectHierarchies")

    public ProjectHierarchy createProjectHierarchyRelationship(@PathVariable("userId") String userId,ProjectHierarchy relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectHierarchyRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectHierarchyMapper.mapProjectHierarchyToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectHierarchy reclassifiedProjectHierarchy =  ProjectHierarchyMapper.mapOmrsRelationshipToProjectHierarchy(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectHierarchy;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectHierarchies")

    public ProjectHierarchy getProjectHierarchyRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectHierarchyRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectHierarchy gotProjectHierarchy = ProjectHierarchyMapper.mapOmrsRelationshipToProjectHierarchy(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectHierarchy;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectHierarchies")
    public ProjectHierarchy updateProjectHierarchyRelationship(@PathVariable("userId") String userId,ProjectHierarchy projectHierarchy)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectHierarchyRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectHierarchyMapper.mapProjectHierarchyToOmrsRelationship(projectHierarchy);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectHierarchy updatedProjectHierarchy = ProjectHierarchyMapper.mapOmrsRelationshipToProjectHierarchy(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectHierarchy;
    }

     public void deleteProjectHierarchyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectHierarchyRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectHierarchy")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectHierarchy
             }
     }
     public void purgeProjectHierarchyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectHierarchyRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectHierarchy")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectHierarchy
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/deployedVirtualContainers")

    public DeployedVirtualContainer createDeployedVirtualContainerRelationship(@PathVariable("userId") String userId,DeployedVirtualContainer relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createDeployedVirtualContainerRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = DeployedVirtualContainerMapper.mapDeployedVirtualContainerToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        DeployedVirtualContainer reclassifiedDeployedVirtualContainer =  DeployedVirtualContainerMapper.mapOmrsRelationshipToDeployedVirtualContainer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedDeployedVirtualContainer;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/deployedVirtualContainers")

    public DeployedVirtualContainer getDeployedVirtualContainerRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getDeployedVirtualContainerRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            DeployedVirtualContainer gotDeployedVirtualContainer = DeployedVirtualContainerMapper.mapOmrsRelationshipToDeployedVirtualContainer(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotDeployedVirtualContainer;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/deployedVirtualContainers")
    public DeployedVirtualContainer updateDeployedVirtualContainerRelationship(@PathVariable("userId") String userId,DeployedVirtualContainer deployedVirtualContainer)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateDeployedVirtualContainerRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = DeployedVirtualContainerMapper.mapDeployedVirtualContainerToOmrsRelationship(deployedVirtualContainer);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        DeployedVirtualContainer updatedDeployedVirtualContainer = DeployedVirtualContainerMapper.mapOmrsRelationshipToDeployedVirtualContainer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedDeployedVirtualContainer;
    }

     public void deleteDeployedVirtualContainerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteDeployedVirtualContainerRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("DeployedVirtualContainer")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type deployedVirtualContainer
             }
     }
     public void purgeDeployedVirtualContainerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeDeployedVirtualContainerRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("DeployedVirtualContainer")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type deployedVirtualContainer
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/businessCapabilityResponsibilities")

    public BusinessCapabilityResponsibility createBusinessCapabilityResponsibilityRelationship(@PathVariable("userId") String userId,BusinessCapabilityResponsibility relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createBusinessCapabilityResponsibilityRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = BusinessCapabilityResponsibilityMapper.mapBusinessCapabilityResponsibilityToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        BusinessCapabilityResponsibility reclassifiedBusinessCapabilityResponsibility =  BusinessCapabilityResponsibilityMapper.mapOmrsRelationshipToBusinessCapabilityResponsibility(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedBusinessCapabilityResponsibility;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/businessCapabilityResponsibilities")

    public BusinessCapabilityResponsibility getBusinessCapabilityResponsibilityRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getBusinessCapabilityResponsibilityRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            BusinessCapabilityResponsibility gotBusinessCapabilityResponsibility = BusinessCapabilityResponsibilityMapper.mapOmrsRelationshipToBusinessCapabilityResponsibility(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotBusinessCapabilityResponsibility;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/businessCapabilityResponsibilities")
    public BusinessCapabilityResponsibility updateBusinessCapabilityResponsibilityRelationship(@PathVariable("userId") String userId,BusinessCapabilityResponsibility businessCapabilityResponsibility)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateBusinessCapabilityResponsibilityRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = BusinessCapabilityResponsibilityMapper.mapBusinessCapabilityResponsibilityToOmrsRelationship(businessCapabilityResponsibility);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        BusinessCapabilityResponsibility updatedBusinessCapabilityResponsibility = BusinessCapabilityResponsibilityMapper.mapOmrsRelationshipToBusinessCapabilityResponsibility(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedBusinessCapabilityResponsibility;
    }

     public void deleteBusinessCapabilityResponsibilityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteBusinessCapabilityResponsibilityRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("BusinessCapabilityResponsibility")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type businessCapabilityResponsibility
             }
     }
     public void purgeBusinessCapabilityResponsibilityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeBusinessCapabilityResponsibilityRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("BusinessCapabilityResponsibility")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type businessCapabilityResponsibility
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectMeetings")

    public ProjectMeeting createProjectMeetingRelationship(@PathVariable("userId") String userId,ProjectMeeting relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectMeetingRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectMeetingMapper.mapProjectMeetingToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectMeeting reclassifiedProjectMeeting =  ProjectMeetingMapper.mapOmrsRelationshipToProjectMeeting(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectMeeting;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectMeetings")

    public ProjectMeeting getProjectMeetingRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectMeetingRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectMeeting gotProjectMeeting = ProjectMeetingMapper.mapOmrsRelationshipToProjectMeeting(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectMeeting;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectMeetings")
    public ProjectMeeting updateProjectMeetingRelationship(@PathVariable("userId") String userId,ProjectMeeting projectMeeting)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectMeetingRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectMeetingMapper.mapProjectMeetingToOmrsRelationship(projectMeeting);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectMeeting updatedProjectMeeting = ProjectMeetingMapper.mapOmrsRelationshipToProjectMeeting(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectMeeting;
    }

     public void deleteProjectMeetingRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectMeetingRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectMeeting")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectMeeting
             }
     }
     public void purgeProjectMeetingRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectMeetingRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectMeeting")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectMeeting
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceResultses")

    public GovernanceResults createGovernanceResultsRelationship(@PathVariable("userId") String userId,GovernanceResults relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceResultsRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceResultsMapper.mapGovernanceResultsToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceResults reclassifiedGovernanceResults =  GovernanceResultsMapper.mapOmrsRelationshipToGovernanceResults(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceResults;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceResultses")

    public GovernanceResults getGovernanceResultsRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceResultsRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceResults gotGovernanceResults = GovernanceResultsMapper.mapOmrsRelationshipToGovernanceResults(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceResults;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceResultses")
    public GovernanceResults updateGovernanceResultsRelationship(@PathVariable("userId") String userId,GovernanceResults governanceResults)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceResultsRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceResultsMapper.mapGovernanceResultsToOmrsRelationship(governanceResults);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceResults updatedGovernanceResults = GovernanceResultsMapper.mapOmrsRelationshipToGovernanceResults(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceResults;
    }

     public void deleteGovernanceResultsRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceResultsRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceResults")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceResults
             }
     }
     public void purgeGovernanceResultsRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceResultsRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceResults")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceResults
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/aPIResponses")

    public APIResponse createAPIResponseRelationship(@PathVariable("userId") String userId,APIResponse relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAPIResponseRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = APIResponseMapper.mapAPIResponseToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        APIResponse reclassifiedAPIResponse =  APIResponseMapper.mapOmrsRelationshipToAPIResponse(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAPIResponse;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/aPIResponses")

    public APIResponse getAPIResponseRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAPIResponseRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            APIResponse gotAPIResponse = APIResponseMapper.mapOmrsRelationshipToAPIResponse(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAPIResponse;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/aPIResponses")
    public APIResponse updateAPIResponseRelationship(@PathVariable("userId") String userId,APIResponse aPIResponse)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAPIResponseRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = APIResponseMapper.mapAPIResponseToOmrsRelationship(aPIResponse);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        APIResponse updatedAPIResponse = APIResponseMapper.mapOmrsRelationshipToAPIResponse(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAPIResponse;
    }

     public void deleteAPIResponseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAPIResponseRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("APIResponse")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type aPIResponse
             }
     }
     public void purgeAPIResponseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAPIResponseRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("APIResponse")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type aPIResponse
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/serverSupportedCapabilities")

    public ServerSupportedCapability createServerSupportedCapabilityRelationship(@PathVariable("userId") String userId,ServerSupportedCapability relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createServerSupportedCapabilityRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ServerSupportedCapabilityMapper.mapServerSupportedCapabilityToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ServerSupportedCapability reclassifiedServerSupportedCapability =  ServerSupportedCapabilityMapper.mapOmrsRelationshipToServerSupportedCapability(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedServerSupportedCapability;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/serverSupportedCapabilities")

    public ServerSupportedCapability getServerSupportedCapabilityRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getServerSupportedCapabilityRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ServerSupportedCapability gotServerSupportedCapability = ServerSupportedCapabilityMapper.mapOmrsRelationshipToServerSupportedCapability(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotServerSupportedCapability;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/serverSupportedCapabilities")
    public ServerSupportedCapability updateServerSupportedCapabilityRelationship(@PathVariable("userId") String userId,ServerSupportedCapability serverSupportedCapability)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateServerSupportedCapabilityRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ServerSupportedCapabilityMapper.mapServerSupportedCapabilityToOmrsRelationship(serverSupportedCapability);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ServerSupportedCapability updatedServerSupportedCapability = ServerSupportedCapabilityMapper.mapOmrsRelationshipToServerSupportedCapability(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedServerSupportedCapability;
    }

     public void deleteServerSupportedCapabilityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteServerSupportedCapabilityRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ServerSupportedCapability")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type serverSupportedCapability
             }
     }
     public void purgeServerSupportedCapabilityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeServerSupportedCapabilityRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ServerSupportedCapability")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type serverSupportedCapability
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/collectionMembers")

    public CollectionMember createCollectionMemberRelationship(@PathVariable("userId") String userId,CollectionMember relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCollectionMemberRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CollectionMemberMapper.mapCollectionMemberToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        CollectionMember reclassifiedCollectionMember =  CollectionMemberMapper.mapOmrsRelationshipToCollectionMember(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCollectionMember;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/collectionMembers")

    public CollectionMember getCollectionMemberRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCollectionMemberRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            CollectionMember gotCollectionMember = CollectionMemberMapper.mapOmrsRelationshipToCollectionMember(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCollectionMember;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/collectionMembers")
    public CollectionMember updateCollectionMemberRelationship(@PathVariable("userId") String userId,CollectionMember collectionMember)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCollectionMemberRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CollectionMemberMapper.mapCollectionMemberToOmrsRelationship(collectionMember);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        CollectionMember updatedCollectionMember = CollectionMemberMapper.mapOmrsRelationshipToCollectionMember(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCollectionMember;
    }

     public void deleteCollectionMemberRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCollectionMemberRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("CollectionMember")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type collectionMember
             }
     }
     public void purgeCollectionMemberRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCollectionMemberRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("CollectionMember")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type collectionMember
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/hostNetworks")

    public HostNetwork createHostNetworkRelationship(@PathVariable("userId") String userId,HostNetwork relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createHostNetworkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = HostNetworkMapper.mapHostNetworkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        HostNetwork reclassifiedHostNetwork =  HostNetworkMapper.mapOmrsRelationshipToHostNetwork(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedHostNetwork;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/hostNetworks")

    public HostNetwork getHostNetworkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getHostNetworkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            HostNetwork gotHostNetwork = HostNetworkMapper.mapOmrsRelationshipToHostNetwork(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotHostNetwork;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/hostNetworks")
    public HostNetwork updateHostNetworkRelationship(@PathVariable("userId") String userId,HostNetwork hostNetwork)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateHostNetworkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = HostNetworkMapper.mapHostNetworkToOmrsRelationship(hostNetwork);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        HostNetwork updatedHostNetwork = HostNetworkMapper.mapOmrsRelationshipToHostNetwork(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedHostNetwork;
    }

     public void deleteHostNetworkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteHostNetworkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("HostNetwork")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type hostNetwork
             }
     }
     public void purgeHostNetworkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeHostNetworkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("HostNetwork")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type hostNetwork
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attributeForSchemas")

    public AttributeForSchema createAttributeForSchemaRelationship(@PathVariable("userId") String userId,AttributeForSchema relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttributeForSchemaRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttributeForSchemaMapper.mapAttributeForSchemaToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttributeForSchema reclassifiedAttributeForSchema =  AttributeForSchemaMapper.mapOmrsRelationshipToAttributeForSchema(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttributeForSchema;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attributeForSchemas")

    public AttributeForSchema getAttributeForSchemaRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttributeForSchemaRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttributeForSchema gotAttributeForSchema = AttributeForSchemaMapper.mapOmrsRelationshipToAttributeForSchema(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttributeForSchema;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attributeForSchemas")
    public AttributeForSchema updateAttributeForSchemaRelationship(@PathVariable("userId") String userId,AttributeForSchema attributeForSchema)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttributeForSchemaRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttributeForSchemaMapper.mapAttributeForSchemaToOmrsRelationship(attributeForSchema);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttributeForSchema updatedAttributeForSchema = AttributeForSchemaMapper.mapOmrsRelationshipToAttributeForSchema(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttributeForSchema;
    }

     public void deleteAttributeForSchemaRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttributeForSchemaRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttributeForSchema")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attributeForSchema
             }
     }
     public void purgeAttributeForSchemaRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttributeForSchemaRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttributeForSchema")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attributeForSchema
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/assetLocations")

    public AssetLocation createAssetLocationRelationship(@PathVariable("userId") String userId,AssetLocation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAssetLocationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AssetLocationMapper.mapAssetLocationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AssetLocation reclassifiedAssetLocation =  AssetLocationMapper.mapOmrsRelationshipToAssetLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAssetLocation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/assetLocations")

    public AssetLocation getAssetLocationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAssetLocationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AssetLocation gotAssetLocation = AssetLocationMapper.mapOmrsRelationshipToAssetLocation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAssetLocation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/assetLocations")
    public AssetLocation updateAssetLocationRelationship(@PathVariable("userId") String userId,AssetLocation assetLocation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAssetLocationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AssetLocationMapper.mapAssetLocationToOmrsRelationship(assetLocation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AssetLocation updatedAssetLocation = AssetLocationMapper.mapOmrsRelationshipToAssetLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAssetLocation;
    }

     public void deleteAssetLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAssetLocationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AssetLocation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type assetLocation
             }
     }
     public void purgeAssetLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAssetLocationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AssetLocation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type assetLocation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/isTaxonomies")

    public IsTaxonomy createIsTaxonomyRelationship(@PathVariable("userId") String userId,IsTaxonomy relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createIsTaxonomyRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = IsTaxonomyMapper.mapIsTaxonomyToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        IsTaxonomy reclassifiedIsTaxonomy =  IsTaxonomyMapper.mapOmrsRelationshipToIsTaxonomy(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedIsTaxonomy;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/isTaxonomies")

    public IsTaxonomy getIsTaxonomyRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getIsTaxonomyRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            IsTaxonomy gotIsTaxonomy = IsTaxonomyMapper.mapOmrsRelationshipToIsTaxonomy(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotIsTaxonomy;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/isTaxonomies")
    public IsTaxonomy updateIsTaxonomyRelationship(@PathVariable("userId") String userId,IsTaxonomy isTaxonomy)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateIsTaxonomyRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = IsTaxonomyMapper.mapIsTaxonomyToOmrsRelationship(isTaxonomy);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        IsTaxonomy updatedIsTaxonomy = IsTaxonomyMapper.mapOmrsRelationshipToIsTaxonomy(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedIsTaxonomy;
    }

     public void deleteIsTaxonomyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteIsTaxonomyRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("IsTaxonomy")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type isTaxonomy
             }
     }
     public void purgeIsTaxonomyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeIsTaxonomyRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("IsTaxonomy")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type isTaxonomy
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/schemaAttributeTypes")

    public SchemaAttributeType createSchemaAttributeTypeRelationship(@PathVariable("userId") String userId,SchemaAttributeType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSchemaAttributeTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SchemaAttributeTypeMapper.mapSchemaAttributeTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        SchemaAttributeType reclassifiedSchemaAttributeType =  SchemaAttributeTypeMapper.mapOmrsRelationshipToSchemaAttributeType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSchemaAttributeType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/schemaAttributeTypes")

    public SchemaAttributeType getSchemaAttributeTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSchemaAttributeTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            SchemaAttributeType gotSchemaAttributeType = SchemaAttributeTypeMapper.mapOmrsRelationshipToSchemaAttributeType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSchemaAttributeType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/schemaAttributeTypes")
    public SchemaAttributeType updateSchemaAttributeTypeRelationship(@PathVariable("userId") String userId,SchemaAttributeType schemaAttributeType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSchemaAttributeTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SchemaAttributeTypeMapper.mapSchemaAttributeTypeToOmrsRelationship(schemaAttributeType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        SchemaAttributeType updatedSchemaAttributeType = SchemaAttributeTypeMapper.mapOmrsRelationshipToSchemaAttributeType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSchemaAttributeType;
    }

     public void deleteSchemaAttributeTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSchemaAttributeTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("SchemaAttributeType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type schemaAttributeType
             }
     }
     public void purgeSchemaAttributeTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSchemaAttributeTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("SchemaAttributeType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type schemaAttributeType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceImplementations")

    public GovernanceImplementation createGovernanceImplementationRelationship(@PathVariable("userId") String userId,GovernanceImplementation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceImplementationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceImplementationMapper.mapGovernanceImplementationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceImplementation reclassifiedGovernanceImplementation =  GovernanceImplementationMapper.mapOmrsRelationshipToGovernanceImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceImplementation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceImplementations")

    public GovernanceImplementation getGovernanceImplementationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceImplementationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceImplementation gotGovernanceImplementation = GovernanceImplementationMapper.mapOmrsRelationshipToGovernanceImplementation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceImplementation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceImplementations")
    public GovernanceImplementation updateGovernanceImplementationRelationship(@PathVariable("userId") String userId,GovernanceImplementation governanceImplementation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceImplementationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceImplementationMapper.mapGovernanceImplementationToOmrsRelationship(governanceImplementation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceImplementation updatedGovernanceImplementation = GovernanceImplementationMapper.mapOmrsRelationshipToGovernanceImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceImplementation;
    }

     public void deleteGovernanceImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceImplementationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceImplementation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceImplementation
             }
     }
     public void purgeGovernanceImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceImplementationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceImplementation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceImplementation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/linkedMedias")

    public LinkedMedia createLinkedMediaRelationship(@PathVariable("userId") String userId,LinkedMedia relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createLinkedMediaRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = LinkedMediaMapper.mapLinkedMediaToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        LinkedMedia reclassifiedLinkedMedia =  LinkedMediaMapper.mapOmrsRelationshipToLinkedMedia(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedLinkedMedia;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/linkedMedias")

    public LinkedMedia getLinkedMediaRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getLinkedMediaRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            LinkedMedia gotLinkedMedia = LinkedMediaMapper.mapOmrsRelationshipToLinkedMedia(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotLinkedMedia;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/linkedMedias")
    public LinkedMedia updateLinkedMediaRelationship(@PathVariable("userId") String userId,LinkedMedia linkedMedia)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateLinkedMediaRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = LinkedMediaMapper.mapLinkedMediaToOmrsRelationship(linkedMedia);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        LinkedMedia updatedLinkedMedia = LinkedMediaMapper.mapOmrsRelationshipToLinkedMedia(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedLinkedMedia;
    }

     public void deleteLinkedMediaRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteLinkedMediaRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("LinkedMedia")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type linkedMedia
             }
     }
     public void purgeLinkedMediaRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeLinkedMediaRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("LinkedMedia")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type linkedMedia
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/mapToElementTypes")

    public MapToElementType createMapToElementTypeRelationship(@PathVariable("userId") String userId,MapToElementType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createMapToElementTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = MapToElementTypeMapper.mapMapToElementTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        MapToElementType reclassifiedMapToElementType =  MapToElementTypeMapper.mapOmrsRelationshipToMapToElementType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedMapToElementType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/mapToElementTypes")

    public MapToElementType getMapToElementTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getMapToElementTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            MapToElementType gotMapToElementType = MapToElementTypeMapper.mapOmrsRelationshipToMapToElementType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotMapToElementType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/mapToElementTypes")
    public MapToElementType updateMapToElementTypeRelationship(@PathVariable("userId") String userId,MapToElementType mapToElementType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateMapToElementTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = MapToElementTypeMapper.mapMapToElementTypeToOmrsRelationship(mapToElementType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        MapToElementType updatedMapToElementType = MapToElementTypeMapper.mapOmrsRelationshipToMapToElementType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedMapToElementType;
    }

     public void deleteMapToElementTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteMapToElementTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("MapToElementType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type mapToElementType
             }
     }
     public void purgeMapToElementTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeMapToElementTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("MapToElementType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type mapToElementType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/externallySourcedGlossaries")

    public ExternallySourcedGlossary createExternallySourcedGlossaryRelationship(@PathVariable("userId") String userId,ExternallySourcedGlossary relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createExternallySourcedGlossaryRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ExternallySourcedGlossaryMapper.mapExternallySourcedGlossaryToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ExternallySourcedGlossary reclassifiedExternallySourcedGlossary =  ExternallySourcedGlossaryMapper.mapOmrsRelationshipToExternallySourcedGlossary(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedExternallySourcedGlossary;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/externallySourcedGlossaries")

    public ExternallySourcedGlossary getExternallySourcedGlossaryRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getExternallySourcedGlossaryRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ExternallySourcedGlossary gotExternallySourcedGlossary = ExternallySourcedGlossaryMapper.mapOmrsRelationshipToExternallySourcedGlossary(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotExternallySourcedGlossary;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/externallySourcedGlossaries")
    public ExternallySourcedGlossary updateExternallySourcedGlossaryRelationship(@PathVariable("userId") String userId,ExternallySourcedGlossary externallySourcedGlossary)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateExternallySourcedGlossaryRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ExternallySourcedGlossaryMapper.mapExternallySourcedGlossaryToOmrsRelationship(externallySourcedGlossary);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ExternallySourcedGlossary updatedExternallySourcedGlossary = ExternallySourcedGlossaryMapper.mapOmrsRelationshipToExternallySourcedGlossary(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedExternallySourcedGlossary;
    }

     public void deleteExternallySourcedGlossaryRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteExternallySourcedGlossaryRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ExternallySourcedGlossary")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type externallySourcedGlossary
             }
     }
     public void purgeExternallySourcedGlossaryRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeExternallySourcedGlossaryRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ExternallySourcedGlossary")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type externallySourcedGlossary
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/externalReferenceLinks")

    public ExternalReferenceLink createExternalReferenceLinkRelationship(@PathVariable("userId") String userId,ExternalReferenceLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createExternalReferenceLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ExternalReferenceLinkMapper.mapExternalReferenceLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ExternalReferenceLink reclassifiedExternalReferenceLink =  ExternalReferenceLinkMapper.mapOmrsRelationshipToExternalReferenceLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedExternalReferenceLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/externalReferenceLinks")

    public ExternalReferenceLink getExternalReferenceLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getExternalReferenceLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ExternalReferenceLink gotExternalReferenceLink = ExternalReferenceLinkMapper.mapOmrsRelationshipToExternalReferenceLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotExternalReferenceLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/externalReferenceLinks")
    public ExternalReferenceLink updateExternalReferenceLinkRelationship(@PathVariable("userId") String userId,ExternalReferenceLink externalReferenceLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateExternalReferenceLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ExternalReferenceLinkMapper.mapExternalReferenceLinkToOmrsRelationship(externalReferenceLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ExternalReferenceLink updatedExternalReferenceLink = ExternalReferenceLinkMapper.mapOmrsRelationshipToExternalReferenceLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedExternalReferenceLink;
    }

     public void deleteExternalReferenceLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteExternalReferenceLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ExternalReferenceLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type externalReferenceLink
             }
     }
     public void purgeExternalReferenceLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeExternalReferenceLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ExternalReferenceLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type externalReferenceLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/mediaReferences")

    public MediaReference createMediaReferenceRelationship(@PathVariable("userId") String userId,MediaReference relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createMediaReferenceRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = MediaReferenceMapper.mapMediaReferenceToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        MediaReference reclassifiedMediaReference =  MediaReferenceMapper.mapOmrsRelationshipToMediaReference(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedMediaReference;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/mediaReferences")

    public MediaReference getMediaReferenceRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getMediaReferenceRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            MediaReference gotMediaReference = MediaReferenceMapper.mapOmrsRelationshipToMediaReference(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotMediaReference;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/mediaReferences")
    public MediaReference updateMediaReferenceRelationship(@PathVariable("userId") String userId,MediaReference mediaReference)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateMediaReferenceRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = MediaReferenceMapper.mapMediaReferenceToOmrsRelationship(mediaReference);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        MediaReference updatedMediaReference = MediaReferenceMapper.mapOmrsRelationshipToMediaReference(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedMediaReference;
    }

     public void deleteMediaReferenceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteMediaReferenceRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("MediaReference")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type mediaReference
             }
     }
     public void purgeMediaReferenceRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeMediaReferenceRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("MediaReference")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type mediaReference
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/communityMemberships")

    public CommunityMembership createCommunityMembershipRelationship(@PathVariable("userId") String userId,CommunityMembership relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCommunityMembershipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CommunityMembershipMapper.mapCommunityMembershipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        CommunityMembership reclassifiedCommunityMembership =  CommunityMembershipMapper.mapOmrsRelationshipToCommunityMembership(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCommunityMembership;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/communityMemberships")

    public CommunityMembership getCommunityMembershipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCommunityMembershipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            CommunityMembership gotCommunityMembership = CommunityMembershipMapper.mapOmrsRelationshipToCommunityMembership(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCommunityMembership;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/communityMemberships")
    public CommunityMembership updateCommunityMembershipRelationship(@PathVariable("userId") String userId,CommunityMembership communityMembership)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCommunityMembershipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CommunityMembershipMapper.mapCommunityMembershipToOmrsRelationship(communityMembership);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        CommunityMembership updatedCommunityMembership = CommunityMembershipMapper.mapOmrsRelationshipToCommunityMembership(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCommunityMembership;
    }

     public void deleteCommunityMembershipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCommunityMembershipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("CommunityMembership")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type communityMembership
             }
     }
     public void purgeCommunityMembershipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCommunityMembershipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("CommunityMembership")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type communityMembership
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/externalIdScopes")

    public ExternalIdScope createExternalIdScopeRelationship(@PathVariable("userId") String userId,ExternalIdScope relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createExternalIdScopeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ExternalIdScopeMapper.mapExternalIdScopeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ExternalIdScope reclassifiedExternalIdScope =  ExternalIdScopeMapper.mapOmrsRelationshipToExternalIdScope(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedExternalIdScope;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/externalIdScopes")

    public ExternalIdScope getExternalIdScopeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getExternalIdScopeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ExternalIdScope gotExternalIdScope = ExternalIdScopeMapper.mapOmrsRelationshipToExternalIdScope(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotExternalIdScope;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/externalIdScopes")
    public ExternalIdScope updateExternalIdScopeRelationship(@PathVariable("userId") String userId,ExternalIdScope externalIdScope)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateExternalIdScopeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ExternalIdScopeMapper.mapExternalIdScopeToOmrsRelationship(externalIdScope);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ExternalIdScope updatedExternalIdScope = ExternalIdScopeMapper.mapOmrsRelationshipToExternalIdScope(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedExternalIdScope;
    }

     public void deleteExternalIdScopeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteExternalIdScopeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ExternalIdScope")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type externalIdScope
             }
     }
     public void purgeExternalIdScopeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeExternalIdScopeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ExternalIdScope")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type externalIdScope
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/validValues")

    public ValidValue createValidValueRelationship(@PathVariable("userId") String userId,ValidValue relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createValidValueRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ValidValueMapper.mapValidValueToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ValidValue reclassifiedValidValue =  ValidValueMapper.mapOmrsRelationshipToValidValue(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedValidValue;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/validValues")

    public ValidValue getValidValueRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getValidValueRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ValidValue gotValidValue = ValidValueMapper.mapOmrsRelationshipToValidValue(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotValidValue;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/validValues")
    public ValidValue updateValidValueRelationship(@PathVariable("userId") String userId,ValidValue validValue)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateValidValueRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ValidValueMapper.mapValidValueToOmrsRelationship(validValue);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ValidValue updatedValidValue = ValidValueMapper.mapOmrsRelationshipToValidValue(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedValidValue;
    }

     public void deleteValidValueRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteValidValueRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ValidValue")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type validValue
             }
     }
     public void purgeValidValueRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeValidValueRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ValidValue")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type validValue
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/acceptedAnswers")

    public AcceptedAnswer createAcceptedAnswerRelationship(@PathVariable("userId") String userId,AcceptedAnswer relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAcceptedAnswerRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AcceptedAnswerMapper.mapAcceptedAnswerToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AcceptedAnswer reclassifiedAcceptedAnswer =  AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAcceptedAnswer;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/acceptedAnswers")

    public AcceptedAnswer getAcceptedAnswerRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAcceptedAnswerRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AcceptedAnswer gotAcceptedAnswer = AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAcceptedAnswer;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/acceptedAnswers")
    public AcceptedAnswer updateAcceptedAnswerRelationship(@PathVariable("userId") String userId,AcceptedAnswer acceptedAnswer)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAcceptedAnswerRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AcceptedAnswerMapper.mapAcceptedAnswerToOmrsRelationship(acceptedAnswer);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AcceptedAnswer updatedAcceptedAnswer = AcceptedAnswerMapper.mapOmrsRelationshipToAcceptedAnswer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAcceptedAnswer;
    }

     public void deleteAcceptedAnswerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAcceptedAnswerRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AcceptedAnswer")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type acceptedAnswer
             }
     }
     public void purgeAcceptedAnswerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAcceptedAnswerRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AcceptedAnswer")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type acceptedAnswer
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceDefinitionMetrics")

    public GovernanceDefinitionMetric createGovernanceDefinitionMetricRelationship(@PathVariable("userId") String userId,GovernanceDefinitionMetric relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceDefinitionMetricRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceDefinitionMetricMapper.mapGovernanceDefinitionMetricToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceDefinitionMetric reclassifiedGovernanceDefinitionMetric =  GovernanceDefinitionMetricMapper.mapOmrsRelationshipToGovernanceDefinitionMetric(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceDefinitionMetric;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceDefinitionMetrics")

    public GovernanceDefinitionMetric getGovernanceDefinitionMetricRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceDefinitionMetricRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceDefinitionMetric gotGovernanceDefinitionMetric = GovernanceDefinitionMetricMapper.mapOmrsRelationshipToGovernanceDefinitionMetric(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceDefinitionMetric;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceDefinitionMetrics")
    public GovernanceDefinitionMetric updateGovernanceDefinitionMetricRelationship(@PathVariable("userId") String userId,GovernanceDefinitionMetric governanceDefinitionMetric)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceDefinitionMetricRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceDefinitionMetricMapper.mapGovernanceDefinitionMetricToOmrsRelationship(governanceDefinitionMetric);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceDefinitionMetric updatedGovernanceDefinitionMetric = GovernanceDefinitionMetricMapper.mapOmrsRelationshipToGovernanceDefinitionMetric(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceDefinitionMetric;
    }

     public void deleteGovernanceDefinitionMetricRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceDefinitionMetricRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceDefinitionMetric")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceDefinitionMetric
             }
     }
     public void purgeGovernanceDefinitionMetricRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceDefinitionMetricRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceDefinitionMetric")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceDefinitionMetric
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/schemaQueryImplementations")

    public SchemaQueryImplementation createSchemaQueryImplementationRelationship(@PathVariable("userId") String userId,SchemaQueryImplementation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSchemaQueryImplementationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SchemaQueryImplementationMapper.mapSchemaQueryImplementationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        SchemaQueryImplementation reclassifiedSchemaQueryImplementation =  SchemaQueryImplementationMapper.mapOmrsRelationshipToSchemaQueryImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSchemaQueryImplementation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/schemaQueryImplementations")

    public SchemaQueryImplementation getSchemaQueryImplementationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSchemaQueryImplementationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            SchemaQueryImplementation gotSchemaQueryImplementation = SchemaQueryImplementationMapper.mapOmrsRelationshipToSchemaQueryImplementation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSchemaQueryImplementation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/schemaQueryImplementations")
    public SchemaQueryImplementation updateSchemaQueryImplementationRelationship(@PathVariable("userId") String userId,SchemaQueryImplementation schemaQueryImplementation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSchemaQueryImplementationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SchemaQueryImplementationMapper.mapSchemaQueryImplementationToOmrsRelationship(schemaQueryImplementation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        SchemaQueryImplementation updatedSchemaQueryImplementation = SchemaQueryImplementationMapper.mapOmrsRelationshipToSchemaQueryImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSchemaQueryImplementation;
    }

     public void deleteSchemaQueryImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSchemaQueryImplementationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("SchemaQueryImplementation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type schemaQueryImplementation
             }
     }
     public void purgeSchemaQueryImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSchemaQueryImplementationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("SchemaQueryImplementation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type schemaQueryImplementation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/assetSchemaTypes")

    public AssetSchemaType createAssetSchemaTypeRelationship(@PathVariable("userId") String userId,AssetSchemaType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAssetSchemaTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AssetSchemaTypeMapper.mapAssetSchemaTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AssetSchemaType reclassifiedAssetSchemaType =  AssetSchemaTypeMapper.mapOmrsRelationshipToAssetSchemaType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAssetSchemaType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/assetSchemaTypes")

    public AssetSchemaType getAssetSchemaTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAssetSchemaTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AssetSchemaType gotAssetSchemaType = AssetSchemaTypeMapper.mapOmrsRelationshipToAssetSchemaType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAssetSchemaType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/assetSchemaTypes")
    public AssetSchemaType updateAssetSchemaTypeRelationship(@PathVariable("userId") String userId,AssetSchemaType assetSchemaType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAssetSchemaTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AssetSchemaTypeMapper.mapAssetSchemaTypeToOmrsRelationship(assetSchemaType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AssetSchemaType updatedAssetSchemaType = AssetSchemaTypeMapper.mapOmrsRelationshipToAssetSchemaType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAssetSchemaType;
    }

     public void deleteAssetSchemaTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAssetSchemaTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AssetSchemaType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type assetSchemaType
             }
     }
     public void purgeAssetSchemaTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAssetSchemaTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AssetSchemaType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type assetSchemaType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectDependencies")

    public ProjectDependency createProjectDependencyRelationship(@PathVariable("userId") String userId,ProjectDependency relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectDependencyRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectDependencyMapper.mapProjectDependencyToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectDependency reclassifiedProjectDependency =  ProjectDependencyMapper.mapOmrsRelationshipToProjectDependency(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectDependency;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectDependencies")

    public ProjectDependency getProjectDependencyRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectDependencyRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectDependency gotProjectDependency = ProjectDependencyMapper.mapOmrsRelationshipToProjectDependency(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectDependency;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectDependencies")
    public ProjectDependency updateProjectDependencyRelationship(@PathVariable("userId") String userId,ProjectDependency projectDependency)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectDependencyRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectDependencyMapper.mapProjectDependencyToOmrsRelationship(projectDependency);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectDependency updatedProjectDependency = ProjectDependencyMapper.mapOmrsRelationshipToProjectDependency(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectDependency;
    }

     public void deleteProjectDependencyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectDependencyRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectDependency")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectDependency
             }
     }
     public void purgeProjectDependencyRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectDependencyRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectDependency")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectDependency
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/topicSubscriberses")

    public TopicSubscribers createTopicSubscribersRelationship(@PathVariable("userId") String userId,TopicSubscribers relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTopicSubscribersRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TopicSubscribersMapper.mapTopicSubscribersToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        TopicSubscribers reclassifiedTopicSubscribers =  TopicSubscribersMapper.mapOmrsRelationshipToTopicSubscribers(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTopicSubscribers;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/topicSubscriberses")

    public TopicSubscribers getTopicSubscribersRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTopicSubscribersRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            TopicSubscribers gotTopicSubscribers = TopicSubscribersMapper.mapOmrsRelationshipToTopicSubscribers(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTopicSubscribers;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/topicSubscriberses")
    public TopicSubscribers updateTopicSubscribersRelationship(@PathVariable("userId") String userId,TopicSubscribers topicSubscribers)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTopicSubscribersRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TopicSubscribersMapper.mapTopicSubscribersToOmrsRelationship(topicSubscribers);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        TopicSubscribers updatedTopicSubscribers = TopicSubscribersMapper.mapOmrsRelationshipToTopicSubscribers(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTopicSubscribers;
    }

     public void deleteTopicSubscribersRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTopicSubscribersRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("TopicSubscribers")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type topicSubscribers
             }
     }
     public void purgeTopicSubscribersRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTopicSubscribersRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("TopicSubscribers")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type topicSubscribers
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/replacementTerms")

    public ReplacementTerm createReplacementTermRelationship(@PathVariable("userId") String userId,ReplacementTerm relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createReplacementTermRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ReplacementTermMapper.mapReplacementTermToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ReplacementTerm reclassifiedReplacementTerm =  ReplacementTermMapper.mapOmrsRelationshipToReplacementTerm(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedReplacementTerm;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/replacementTerms")

    public ReplacementTerm getReplacementTermRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getReplacementTermRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ReplacementTerm gotReplacementTerm = ReplacementTermMapper.mapOmrsRelationshipToReplacementTerm(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotReplacementTerm;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/replacementTerms")
    public ReplacementTerm updateReplacementTermRelationship(@PathVariable("userId") String userId,ReplacementTerm replacementTerm)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateReplacementTermRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ReplacementTermMapper.mapReplacementTermToOmrsRelationship(replacementTerm);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ReplacementTerm updatedReplacementTerm = ReplacementTermMapper.mapOmrsRelationshipToReplacementTerm(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedReplacementTerm;
    }

     public void deleteReplacementTermRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteReplacementTermRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ReplacementTerm")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type replacementTerm
             }
     }
     public void purgeReplacementTermRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeReplacementTermRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ReplacementTerm")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type replacementTerm
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/organizationalCapabilities")

    public OrganizationalCapability createOrganizationalCapabilityRelationship(@PathVariable("userId") String userId,OrganizationalCapability relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createOrganizationalCapabilityRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = OrganizationalCapabilityMapper.mapOrganizationalCapabilityToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        OrganizationalCapability reclassifiedOrganizationalCapability =  OrganizationalCapabilityMapper.mapOmrsRelationshipToOrganizationalCapability(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedOrganizationalCapability;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/organizationalCapabilities")

    public OrganizationalCapability getOrganizationalCapabilityRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getOrganizationalCapabilityRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            OrganizationalCapability gotOrganizationalCapability = OrganizationalCapabilityMapper.mapOmrsRelationshipToOrganizationalCapability(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotOrganizationalCapability;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/organizationalCapabilities")
    public OrganizationalCapability updateOrganizationalCapabilityRelationship(@PathVariable("userId") String userId,OrganizationalCapability organizationalCapability)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateOrganizationalCapabilityRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = OrganizationalCapabilityMapper.mapOrganizationalCapabilityToOmrsRelationship(organizationalCapability);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        OrganizationalCapability updatedOrganizationalCapability = OrganizationalCapabilityMapper.mapOmrsRelationshipToOrganizationalCapability(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedOrganizationalCapability;
    }

     public void deleteOrganizationalCapabilityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteOrganizationalCapabilityRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("OrganizationalCapability")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type organizationalCapability
             }
     }
     public void purgeOrganizationalCapabilityRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeOrganizationalCapabilityRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("OrganizationalCapability")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type organizationalCapability
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/metadataCohortPeers")

    public MetadataCohortPeer createMetadataCohortPeerRelationship(@PathVariable("userId") String userId,MetadataCohortPeer relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createMetadataCohortPeerRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = MetadataCohortPeerMapper.mapMetadataCohortPeerToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        MetadataCohortPeer reclassifiedMetadataCohortPeer =  MetadataCohortPeerMapper.mapOmrsRelationshipToMetadataCohortPeer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedMetadataCohortPeer;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/metadataCohortPeers")

    public MetadataCohortPeer getMetadataCohortPeerRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getMetadataCohortPeerRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            MetadataCohortPeer gotMetadataCohortPeer = MetadataCohortPeerMapper.mapOmrsRelationshipToMetadataCohortPeer(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotMetadataCohortPeer;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/metadataCohortPeers")
    public MetadataCohortPeer updateMetadataCohortPeerRelationship(@PathVariable("userId") String userId,MetadataCohortPeer metadataCohortPeer)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateMetadataCohortPeerRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = MetadataCohortPeerMapper.mapMetadataCohortPeerToOmrsRelationship(metadataCohortPeer);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        MetadataCohortPeer updatedMetadataCohortPeer = MetadataCohortPeerMapper.mapOmrsRelationshipToMetadataCohortPeer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedMetadataCohortPeer;
    }

     public void deleteMetadataCohortPeerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteMetadataCohortPeerRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("MetadataCohortPeer")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type metadataCohortPeer
             }
     }
     public void purgeMetadataCohortPeerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeMetadataCohortPeerRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("MetadataCohortPeer")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type metadataCohortPeer
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attachedNoteLogEntries")

    public AttachedNoteLogEntry createAttachedNoteLogEntryRelationship(@PathVariable("userId") String userId,AttachedNoteLogEntry relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttachedNoteLogEntryRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttachedNoteLogEntryMapper.mapAttachedNoteLogEntryToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttachedNoteLogEntry reclassifiedAttachedNoteLogEntry =  AttachedNoteLogEntryMapper.mapOmrsRelationshipToAttachedNoteLogEntry(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttachedNoteLogEntry;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attachedNoteLogEntries")

    public AttachedNoteLogEntry getAttachedNoteLogEntryRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttachedNoteLogEntryRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttachedNoteLogEntry gotAttachedNoteLogEntry = AttachedNoteLogEntryMapper.mapOmrsRelationshipToAttachedNoteLogEntry(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttachedNoteLogEntry;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attachedNoteLogEntries")
    public AttachedNoteLogEntry updateAttachedNoteLogEntryRelationship(@PathVariable("userId") String userId,AttachedNoteLogEntry attachedNoteLogEntry)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttachedNoteLogEntryRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttachedNoteLogEntryMapper.mapAttachedNoteLogEntryToOmrsRelationship(attachedNoteLogEntry);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttachedNoteLogEntry updatedAttachedNoteLogEntry = AttachedNoteLogEntryMapper.mapOmrsRelationshipToAttachedNoteLogEntry(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttachedNoteLogEntry;
    }

     public void deleteAttachedNoteLogEntryRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttachedNoteLogEntryRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttachedNoteLogEntry")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attachedNoteLogEntry
             }
     }
     public void purgeAttachedNoteLogEntryRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttachedNoteLogEntryRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttachedNoteLogEntry")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attachedNoteLogEntry
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/assetServerUses")

    public AssetServerUse createAssetServerUseRelationship(@PathVariable("userId") String userId,AssetServerUse relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAssetServerUseRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AssetServerUseMapper.mapAssetServerUseToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AssetServerUse reclassifiedAssetServerUse =  AssetServerUseMapper.mapOmrsRelationshipToAssetServerUse(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAssetServerUse;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/assetServerUses")

    public AssetServerUse getAssetServerUseRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAssetServerUseRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AssetServerUse gotAssetServerUse = AssetServerUseMapper.mapOmrsRelationshipToAssetServerUse(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAssetServerUse;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/assetServerUses")
    public AssetServerUse updateAssetServerUseRelationship(@PathVariable("userId") String userId,AssetServerUse assetServerUse)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAssetServerUseRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AssetServerUseMapper.mapAssetServerUseToOmrsRelationship(assetServerUse);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AssetServerUse updatedAssetServerUse = AssetServerUseMapper.mapOmrsRelationshipToAssetServerUse(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAssetServerUse;
    }

     public void deleteAssetServerUseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAssetServerUseRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AssetServerUse")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type assetServerUse
             }
     }
     public void purgeAssetServerUseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAssetServerUseRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AssetServerUse")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type assetServerUse
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/runtimeForProcesses")

    public RuntimeForProcess createRuntimeForProcessRelationship(@PathVariable("userId") String userId,RuntimeForProcess relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createRuntimeForProcessRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = RuntimeForProcessMapper.mapRuntimeForProcessToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        RuntimeForProcess reclassifiedRuntimeForProcess =  RuntimeForProcessMapper.mapOmrsRelationshipToRuntimeForProcess(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedRuntimeForProcess;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/runtimeForProcesses")

    public RuntimeForProcess getRuntimeForProcessRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getRuntimeForProcessRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            RuntimeForProcess gotRuntimeForProcess = RuntimeForProcessMapper.mapOmrsRelationshipToRuntimeForProcess(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotRuntimeForProcess;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/runtimeForProcesses")
    public RuntimeForProcess updateRuntimeForProcessRelationship(@PathVariable("userId") String userId,RuntimeForProcess runtimeForProcess)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateRuntimeForProcessRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = RuntimeForProcessMapper.mapRuntimeForProcessToOmrsRelationship(runtimeForProcess);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        RuntimeForProcess updatedRuntimeForProcess = RuntimeForProcessMapper.mapOmrsRelationshipToRuntimeForProcess(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedRuntimeForProcess;
    }

     public void deleteRuntimeForProcessRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteRuntimeForProcessRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("RuntimeForProcess")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type runtimeForProcess
             }
     }
     public void purgeRuntimeForProcessRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeRuntimeForProcessRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("RuntimeForProcess")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type runtimeForProcess
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/nestedLocations")

    public NestedLocation createNestedLocationRelationship(@PathVariable("userId") String userId,NestedLocation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createNestedLocationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = NestedLocationMapper.mapNestedLocationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        NestedLocation reclassifiedNestedLocation =  NestedLocationMapper.mapOmrsRelationshipToNestedLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedNestedLocation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/nestedLocations")

    public NestedLocation getNestedLocationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getNestedLocationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            NestedLocation gotNestedLocation = NestedLocationMapper.mapOmrsRelationshipToNestedLocation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotNestedLocation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/nestedLocations")
    public NestedLocation updateNestedLocationRelationship(@PathVariable("userId") String userId,NestedLocation nestedLocation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateNestedLocationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = NestedLocationMapper.mapNestedLocationToOmrsRelationship(nestedLocation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        NestedLocation updatedNestedLocation = NestedLocationMapper.mapOmrsRelationshipToNestedLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedNestedLocation;
    }

     public void deleteNestedLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteNestedLocationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("NestedLocation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type nestedLocation
             }
     }
     public void purgeNestedLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeNestedLocationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("NestedLocation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type nestedLocation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/staffAssignments")

    public StaffAssignment createStaffAssignmentRelationship(@PathVariable("userId") String userId,StaffAssignment relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createStaffAssignmentRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = StaffAssignmentMapper.mapStaffAssignmentToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        StaffAssignment reclassifiedStaffAssignment =  StaffAssignmentMapper.mapOmrsRelationshipToStaffAssignment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedStaffAssignment;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/staffAssignments")

    public StaffAssignment getStaffAssignmentRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getStaffAssignmentRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            StaffAssignment gotStaffAssignment = StaffAssignmentMapper.mapOmrsRelationshipToStaffAssignment(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotStaffAssignment;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/staffAssignments")
    public StaffAssignment updateStaffAssignmentRelationship(@PathVariable("userId") String userId,StaffAssignment staffAssignment)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateStaffAssignmentRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = StaffAssignmentMapper.mapStaffAssignmentToOmrsRelationship(staffAssignment);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        StaffAssignment updatedStaffAssignment = StaffAssignmentMapper.mapOmrsRelationshipToStaffAssignment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedStaffAssignment;
    }

     public void deleteStaffAssignmentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteStaffAssignmentRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("StaffAssignment")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type staffAssignment
             }
     }
     public void purgeStaffAssignmentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeStaffAssignmentRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("StaffAssignment")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type staffAssignment
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/linkedFiles")

    public LinkedFile createLinkedFileRelationship(@PathVariable("userId") String userId,LinkedFile relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createLinkedFileRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = LinkedFileMapper.mapLinkedFileToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        LinkedFile reclassifiedLinkedFile =  LinkedFileMapper.mapOmrsRelationshipToLinkedFile(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedLinkedFile;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/linkedFiles")

    public LinkedFile getLinkedFileRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getLinkedFileRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            LinkedFile gotLinkedFile = LinkedFileMapper.mapOmrsRelationshipToLinkedFile(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotLinkedFile;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/linkedFiles")
    public LinkedFile updateLinkedFileRelationship(@PathVariable("userId") String userId,LinkedFile linkedFile)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateLinkedFileRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = LinkedFileMapper.mapLinkedFileToOmrsRelationship(linkedFile);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        LinkedFile updatedLinkedFile = LinkedFileMapper.mapOmrsRelationshipToLinkedFile(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedLinkedFile;
    }

     public void deleteLinkedFileRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteLinkedFileRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("LinkedFile")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type linkedFile
             }
     }
     public void purgeLinkedFileRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeLinkedFileRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("LinkedFile")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type linkedFile
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/termCategorizations")

    public TermCategorization createTermCategorizationRelationship(@PathVariable("userId") String userId,TermCategorization relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTermCategorizationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TermCategorizationMapper.mapTermCategorizationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        TermCategorization reclassifiedTermCategorization =  TermCategorizationMapper.mapOmrsRelationshipToTermCategorization(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTermCategorization;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/termCategorizations")

    public TermCategorization getTermCategorizationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTermCategorizationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            TermCategorization gotTermCategorization = TermCategorizationMapper.mapOmrsRelationshipToTermCategorization(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTermCategorization;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/termCategorizations")
    public TermCategorization updateTermCategorizationRelationship(@PathVariable("userId") String userId,TermCategorization termCategorization)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTermCategorizationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TermCategorizationMapper.mapTermCategorizationToOmrsRelationship(termCategorization);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        TermCategorization updatedTermCategorization = TermCategorizationMapper.mapOmrsRelationshipToTermCategorization(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTermCategorization;
    }

     public void deleteTermCategorizationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTermCategorizationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("TermCategorization")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type termCategorization
             }
     }
     public void purgeTermCategorizationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTermCategorizationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("TermCategorization")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type termCategorization
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/zoneMemberships")

    public ZoneMembership createZoneMembershipRelationship(@PathVariable("userId") String userId,ZoneMembership relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createZoneMembershipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ZoneMembershipMapper.mapZoneMembershipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ZoneMembership reclassifiedZoneMembership =  ZoneMembershipMapper.mapOmrsRelationshipToZoneMembership(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedZoneMembership;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/zoneMemberships")

    public ZoneMembership getZoneMembershipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getZoneMembershipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ZoneMembership gotZoneMembership = ZoneMembershipMapper.mapOmrsRelationshipToZoneMembership(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotZoneMembership;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/zoneMemberships")
    public ZoneMembership updateZoneMembershipRelationship(@PathVariable("userId") String userId,ZoneMembership zoneMembership)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateZoneMembershipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ZoneMembershipMapper.mapZoneMembershipToOmrsRelationship(zoneMembership);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ZoneMembership updatedZoneMembership = ZoneMembershipMapper.mapOmrsRelationshipToZoneMembership(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedZoneMembership;
    }

     public void deleteZoneMembershipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteZoneMembershipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ZoneMembership")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type zoneMembership
             }
     }
     public void purgeZoneMembershipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeZoneMembershipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ZoneMembership")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type zoneMembership
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/aPIEndpoints")

    public APIEndpoint createAPIEndpointRelationship(@PathVariable("userId") String userId,APIEndpoint relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAPIEndpointRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = APIEndpointMapper.mapAPIEndpointToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        APIEndpoint reclassifiedAPIEndpoint =  APIEndpointMapper.mapOmrsRelationshipToAPIEndpoint(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAPIEndpoint;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/aPIEndpoints")

    public APIEndpoint getAPIEndpointRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAPIEndpointRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            APIEndpoint gotAPIEndpoint = APIEndpointMapper.mapOmrsRelationshipToAPIEndpoint(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAPIEndpoint;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/aPIEndpoints")
    public APIEndpoint updateAPIEndpointRelationship(@PathVariable("userId") String userId,APIEndpoint aPIEndpoint)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAPIEndpointRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = APIEndpointMapper.mapAPIEndpointToOmrsRelationship(aPIEndpoint);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        APIEndpoint updatedAPIEndpoint = APIEndpointMapper.mapOmrsRelationshipToAPIEndpoint(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAPIEndpoint;
    }

     public void deleteAPIEndpointRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAPIEndpointRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("APIEndpoint")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type aPIEndpoint
             }
     }
     public void purgeAPIEndpointRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAPIEndpointRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("APIEndpoint")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type aPIEndpoint
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/connectionEndpoints")

    public ConnectionEndpoint createConnectionEndpointRelationship(@PathVariable("userId") String userId,ConnectionEndpoint relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createConnectionEndpointRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ConnectionEndpointMapper.mapConnectionEndpointToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ConnectionEndpoint reclassifiedConnectionEndpoint =  ConnectionEndpointMapper.mapOmrsRelationshipToConnectionEndpoint(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedConnectionEndpoint;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/connectionEndpoints")

    public ConnectionEndpoint getConnectionEndpointRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getConnectionEndpointRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ConnectionEndpoint gotConnectionEndpoint = ConnectionEndpointMapper.mapOmrsRelationshipToConnectionEndpoint(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotConnectionEndpoint;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/connectionEndpoints")
    public ConnectionEndpoint updateConnectionEndpointRelationship(@PathVariable("userId") String userId,ConnectionEndpoint connectionEndpoint)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateConnectionEndpointRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ConnectionEndpointMapper.mapConnectionEndpointToOmrsRelationship(connectionEndpoint);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ConnectionEndpoint updatedConnectionEndpoint = ConnectionEndpointMapper.mapOmrsRelationshipToConnectionEndpoint(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedConnectionEndpoint;
    }

     public void deleteConnectionEndpointRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteConnectionEndpointRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ConnectionEndpoint")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type connectionEndpoint
             }
     }
     public void purgeConnectionEndpointRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeConnectionEndpointRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ConnectionEndpoint")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type connectionEndpoint
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/categoryAnchors")

    public CategoryAnchor createCategoryAnchorRelationship(@PathVariable("userId") String userId,CategoryAnchor relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCategoryAnchorRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CategoryAnchorMapper.mapCategoryAnchorToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        CategoryAnchor reclassifiedCategoryAnchor =  CategoryAnchorMapper.mapOmrsRelationshipToCategoryAnchor(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCategoryAnchor;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/categoryAnchors")

    public CategoryAnchor getCategoryAnchorRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCategoryAnchorRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            CategoryAnchor gotCategoryAnchor = CategoryAnchorMapper.mapOmrsRelationshipToCategoryAnchor(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCategoryAnchor;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/categoryAnchors")
    public CategoryAnchor updateCategoryAnchorRelationship(@PathVariable("userId") String userId,CategoryAnchor categoryAnchor)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCategoryAnchorRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CategoryAnchorMapper.mapCategoryAnchorToOmrsRelationship(categoryAnchor);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        CategoryAnchor updatedCategoryAnchor = CategoryAnchorMapper.mapOmrsRelationshipToCategoryAnchor(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCategoryAnchor;
    }

     public void deleteCategoryAnchorRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCategoryAnchorRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("CategoryAnchor")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type categoryAnchor
             }
     }
     public void purgeCategoryAnchorRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCategoryAnchorRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("CategoryAnchor")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type categoryAnchor
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectTeams")

    public ProjectTeam createProjectTeamRelationship(@PathVariable("userId") String userId,ProjectTeam relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectTeamRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectTeamMapper.mapProjectTeamToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectTeam reclassifiedProjectTeam =  ProjectTeamMapper.mapOmrsRelationshipToProjectTeam(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectTeam;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectTeams")

    public ProjectTeam getProjectTeamRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectTeamRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectTeam gotProjectTeam = ProjectTeamMapper.mapOmrsRelationshipToProjectTeam(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectTeam;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectTeams")
    public ProjectTeam updateProjectTeamRelationship(@PathVariable("userId") String userId,ProjectTeam projectTeam)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectTeamRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectTeamMapper.mapProjectTeamToOmrsRelationship(projectTeam);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectTeam updatedProjectTeam = ProjectTeamMapper.mapOmrsRelationshipToProjectTeam(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectTeam;
    }

     public void deleteProjectTeamRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectTeamRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectTeam")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectTeam
             }
     }
     public void purgeProjectTeamRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectTeamRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectTeam")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectTeam
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/processOutputs")

    public ProcessOutput createProcessOutputRelationship(@PathVariable("userId") String userId,ProcessOutput relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProcessOutputRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProcessOutputMapper.mapProcessOutputToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProcessOutput reclassifiedProcessOutput =  ProcessOutputMapper.mapOmrsRelationshipToProcessOutput(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProcessOutput;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/processOutputs")

    public ProcessOutput getProcessOutputRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProcessOutputRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProcessOutput gotProcessOutput = ProcessOutputMapper.mapOmrsRelationshipToProcessOutput(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProcessOutput;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/processOutputs")
    public ProcessOutput updateProcessOutputRelationship(@PathVariable("userId") String userId,ProcessOutput processOutput)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProcessOutputRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProcessOutputMapper.mapProcessOutputToOmrsRelationship(processOutput);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProcessOutput updatedProcessOutput = ProcessOutputMapper.mapOmrsRelationshipToProcessOutput(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProcessOutput;
    }

     public void deleteProcessOutputRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProcessOutputRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProcessOutput")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type processOutput
             }
     }
     public void purgeProcessOutputRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProcessOutputRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProcessOutput")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type processOutput
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/aPIOperationses")

    public APIOperations createAPIOperationsRelationship(@PathVariable("userId") String userId,APIOperations relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAPIOperationsRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = APIOperationsMapper.mapAPIOperationsToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        APIOperations reclassifiedAPIOperations =  APIOperationsMapper.mapOmrsRelationshipToAPIOperations(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAPIOperations;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/aPIOperationses")

    public APIOperations getAPIOperationsRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAPIOperationsRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            APIOperations gotAPIOperations = APIOperationsMapper.mapOmrsRelationshipToAPIOperations(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAPIOperations;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/aPIOperationses")
    public APIOperations updateAPIOperationsRelationship(@PathVariable("userId") String userId,APIOperations aPIOperations)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAPIOperationsRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = APIOperationsMapper.mapAPIOperationsToOmrsRelationship(aPIOperations);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        APIOperations updatedAPIOperations = APIOperationsMapper.mapOmrsRelationshipToAPIOperations(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAPIOperations;
    }

     public void deleteAPIOperationsRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAPIOperationsRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("APIOperations")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type aPIOperations
             }
     }
     public void purgeAPIOperationsRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAPIOperationsRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("APIOperations")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type aPIOperations
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governancePolicyLinks")

    public GovernancePolicyLink createGovernancePolicyLinkRelationship(@PathVariable("userId") String userId,GovernancePolicyLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernancePolicyLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernancePolicyLinkMapper.mapGovernancePolicyLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernancePolicyLink reclassifiedGovernancePolicyLink =  GovernancePolicyLinkMapper.mapOmrsRelationshipToGovernancePolicyLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernancePolicyLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governancePolicyLinks")

    public GovernancePolicyLink getGovernancePolicyLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernancePolicyLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernancePolicyLink gotGovernancePolicyLink = GovernancePolicyLinkMapper.mapOmrsRelationshipToGovernancePolicyLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernancePolicyLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governancePolicyLinks")
    public GovernancePolicyLink updateGovernancePolicyLinkRelationship(@PathVariable("userId") String userId,GovernancePolicyLink governancePolicyLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernancePolicyLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernancePolicyLinkMapper.mapGovernancePolicyLinkToOmrsRelationship(governancePolicyLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernancePolicyLink updatedGovernancePolicyLink = GovernancePolicyLinkMapper.mapOmrsRelationshipToGovernancePolicyLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernancePolicyLink;
    }

     public void deleteGovernancePolicyLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernancePolicyLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernancePolicyLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governancePolicyLink
             }
     }
     public void purgeGovernancePolicyLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernancePolicyLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernancePolicyLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governancePolicyLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/responsibilityStaffContacts")

    public ResponsibilityStaffContact createResponsibilityStaffContactRelationship(@PathVariable("userId") String userId,ResponsibilityStaffContact relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createResponsibilityStaffContactRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ResponsibilityStaffContactMapper.mapResponsibilityStaffContactToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ResponsibilityStaffContact reclassifiedResponsibilityStaffContact =  ResponsibilityStaffContactMapper.mapOmrsRelationshipToResponsibilityStaffContact(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedResponsibilityStaffContact;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/responsibilityStaffContacts")

    public ResponsibilityStaffContact getResponsibilityStaffContactRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getResponsibilityStaffContactRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ResponsibilityStaffContact gotResponsibilityStaffContact = ResponsibilityStaffContactMapper.mapOmrsRelationshipToResponsibilityStaffContact(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotResponsibilityStaffContact;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/responsibilityStaffContacts")
    public ResponsibilityStaffContact updateResponsibilityStaffContactRelationship(@PathVariable("userId") String userId,ResponsibilityStaffContact responsibilityStaffContact)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateResponsibilityStaffContactRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ResponsibilityStaffContactMapper.mapResponsibilityStaffContactToOmrsRelationship(responsibilityStaffContact);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ResponsibilityStaffContact updatedResponsibilityStaffContact = ResponsibilityStaffContactMapper.mapOmrsRelationshipToResponsibilityStaffContact(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedResponsibilityStaffContact;
    }

     public void deleteResponsibilityStaffContactRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteResponsibilityStaffContactRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ResponsibilityStaffContact")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type responsibilityStaffContact
             }
     }
     public void purgeResponsibilityStaffContactRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeResponsibilityStaffContactRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ResponsibilityStaffContact")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type responsibilityStaffContact
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/peers")

    public Peer createPeerRelationship(@PathVariable("userId") String userId,Peer relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createPeerRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = PeerMapper.mapPeerToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Peer reclassifiedPeer =  PeerMapper.mapOmrsRelationshipToPeer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedPeer;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/peers")

    public Peer getPeerRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getPeerRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Peer gotPeer = PeerMapper.mapOmrsRelationshipToPeer(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotPeer;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/peers")
    public Peer updatePeerRelationship(@PathVariable("userId") String userId,Peer peer)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updatePeerRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = PeerMapper.mapPeerToOmrsRelationship(peer);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Peer updatedPeer = PeerMapper.mapOmrsRelationshipToPeer(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedPeer;
    }

     public void deletePeerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deletePeerRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Peer")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type peer
             }
     }
     public void purgePeerRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgePeerRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Peer")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type peer
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/termTYPEDBYRelationships")

    public TermTYPEDBYRelationship createTermTYPEDBYRelationshipRelationship(@PathVariable("userId") String userId,TermTYPEDBYRelationship relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTermTYPEDBYRelationshipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TermTYPEDBYRelationshipMapper.mapTermTYPEDBYRelationshipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        TermTYPEDBYRelationship reclassifiedTermTYPEDBYRelationship =  TermTYPEDBYRelationshipMapper.mapOmrsRelationshipToTermTYPEDBYRelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTermTYPEDBYRelationship;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/termTYPEDBYRelationships")

    public TermTYPEDBYRelationship getTermTYPEDBYRelationshipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTermTYPEDBYRelationshipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            TermTYPEDBYRelationship gotTermTYPEDBYRelationship = TermTYPEDBYRelationshipMapper.mapOmrsRelationshipToTermTYPEDBYRelationship(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTermTYPEDBYRelationship;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/termTYPEDBYRelationships")
    public TermTYPEDBYRelationship updateTermTYPEDBYRelationshipRelationship(@PathVariable("userId") String userId,TermTYPEDBYRelationship termTYPEDBYRelationship)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTermTYPEDBYRelationshipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TermTYPEDBYRelationshipMapper.mapTermTYPEDBYRelationshipToOmrsRelationship(termTYPEDBYRelationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        TermTYPEDBYRelationship updatedTermTYPEDBYRelationship = TermTYPEDBYRelationshipMapper.mapOmrsRelationshipToTermTYPEDBYRelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTermTYPEDBYRelationship;
    }

     public void deleteTermTYPEDBYRelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTermTYPEDBYRelationshipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("TermTYPEDBYRelationship")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type termTYPEDBYRelationship
             }
     }
     public void purgeTermTYPEDBYRelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTermTYPEDBYRelationshipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("TermTYPEDBYRelationship")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type termTYPEDBYRelationship
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/mapFromElementTypes")

    public MapFromElementType createMapFromElementTypeRelationship(@PathVariable("userId") String userId,MapFromElementType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createMapFromElementTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = MapFromElementTypeMapper.mapMapFromElementTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        MapFromElementType reclassifiedMapFromElementType =  MapFromElementTypeMapper.mapOmrsRelationshipToMapFromElementType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedMapFromElementType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/mapFromElementTypes")

    public MapFromElementType getMapFromElementTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getMapFromElementTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            MapFromElementType gotMapFromElementType = MapFromElementTypeMapper.mapOmrsRelationshipToMapFromElementType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotMapFromElementType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/mapFromElementTypes")
    public MapFromElementType updateMapFromElementTypeRelationship(@PathVariable("userId") String userId,MapFromElementType mapFromElementType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateMapFromElementTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = MapFromElementTypeMapper.mapMapFromElementTypeToOmrsRelationship(mapFromElementType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        MapFromElementType updatedMapFromElementType = MapFromElementTypeMapper.mapOmrsRelationshipToMapFromElementType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedMapFromElementType;
    }

     public void deleteMapFromElementTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteMapFromElementTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("MapFromElementType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type mapFromElementType
             }
     }
     public void purgeMapFromElementTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeMapFromElementTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("MapFromElementType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type mapFromElementType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/certifications")

    public Certification createCertificationRelationship(@PathVariable("userId") String userId,Certification relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCertificationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CertificationMapper.mapCertificationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Certification reclassifiedCertification =  CertificationMapper.mapOmrsRelationshipToCertification(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCertification;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/certifications")

    public Certification getCertificationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCertificationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Certification gotCertification = CertificationMapper.mapOmrsRelationshipToCertification(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCertification;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/certifications")
    public Certification updateCertificationRelationship(@PathVariable("userId") String userId,Certification certification)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCertificationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CertificationMapper.mapCertificationToOmrsRelationship(certification);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Certification updatedCertification = CertificationMapper.mapOmrsRelationshipToCertification(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCertification;
    }

     public void deleteCertificationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCertificationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Certification")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type certification
             }
     }
     public void purgeCertificationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCertificationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Certification")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type certification
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/networkGatewayLinks")

    public NetworkGatewayLink createNetworkGatewayLinkRelationship(@PathVariable("userId") String userId,NetworkGatewayLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createNetworkGatewayLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = NetworkGatewayLinkMapper.mapNetworkGatewayLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        NetworkGatewayLink reclassifiedNetworkGatewayLink =  NetworkGatewayLinkMapper.mapOmrsRelationshipToNetworkGatewayLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedNetworkGatewayLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/networkGatewayLinks")

    public NetworkGatewayLink getNetworkGatewayLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getNetworkGatewayLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            NetworkGatewayLink gotNetworkGatewayLink = NetworkGatewayLinkMapper.mapOmrsRelationshipToNetworkGatewayLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotNetworkGatewayLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/networkGatewayLinks")
    public NetworkGatewayLink updateNetworkGatewayLinkRelationship(@PathVariable("userId") String userId,NetworkGatewayLink networkGatewayLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateNetworkGatewayLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = NetworkGatewayLinkMapper.mapNetworkGatewayLinkToOmrsRelationship(networkGatewayLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        NetworkGatewayLink updatedNetworkGatewayLink = NetworkGatewayLinkMapper.mapOmrsRelationshipToNetworkGatewayLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedNetworkGatewayLink;
    }

     public void deleteNetworkGatewayLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteNetworkGatewayLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("NetworkGatewayLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type networkGatewayLink
             }
     }
     public void purgeNetworkGatewayLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeNetworkGatewayLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("NetworkGatewayLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type networkGatewayLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/connectionConnectorTypes")

    public ConnectionConnectorType createConnectionConnectorTypeRelationship(@PathVariable("userId") String userId,ConnectionConnectorType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createConnectionConnectorTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ConnectionConnectorTypeMapper.mapConnectionConnectorTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ConnectionConnectorType reclassifiedConnectionConnectorType =  ConnectionConnectorTypeMapper.mapOmrsRelationshipToConnectionConnectorType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedConnectionConnectorType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/connectionConnectorTypes")

    public ConnectionConnectorType getConnectionConnectorTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getConnectionConnectorTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ConnectionConnectorType gotConnectionConnectorType = ConnectionConnectorTypeMapper.mapOmrsRelationshipToConnectionConnectorType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotConnectionConnectorType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/connectionConnectorTypes")
    public ConnectionConnectorType updateConnectionConnectorTypeRelationship(@PathVariable("userId") String userId,ConnectionConnectorType connectionConnectorType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateConnectionConnectorTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ConnectionConnectorTypeMapper.mapConnectionConnectorTypeToOmrsRelationship(connectionConnectorType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ConnectionConnectorType updatedConnectionConnectorType = ConnectionConnectorTypeMapper.mapOmrsRelationshipToConnectionConnectorType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedConnectionConnectorType;
    }

     public void deleteConnectionConnectorTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteConnectionConnectorTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ConnectionConnectorType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type connectionConnectorType
             }
     }
     public void purgeConnectionConnectorTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeConnectionConnectorTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ConnectionConnectorType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type connectionConnectorType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/synonyms")

    public Synonym createSynonymRelationship(@PathVariable("userId") String userId,Synonym relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSynonymRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SynonymMapper.mapSynonymToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Synonym reclassifiedSynonym =  SynonymMapper.mapOmrsRelationshipToSynonym(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSynonym;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/synonyms")

    public Synonym getSynonymRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSynonymRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Synonym gotSynonym = SynonymMapper.mapOmrsRelationshipToSynonym(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSynonym;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/synonyms")
    public Synonym updateSynonymRelationship(@PathVariable("userId") String userId,Synonym synonym)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSynonymRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SynonymMapper.mapSynonymToOmrsRelationship(synonym);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Synonym updatedSynonym = SynonymMapper.mapOmrsRelationshipToSynonym(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSynonym;
    }

     public void deleteSynonymRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSynonymRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Synonym")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type synonym
             }
     }
     public void purgeSynonymRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSynonymRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Synonym")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type synonym
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/antonyms")

    public Antonym createAntonymRelationship(@PathVariable("userId") String userId,Antonym relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAntonymRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AntonymMapper.mapAntonymToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Antonym reclassifiedAntonym =  AntonymMapper.mapOmrsRelationshipToAntonym(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAntonym;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/antonyms")

    public Antonym getAntonymRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAntonymRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Antonym gotAntonym = AntonymMapper.mapOmrsRelationshipToAntonym(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAntonym;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/antonyms")
    public Antonym updateAntonymRelationship(@PathVariable("userId") String userId,Antonym antonym)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAntonymRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AntonymMapper.mapAntonymToOmrsRelationship(antonym);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Antonym updatedAntonym = AntonymMapper.mapOmrsRelationshipToAntonym(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAntonym;
    }

     public void deleteAntonymRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAntonymRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Antonym")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type antonym
             }
     }
     public void purgeAntonymRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAntonymRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Antonym")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type antonym
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/graphEdgeLinks")

    public GraphEdgeLink createGraphEdgeLinkRelationship(@PathVariable("userId") String userId,GraphEdgeLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGraphEdgeLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GraphEdgeLinkMapper.mapGraphEdgeLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GraphEdgeLink reclassifiedGraphEdgeLink =  GraphEdgeLinkMapper.mapOmrsRelationshipToGraphEdgeLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGraphEdgeLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/graphEdgeLinks")

    public GraphEdgeLink getGraphEdgeLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGraphEdgeLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GraphEdgeLink gotGraphEdgeLink = GraphEdgeLinkMapper.mapOmrsRelationshipToGraphEdgeLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGraphEdgeLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/graphEdgeLinks")
    public GraphEdgeLink updateGraphEdgeLinkRelationship(@PathVariable("userId") String userId,GraphEdgeLink graphEdgeLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGraphEdgeLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GraphEdgeLinkMapper.mapGraphEdgeLinkToOmrsRelationship(graphEdgeLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GraphEdgeLink updatedGraphEdgeLink = GraphEdgeLinkMapper.mapOmrsRelationshipToGraphEdgeLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGraphEdgeLink;
    }

     public void deleteGraphEdgeLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGraphEdgeLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GraphEdgeLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type graphEdgeLink
             }
     }
     public void purgeGraphEdgeLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGraphEdgeLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GraphEdgeLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type graphEdgeLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/toDoOnReferenceables")

    public ToDoOnReferenceable createToDoOnReferenceableRelationship(@PathVariable("userId") String userId,ToDoOnReferenceable relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createToDoOnReferenceableRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ToDoOnReferenceableMapper.mapToDoOnReferenceableToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ToDoOnReferenceable reclassifiedToDoOnReferenceable =  ToDoOnReferenceableMapper.mapOmrsRelationshipToToDoOnReferenceable(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedToDoOnReferenceable;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/toDoOnReferenceables")

    public ToDoOnReferenceable getToDoOnReferenceableRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getToDoOnReferenceableRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ToDoOnReferenceable gotToDoOnReferenceable = ToDoOnReferenceableMapper.mapOmrsRelationshipToToDoOnReferenceable(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotToDoOnReferenceable;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/toDoOnReferenceables")
    public ToDoOnReferenceable updateToDoOnReferenceableRelationship(@PathVariable("userId") String userId,ToDoOnReferenceable toDoOnReferenceable)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateToDoOnReferenceableRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ToDoOnReferenceableMapper.mapToDoOnReferenceableToOmrsRelationship(toDoOnReferenceable);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ToDoOnReferenceable updatedToDoOnReferenceable = ToDoOnReferenceableMapper.mapOmrsRelationshipToToDoOnReferenceable(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedToDoOnReferenceable;
    }

     public void deleteToDoOnReferenceableRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteToDoOnReferenceableRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ToDoOnReferenceable")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type toDoOnReferenceable
             }
     }
     public void purgeToDoOnReferenceableRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeToDoOnReferenceableRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ToDoOnReferenceable")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type toDoOnReferenceable
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectScopes")

    public ProjectScope createProjectScopeRelationship(@PathVariable("userId") String userId,ProjectScope relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectScopeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectScopeMapper.mapProjectScopeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectScope reclassifiedProjectScope =  ProjectScopeMapper.mapOmrsRelationshipToProjectScope(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectScope;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectScopes")

    public ProjectScope getProjectScopeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectScopeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectScope gotProjectScope = ProjectScopeMapper.mapOmrsRelationshipToProjectScope(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectScope;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectScopes")
    public ProjectScope updateProjectScopeRelationship(@PathVariable("userId") String userId,ProjectScope projectScope)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectScopeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectScopeMapper.mapProjectScopeToOmrsRelationship(projectScope);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectScope updatedProjectScope = ProjectScopeMapper.mapOmrsRelationshipToProjectScope(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectScope;
    }

     public void deleteProjectScopeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectScopeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectScope")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectScope
             }
     }
     public void purgeProjectScopeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectScopeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectScope")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectScope
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/iSARelationships")

    public ISARelationship createISARelationshipRelationship(@PathVariable("userId") String userId,ISARelationship relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createISARelationshipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ISARelationshipMapper.mapISARelationshipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ISARelationship reclassifiedISARelationship =  ISARelationshipMapper.mapOmrsRelationshipToISARelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedISARelationship;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/iSARelationships")

    public ISARelationship getISARelationshipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getISARelationshipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ISARelationship gotISARelationship = ISARelationshipMapper.mapOmrsRelationshipToISARelationship(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotISARelationship;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/iSARelationships")
    public ISARelationship updateISARelationshipRelationship(@PathVariable("userId") String userId,ISARelationship iSARelationship)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateISARelationshipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ISARelationshipMapper.mapISARelationshipToOmrsRelationship(iSARelationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ISARelationship updatedISARelationship = ISARelationshipMapper.mapOmrsRelationshipToISARelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedISARelationship;
    }

     public void deleteISARelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteISARelationshipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ISARelationship")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type iSARelationship
             }
     }
     public void purgeISARelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeISARelationshipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ISARelationship")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type iSARelationship
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/termISATypeOFRelationships")

    public TermISATypeOFRelationship createTermISATypeOFRelationshipRelationship(@PathVariable("userId") String userId,TermISATypeOFRelationship relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTermISATypeOFRelationshipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TermISATypeOFRelationshipMapper.mapTermISATypeOFRelationshipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        TermISATypeOFRelationship reclassifiedTermISATypeOFRelationship =  TermISATypeOFRelationshipMapper.mapOmrsRelationshipToTermISATypeOFRelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTermISATypeOFRelationship;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/termISATypeOFRelationships")

    public TermISATypeOFRelationship getTermISATypeOFRelationshipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTermISATypeOFRelationshipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            TermISATypeOFRelationship gotTermISATypeOFRelationship = TermISATypeOFRelationshipMapper.mapOmrsRelationshipToTermISATypeOFRelationship(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTermISATypeOFRelationship;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/termISATypeOFRelationships")
    public TermISATypeOFRelationship updateTermISATypeOFRelationshipRelationship(@PathVariable("userId") String userId,TermISATypeOFRelationship termISATypeOFRelationship)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTermISATypeOFRelationshipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TermISATypeOFRelationshipMapper.mapTermISATypeOFRelationshipToOmrsRelationship(termISATypeOFRelationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        TermISATypeOFRelationship updatedTermISATypeOFRelationship = TermISATypeOFRelationshipMapper.mapOmrsRelationshipToTermISATypeOFRelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTermISATypeOFRelationship;
    }

     public void deleteTermISATypeOFRelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTermISATypeOFRelationshipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("TermISATypeOFRelationship")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type termISATypeOFRelationship
             }
     }
     public void purgeTermISATypeOFRelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTermISATypeOFRelationshipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("TermISATypeOFRelationship")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type termISATypeOFRelationship
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/contributors")

    public Contributor createContributorRelationship(@PathVariable("userId") String userId,Contributor relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createContributorRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ContributorMapper.mapContributorToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        Contributor reclassifiedContributor =  ContributorMapper.mapOmrsRelationshipToContributor(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedContributor;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/contributors")

    public Contributor getContributorRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getContributorRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            Contributor gotContributor = ContributorMapper.mapOmrsRelationshipToContributor(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotContributor;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/contributors")
    public Contributor updateContributorRelationship(@PathVariable("userId") String userId,Contributor contributor)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateContributorRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ContributorMapper.mapContributorToOmrsRelationship(contributor);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        Contributor updatedContributor = ContributorMapper.mapOmrsRelationshipToContributor(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedContributor;
    }

     public void deleteContributorRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteContributorRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("Contributor")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type contributor
             }
     }
     public void purgeContributorRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeContributorRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("Contributor")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type contributor
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/embeddedConnections")

    public EmbeddedConnection createEmbeddedConnectionRelationship(@PathVariable("userId") String userId,EmbeddedConnection relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createEmbeddedConnectionRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = EmbeddedConnectionMapper.mapEmbeddedConnectionToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        EmbeddedConnection reclassifiedEmbeddedConnection =  EmbeddedConnectionMapper.mapOmrsRelationshipToEmbeddedConnection(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedEmbeddedConnection;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/embeddedConnections")

    public EmbeddedConnection getEmbeddedConnectionRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getEmbeddedConnectionRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            EmbeddedConnection gotEmbeddedConnection = EmbeddedConnectionMapper.mapOmrsRelationshipToEmbeddedConnection(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotEmbeddedConnection;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/embeddedConnections")
    public EmbeddedConnection updateEmbeddedConnectionRelationship(@PathVariable("userId") String userId,EmbeddedConnection embeddedConnection)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateEmbeddedConnectionRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = EmbeddedConnectionMapper.mapEmbeddedConnectionToOmrsRelationship(embeddedConnection);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        EmbeddedConnection updatedEmbeddedConnection = EmbeddedConnectionMapper.mapOmrsRelationshipToEmbeddedConnection(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedEmbeddedConnection;
    }

     public void deleteEmbeddedConnectionRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteEmbeddedConnectionRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("EmbeddedConnection")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type embeddedConnection
             }
     }
     public void purgeEmbeddedConnectionRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeEmbeddedConnectionRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("EmbeddedConnection")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type embeddedConnection
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceControlLinks")

    public GovernanceControlLink createGovernanceControlLinkRelationship(@PathVariable("userId") String userId,GovernanceControlLink relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceControlLinkRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceControlLinkMapper.mapGovernanceControlLinkToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceControlLink reclassifiedGovernanceControlLink =  GovernanceControlLinkMapper.mapOmrsRelationshipToGovernanceControlLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceControlLink;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceControlLinks")

    public GovernanceControlLink getGovernanceControlLinkRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceControlLinkRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceControlLink gotGovernanceControlLink = GovernanceControlLinkMapper.mapOmrsRelationshipToGovernanceControlLink(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceControlLink;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceControlLinks")
    public GovernanceControlLink updateGovernanceControlLinkRelationship(@PathVariable("userId") String userId,GovernanceControlLink governanceControlLink)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceControlLinkRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceControlLinkMapper.mapGovernanceControlLinkToOmrsRelationship(governanceControlLink);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceControlLink updatedGovernanceControlLink = GovernanceControlLinkMapper.mapOmrsRelationshipToGovernanceControlLink(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceControlLink;
    }

     public void deleteGovernanceControlLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceControlLinkRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceControlLink")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceControlLink
             }
     }
     public void purgeGovernanceControlLinkRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceControlLinkRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceControlLink")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceControlLink
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attachedRatings")

    public AttachedRating createAttachedRatingRelationship(@PathVariable("userId") String userId,AttachedRating relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttachedRatingRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttachedRatingMapper.mapAttachedRatingToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttachedRating reclassifiedAttachedRating =  AttachedRatingMapper.mapOmrsRelationshipToAttachedRating(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttachedRating;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attachedRatings")

    public AttachedRating getAttachedRatingRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttachedRatingRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttachedRating gotAttachedRating = AttachedRatingMapper.mapOmrsRelationshipToAttachedRating(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttachedRating;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attachedRatings")
    public AttachedRating updateAttachedRatingRelationship(@PathVariable("userId") String userId,AttachedRating attachedRating)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttachedRatingRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttachedRatingMapper.mapAttachedRatingToOmrsRelationship(attachedRating);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttachedRating updatedAttachedRating = AttachedRatingMapper.mapOmrsRelationshipToAttachedRating(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttachedRating;
    }

     public void deleteAttachedRatingRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttachedRatingRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttachedRating")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attachedRating
             }
     }
     public void purgeAttachedRatingRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttachedRatingRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttachedRating")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attachedRating
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attachedNoteLogs")

    public AttachedNoteLog createAttachedNoteLogRelationship(@PathVariable("userId") String userId,AttachedNoteLog relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttachedNoteLogRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttachedNoteLogMapper.mapAttachedNoteLogToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttachedNoteLog reclassifiedAttachedNoteLog =  AttachedNoteLogMapper.mapOmrsRelationshipToAttachedNoteLog(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttachedNoteLog;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attachedNoteLogs")

    public AttachedNoteLog getAttachedNoteLogRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttachedNoteLogRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttachedNoteLog gotAttachedNoteLog = AttachedNoteLogMapper.mapOmrsRelationshipToAttachedNoteLog(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttachedNoteLog;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attachedNoteLogs")
    public AttachedNoteLog updateAttachedNoteLogRelationship(@PathVariable("userId") String userId,AttachedNoteLog attachedNoteLog)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttachedNoteLogRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttachedNoteLogMapper.mapAttachedNoteLogToOmrsRelationship(attachedNoteLog);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttachedNoteLog updatedAttachedNoteLog = AttachedNoteLogMapper.mapOmrsRelationshipToAttachedNoteLog(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttachedNoteLog;
    }

     public void deleteAttachedNoteLogRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttachedNoteLogRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttachedNoteLog")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attachedNoteLog
             }
     }
     public void purgeAttachedNoteLogRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttachedNoteLogRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttachedNoteLog")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attachedNoteLog
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/connectionToAssets")

    public ConnectionToAsset createConnectionToAssetRelationship(@PathVariable("userId") String userId,ConnectionToAsset relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createConnectionToAssetRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ConnectionToAssetMapper.mapConnectionToAssetToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ConnectionToAsset reclassifiedConnectionToAsset =  ConnectionToAssetMapper.mapOmrsRelationshipToConnectionToAsset(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedConnectionToAsset;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/connectionToAssets")

    public ConnectionToAsset getConnectionToAssetRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getConnectionToAssetRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ConnectionToAsset gotConnectionToAsset = ConnectionToAssetMapper.mapOmrsRelationshipToConnectionToAsset(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotConnectionToAsset;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/connectionToAssets")
    public ConnectionToAsset updateConnectionToAssetRelationship(@PathVariable("userId") String userId,ConnectionToAsset connectionToAsset)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateConnectionToAssetRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ConnectionToAssetMapper.mapConnectionToAssetToOmrsRelationship(connectionToAsset);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ConnectionToAsset updatedConnectionToAsset = ConnectionToAssetMapper.mapOmrsRelationshipToConnectionToAsset(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedConnectionToAsset;
    }

     public void deleteConnectionToAssetRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteConnectionToAssetRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ConnectionToAsset")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type connectionToAsset
             }
     }
     public void purgeConnectionToAssetRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeConnectionToAssetRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ConnectionToAsset")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type connectionToAsset
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/regulationCertificationTypes")

    public RegulationCertificationType createRegulationCertificationTypeRelationship(@PathVariable("userId") String userId,RegulationCertificationType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createRegulationCertificationTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = RegulationCertificationTypeMapper.mapRegulationCertificationTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        RegulationCertificationType reclassifiedRegulationCertificationType =  RegulationCertificationTypeMapper.mapOmrsRelationshipToRegulationCertificationType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedRegulationCertificationType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/regulationCertificationTypes")

    public RegulationCertificationType getRegulationCertificationTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getRegulationCertificationTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            RegulationCertificationType gotRegulationCertificationType = RegulationCertificationTypeMapper.mapOmrsRelationshipToRegulationCertificationType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotRegulationCertificationType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/regulationCertificationTypes")
    public RegulationCertificationType updateRegulationCertificationTypeRelationship(@PathVariable("userId") String userId,RegulationCertificationType regulationCertificationType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateRegulationCertificationTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = RegulationCertificationTypeMapper.mapRegulationCertificationTypeToOmrsRelationship(regulationCertificationType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        RegulationCertificationType updatedRegulationCertificationType = RegulationCertificationTypeMapper.mapOmrsRelationshipToRegulationCertificationType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedRegulationCertificationType;
    }

     public void deleteRegulationCertificationTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteRegulationCertificationTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("RegulationCertificationType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type regulationCertificationType
             }
     }
     public void purgeRegulationCertificationTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeRegulationCertificationTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("RegulationCertificationType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type regulationCertificationType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/linkedTypes")

    public LinkedType createLinkedTypeRelationship(@PathVariable("userId") String userId,LinkedType relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createLinkedTypeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = LinkedTypeMapper.mapLinkedTypeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        LinkedType reclassifiedLinkedType =  LinkedTypeMapper.mapOmrsRelationshipToLinkedType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedLinkedType;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/linkedTypes")

    public LinkedType getLinkedTypeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getLinkedTypeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            LinkedType gotLinkedType = LinkedTypeMapper.mapOmrsRelationshipToLinkedType(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotLinkedType;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/linkedTypes")
    public LinkedType updateLinkedTypeRelationship(@PathVariable("userId") String userId,LinkedType linkedType)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateLinkedTypeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = LinkedTypeMapper.mapLinkedTypeToOmrsRelationship(linkedType);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        LinkedType updatedLinkedType = LinkedTypeMapper.mapOmrsRelationshipToLinkedType(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedLinkedType;
    }

     public void deleteLinkedTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteLinkedTypeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("LinkedType")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type linkedType
             }
     }
     public void purgeLinkedTypeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeLinkedTypeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("LinkedType")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type linkedType
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceRuleImplementations")

    public GovernanceRuleImplementation createGovernanceRuleImplementationRelationship(@PathVariable("userId") String userId,GovernanceRuleImplementation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceRuleImplementationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceRuleImplementationMapper.mapGovernanceRuleImplementationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceRuleImplementation reclassifiedGovernanceRuleImplementation =  GovernanceRuleImplementationMapper.mapOmrsRelationshipToGovernanceRuleImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceRuleImplementation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceRuleImplementations")

    public GovernanceRuleImplementation getGovernanceRuleImplementationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceRuleImplementationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceRuleImplementation gotGovernanceRuleImplementation = GovernanceRuleImplementationMapper.mapOmrsRelationshipToGovernanceRuleImplementation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceRuleImplementation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceRuleImplementations")
    public GovernanceRuleImplementation updateGovernanceRuleImplementationRelationship(@PathVariable("userId") String userId,GovernanceRuleImplementation governanceRuleImplementation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceRuleImplementationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceRuleImplementationMapper.mapGovernanceRuleImplementationToOmrsRelationship(governanceRuleImplementation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceRuleImplementation updatedGovernanceRuleImplementation = GovernanceRuleImplementationMapper.mapOmrsRelationshipToGovernanceRuleImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceRuleImplementation;
    }

     public void deleteGovernanceRuleImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceRuleImplementationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceRuleImplementation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceRuleImplementation
             }
     }
     public void purgeGovernanceRuleImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceRuleImplementationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceRuleImplementation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceRuleImplementation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/adjacentLocations")

    public AdjacentLocation createAdjacentLocationRelationship(@PathVariable("userId") String userId,AdjacentLocation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAdjacentLocationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AdjacentLocationMapper.mapAdjacentLocationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AdjacentLocation reclassifiedAdjacentLocation =  AdjacentLocationMapper.mapOmrsRelationshipToAdjacentLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAdjacentLocation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/adjacentLocations")

    public AdjacentLocation getAdjacentLocationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAdjacentLocationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AdjacentLocation gotAdjacentLocation = AdjacentLocationMapper.mapOmrsRelationshipToAdjacentLocation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAdjacentLocation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/adjacentLocations")
    public AdjacentLocation updateAdjacentLocationRelationship(@PathVariable("userId") String userId,AdjacentLocation adjacentLocation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAdjacentLocationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AdjacentLocationMapper.mapAdjacentLocationToOmrsRelationship(adjacentLocation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AdjacentLocation updatedAdjacentLocation = AdjacentLocationMapper.mapOmrsRelationshipToAdjacentLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAdjacentLocation;
    }

     public void deleteAdjacentLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAdjacentLocationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AdjacentLocation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type adjacentLocation
             }
     }
     public void purgeAdjacentLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAdjacentLocationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AdjacentLocation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type adjacentLocation
                  }
          }

// Not required as a rest API for the Subject Area OMAS. 

    public SemanticAssignment createSemanticAssignmentRelationship(@PathVariable("userId") String userId,SemanticAssignment relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSemanticAssignmentRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SemanticAssignmentMapper.mapSemanticAssignmentToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        SemanticAssignment reclassifiedSemanticAssignment =  SemanticAssignmentMapper.mapOmrsRelationshipToSemanticAssignment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSemanticAssignment;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/semanticAssignments")

    public SemanticAssignment getSemanticAssignmentRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSemanticAssignmentRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            SemanticAssignment gotSemanticAssignment = SemanticAssignmentMapper.mapOmrsRelationshipToSemanticAssignment(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSemanticAssignment;
        }
// Not required as a rest API for the Subject Area OMAS. 
    public SemanticAssignment updateSemanticAssignmentRelationship(@PathVariable("userId") String userId,SemanticAssignment semanticAssignment)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSemanticAssignmentRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SemanticAssignmentMapper.mapSemanticAssignmentToOmrsRelationship(semanticAssignment);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        SemanticAssignment updatedSemanticAssignment = SemanticAssignmentMapper.mapOmrsRelationshipToSemanticAssignment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSemanticAssignment;
    }

     public void deleteSemanticAssignmentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSemanticAssignmentRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("SemanticAssignment")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type semanticAssignment
             }
     }
     public void purgeSemanticAssignmentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSemanticAssignmentRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("SemanticAssignment")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type semanticAssignment
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/hostLocations")

    public HostLocation createHostLocationRelationship(@PathVariable("userId") String userId,HostLocation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createHostLocationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = HostLocationMapper.mapHostLocationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        HostLocation reclassifiedHostLocation =  HostLocationMapper.mapOmrsRelationshipToHostLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedHostLocation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/hostLocations")

    public HostLocation getHostLocationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getHostLocationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            HostLocation gotHostLocation = HostLocationMapper.mapOmrsRelationshipToHostLocation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotHostLocation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/hostLocations")
    public HostLocation updateHostLocationRelationship(@PathVariable("userId") String userId,HostLocation hostLocation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateHostLocationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = HostLocationMapper.mapHostLocationToOmrsRelationship(hostLocation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        HostLocation updatedHostLocation = HostLocationMapper.mapOmrsRelationshipToHostLocation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedHostLocation;
    }

     public void deleteHostLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteHostLocationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("HostLocation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type hostLocation
             }
     }
     public void purgeHostLocationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeHostLocationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("HostLocation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type hostLocation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/serverDeployments")

    public ServerDeployment createServerDeploymentRelationship(@PathVariable("userId") String userId,ServerDeployment relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createServerDeploymentRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ServerDeploymentMapper.mapServerDeploymentToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ServerDeployment reclassifiedServerDeployment =  ServerDeploymentMapper.mapOmrsRelationshipToServerDeployment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedServerDeployment;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/serverDeployments")

    public ServerDeployment getServerDeploymentRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getServerDeploymentRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ServerDeployment gotServerDeployment = ServerDeploymentMapper.mapOmrsRelationshipToServerDeployment(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotServerDeployment;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/serverDeployments")
    public ServerDeployment updateServerDeploymentRelationship(@PathVariable("userId") String userId,ServerDeployment serverDeployment)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateServerDeploymentRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ServerDeploymentMapper.mapServerDeploymentToOmrsRelationship(serverDeployment);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ServerDeployment updatedServerDeployment = ServerDeploymentMapper.mapOmrsRelationshipToServerDeployment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedServerDeployment;
    }

     public void deleteServerDeploymentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteServerDeploymentRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ServerDeployment")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type serverDeployment
             }
     }
     public void purgeServerDeploymentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeServerDeploymentRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ServerDeployment")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type serverDeployment
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/relatedTerms")

    public RelatedTerm createRelatedTermRelationship(@PathVariable("userId") String userId,RelatedTerm relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createRelatedTermRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = RelatedTermMapper.mapRelatedTermToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        RelatedTerm reclassifiedRelatedTerm =  RelatedTermMapper.mapOmrsRelationshipToRelatedTerm(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedRelatedTerm;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/relatedTerms")

    public RelatedTerm getRelatedTermRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getRelatedTermRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            RelatedTerm gotRelatedTerm = RelatedTermMapper.mapOmrsRelationshipToRelatedTerm(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotRelatedTerm;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/relatedTerms")
    public RelatedTerm updateRelatedTermRelationship(@PathVariable("userId") String userId,RelatedTerm relatedTerm)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateRelatedTermRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = RelatedTermMapper.mapRelatedTermToOmrsRelationship(relatedTerm);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        RelatedTerm updatedRelatedTerm = RelatedTermMapper.mapOmrsRelationshipToRelatedTerm(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedRelatedTerm;
    }

     public void deleteRelatedTermRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteRelatedTermRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("RelatedTerm")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type relatedTerm
             }
     }
     public void purgeRelatedTermRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeRelatedTermRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("RelatedTerm")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type relatedTerm
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/schemaTypeImplementations")

    public SchemaTypeImplementation createSchemaTypeImplementationRelationship(@PathVariable("userId") String userId,SchemaTypeImplementation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSchemaTypeImplementationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SchemaTypeImplementationMapper.mapSchemaTypeImplementationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        SchemaTypeImplementation reclassifiedSchemaTypeImplementation =  SchemaTypeImplementationMapper.mapOmrsRelationshipToSchemaTypeImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSchemaTypeImplementation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/schemaTypeImplementations")

    public SchemaTypeImplementation getSchemaTypeImplementationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSchemaTypeImplementationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            SchemaTypeImplementation gotSchemaTypeImplementation = SchemaTypeImplementationMapper.mapOmrsRelationshipToSchemaTypeImplementation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSchemaTypeImplementation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/schemaTypeImplementations")
    public SchemaTypeImplementation updateSchemaTypeImplementationRelationship(@PathVariable("userId") String userId,SchemaTypeImplementation schemaTypeImplementation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSchemaTypeImplementationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SchemaTypeImplementationMapper.mapSchemaTypeImplementationToOmrsRelationship(schemaTypeImplementation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        SchemaTypeImplementation updatedSchemaTypeImplementation = SchemaTypeImplementationMapper.mapOmrsRelationshipToSchemaTypeImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSchemaTypeImplementation;
    }

     public void deleteSchemaTypeImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSchemaTypeImplementationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("SchemaTypeImplementation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type schemaTypeImplementation
             }
     }
     public void purgeSchemaTypeImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSchemaTypeImplementationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("SchemaTypeImplementation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type schemaTypeImplementation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/processInputs")

    public ProcessInput createProcessInputRelationship(@PathVariable("userId") String userId,ProcessInput relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProcessInputRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProcessInputMapper.mapProcessInputToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProcessInput reclassifiedProcessInput =  ProcessInputMapper.mapOmrsRelationshipToProcessInput(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProcessInput;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/processInputs")

    public ProcessInput getProcessInputRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProcessInputRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProcessInput gotProcessInput = ProcessInputMapper.mapOmrsRelationshipToProcessInput(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProcessInput;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/processInputs")
    public ProcessInput updateProcessInputRelationship(@PathVariable("userId") String userId,ProcessInput processInput)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProcessInputRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProcessInputMapper.mapProcessInputToOmrsRelationship(processInput);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProcessInput updatedProcessInput = ProcessInputMapper.mapOmrsRelationshipToProcessInput(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProcessInput;
    }

     public void deleteProcessInputRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProcessInputRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProcessInput")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type processInput
             }
     }
     public void purgeProcessInputRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProcessInputRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProcessInput")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type processInput
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/aPIHeaders")

    public APIHeader createAPIHeaderRelationship(@PathVariable("userId") String userId,APIHeader relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAPIHeaderRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = APIHeaderMapper.mapAPIHeaderToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        APIHeader reclassifiedAPIHeader =  APIHeaderMapper.mapOmrsRelationshipToAPIHeader(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAPIHeader;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/aPIHeaders")

    public APIHeader getAPIHeaderRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAPIHeaderRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            APIHeader gotAPIHeader = APIHeaderMapper.mapOmrsRelationshipToAPIHeader(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAPIHeader;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/aPIHeaders")
    public APIHeader updateAPIHeaderRelationship(@PathVariable("userId") String userId,APIHeader aPIHeader)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAPIHeaderRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = APIHeaderMapper.mapAPIHeaderToOmrsRelationship(aPIHeader);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        APIHeader updatedAPIHeader = APIHeaderMapper.mapOmrsRelationshipToAPIHeader(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAPIHeader;
    }

     public void deleteAPIHeaderRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAPIHeaderRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("APIHeader")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type aPIHeader
             }
     }
     public void purgeAPIHeaderRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAPIHeaderRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("APIHeader")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type aPIHeader
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/meetingOnReferenceables")

    public MeetingOnReferenceable createMeetingOnReferenceableRelationship(@PathVariable("userId") String userId,MeetingOnReferenceable relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createMeetingOnReferenceableRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = MeetingOnReferenceableMapper.mapMeetingOnReferenceableToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        MeetingOnReferenceable reclassifiedMeetingOnReferenceable =  MeetingOnReferenceableMapper.mapOmrsRelationshipToMeetingOnReferenceable(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedMeetingOnReferenceable;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/meetingOnReferenceables")

    public MeetingOnReferenceable getMeetingOnReferenceableRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getMeetingOnReferenceableRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            MeetingOnReferenceable gotMeetingOnReferenceable = MeetingOnReferenceableMapper.mapOmrsRelationshipToMeetingOnReferenceable(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotMeetingOnReferenceable;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/meetingOnReferenceables")
    public MeetingOnReferenceable updateMeetingOnReferenceableRelationship(@PathVariable("userId") String userId,MeetingOnReferenceable meetingOnReferenceable)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateMeetingOnReferenceableRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = MeetingOnReferenceableMapper.mapMeetingOnReferenceableToOmrsRelationship(meetingOnReferenceable);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        MeetingOnReferenceable updatedMeetingOnReferenceable = MeetingOnReferenceableMapper.mapOmrsRelationshipToMeetingOnReferenceable(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedMeetingOnReferenceable;
    }

     public void deleteMeetingOnReferenceableRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteMeetingOnReferenceableRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("MeetingOnReferenceable")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type meetingOnReferenceable
             }
     }
     public void purgeMeetingOnReferenceableRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeMeetingOnReferenceableRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("MeetingOnReferenceable")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type meetingOnReferenceable
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attachedTags")

    public AttachedTag createAttachedTagRelationship(@PathVariable("userId") String userId,AttachedTag relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttachedTagRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttachedTagMapper.mapAttachedTagToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttachedTag reclassifiedAttachedTag =  AttachedTagMapper.mapOmrsRelationshipToAttachedTag(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttachedTag;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attachedTags")

    public AttachedTag getAttachedTagRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttachedTagRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttachedTag gotAttachedTag = AttachedTagMapper.mapOmrsRelationshipToAttachedTag(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttachedTag;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attachedTags")
    public AttachedTag updateAttachedTagRelationship(@PathVariable("userId") String userId,AttachedTag attachedTag)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttachedTagRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttachedTagMapper.mapAttachedTagToOmrsRelationship(attachedTag);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttachedTag updatedAttachedTag = AttachedTagMapper.mapOmrsRelationshipToAttachedTag(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttachedTag;
    }

     public void deleteAttachedTagRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttachedTagRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttachedTag")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attachedTag
             }
     }
     public void purgeAttachedTagRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttachedTagRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttachedTag")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attachedTag
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/termHASARelationships")

    public TermHASARelationship createTermHASARelationshipRelationship(@PathVariable("userId") String userId,TermHASARelationship relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTermHASARelationshipRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TermHASARelationshipMapper.mapTermHASARelationshipToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        TermHASARelationship reclassifiedTermHASARelationship =  TermHASARelationshipMapper.mapOmrsRelationshipToTermHASARelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTermHASARelationship;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/termHASARelationships")

    public TermHASARelationship getTermHASARelationshipRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTermHASARelationshipRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            TermHASARelationship gotTermHASARelationship = TermHASARelationshipMapper.mapOmrsRelationshipToTermHASARelationship(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTermHASARelationship;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/termHASARelationships")
    public TermHASARelationship updateTermHASARelationshipRelationship(@PathVariable("userId") String userId,TermHASARelationship termHASARelationship)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTermHASARelationshipRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TermHASARelationshipMapper.mapTermHASARelationshipToOmrsRelationship(termHASARelationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        TermHASARelationship updatedTermHASARelationship = TermHASARelationshipMapper.mapOmrsRelationshipToTermHASARelationship(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTermHASARelationship;
    }

     public void deleteTermHASARelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTermHASARelationshipRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("TermHASARelationship")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type termHASARelationship
             }
     }
     public void purgeTermHASARelationshipRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTermHASARelationshipRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("TermHASARelationship")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type termHASARelationship
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceProcessImplementations")

    public GovernanceProcessImplementation createGovernanceProcessImplementationRelationship(@PathVariable("userId") String userId,GovernanceProcessImplementation relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceProcessImplementationRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceProcessImplementationMapper.mapGovernanceProcessImplementationToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceProcessImplementation reclassifiedGovernanceProcessImplementation =  GovernanceProcessImplementationMapper.mapOmrsRelationshipToGovernanceProcessImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceProcessImplementation;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceProcessImplementations")

    public GovernanceProcessImplementation getGovernanceProcessImplementationRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceProcessImplementationRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceProcessImplementation gotGovernanceProcessImplementation = GovernanceProcessImplementationMapper.mapOmrsRelationshipToGovernanceProcessImplementation(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceProcessImplementation;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceProcessImplementations")
    public GovernanceProcessImplementation updateGovernanceProcessImplementationRelationship(@PathVariable("userId") String userId,GovernanceProcessImplementation governanceProcessImplementation)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceProcessImplementationRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceProcessImplementationMapper.mapGovernanceProcessImplementationToOmrsRelationship(governanceProcessImplementation);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceProcessImplementation updatedGovernanceProcessImplementation = GovernanceProcessImplementationMapper.mapOmrsRelationshipToGovernanceProcessImplementation(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceProcessImplementation;
    }

     public void deleteGovernanceProcessImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceProcessImplementationRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceProcessImplementation")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceProcessImplementation
             }
     }
     public void purgeGovernanceProcessImplementationRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceProcessImplementationRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceProcessImplementation")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceProcessImplementation
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/groupedMedias")

    public GroupedMedia createGroupedMediaRelationship(@PathVariable("userId") String userId,GroupedMedia relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGroupedMediaRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GroupedMediaMapper.mapGroupedMediaToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GroupedMedia reclassifiedGroupedMedia =  GroupedMediaMapper.mapOmrsRelationshipToGroupedMedia(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGroupedMedia;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/groupedMedias")

    public GroupedMedia getGroupedMediaRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGroupedMediaRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GroupedMedia gotGroupedMedia = GroupedMediaMapper.mapOmrsRelationshipToGroupedMedia(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGroupedMedia;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/groupedMedias")
    public GroupedMedia updateGroupedMediaRelationship(@PathVariable("userId") String userId,GroupedMedia groupedMedia)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGroupedMediaRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GroupedMediaMapper.mapGroupedMediaToOmrsRelationship(groupedMedia);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GroupedMedia updatedGroupedMedia = GroupedMediaMapper.mapOmrsRelationshipToGroupedMedia(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGroupedMedia;
    }

     public void deleteGroupedMediaRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGroupedMediaRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GroupedMedia")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type groupedMedia
             }
     }
     public void purgeGroupedMediaRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGroupedMediaRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GroupedMedia")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type groupedMedia
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/governanceResponses")

    public GovernanceResponse createGovernanceResponseRelationship(@PathVariable("userId") String userId,GovernanceResponse relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createGovernanceResponseRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = GovernanceResponseMapper.mapGovernanceResponseToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        GovernanceResponse reclassifiedGovernanceResponse =  GovernanceResponseMapper.mapOmrsRelationshipToGovernanceResponse(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedGovernanceResponse;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/governanceResponses")

    public GovernanceResponse getGovernanceResponseRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getGovernanceResponseRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            GovernanceResponse gotGovernanceResponse = GovernanceResponseMapper.mapOmrsRelationshipToGovernanceResponse(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotGovernanceResponse;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/governanceResponses")
    public GovernanceResponse updateGovernanceResponseRelationship(@PathVariable("userId") String userId,GovernanceResponse governanceResponse)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateGovernanceResponseRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = GovernanceResponseMapper.mapGovernanceResponseToOmrsRelationship(governanceResponse);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        GovernanceResponse updatedGovernanceResponse = GovernanceResponseMapper.mapOmrsRelationshipToGovernanceResponse(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedGovernanceResponse;
    }

     public void deleteGovernanceResponseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteGovernanceResponseRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("GovernanceResponse")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type governanceResponse
             }
     }
     public void purgeGovernanceResponseRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeGovernanceResponseRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("GovernanceResponse")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type governanceResponse
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/nestedFiles")

    public NestedFile createNestedFileRelationship(@PathVariable("userId") String userId,NestedFile relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createNestedFileRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = NestedFileMapper.mapNestedFileToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        NestedFile reclassifiedNestedFile =  NestedFileMapper.mapOmrsRelationshipToNestedFile(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedNestedFile;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/nestedFiles")

    public NestedFile getNestedFileRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getNestedFileRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            NestedFile gotNestedFile = NestedFileMapper.mapOmrsRelationshipToNestedFile(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotNestedFile;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/nestedFiles")
    public NestedFile updateNestedFileRelationship(@PathVariable("userId") String userId,NestedFile nestedFile)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateNestedFileRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = NestedFileMapper.mapNestedFileToOmrsRelationship(nestedFile);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        NestedFile updatedNestedFile = NestedFileMapper.mapOmrsRelationshipToNestedFile(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedNestedFile;
    }

     public void deleteNestedFileRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteNestedFileRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("NestedFile")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type nestedFile
             }
     }
     public void purgeNestedFileRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeNestedFileRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("NestedFile")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type nestedFile
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/hostOperatingPlatforms")

    public HostOperatingPlatform createHostOperatingPlatformRelationship(@PathVariable("userId") String userId,HostOperatingPlatform relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createHostOperatingPlatformRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = HostOperatingPlatformMapper.mapHostOperatingPlatformToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        HostOperatingPlatform reclassifiedHostOperatingPlatform =  HostOperatingPlatformMapper.mapOmrsRelationshipToHostOperatingPlatform(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedHostOperatingPlatform;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/hostOperatingPlatforms")

    public HostOperatingPlatform getHostOperatingPlatformRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getHostOperatingPlatformRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            HostOperatingPlatform gotHostOperatingPlatform = HostOperatingPlatformMapper.mapOmrsRelationshipToHostOperatingPlatform(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotHostOperatingPlatform;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/hostOperatingPlatforms")
    public HostOperatingPlatform updateHostOperatingPlatformRelationship(@PathVariable("userId") String userId,HostOperatingPlatform hostOperatingPlatform)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateHostOperatingPlatformRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = HostOperatingPlatformMapper.mapHostOperatingPlatformToOmrsRelationship(hostOperatingPlatform);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        HostOperatingPlatform updatedHostOperatingPlatform = HostOperatingPlatformMapper.mapOmrsRelationshipToHostOperatingPlatform(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedHostOperatingPlatform;
    }

     public void deleteHostOperatingPlatformRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteHostOperatingPlatformRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("HostOperatingPlatform")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type hostOperatingPlatform
             }
     }
     public void purgeHostOperatingPlatformRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeHostOperatingPlatformRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("HostOperatingPlatform")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type hostOperatingPlatform
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/actorCollections")

    public ActorCollection createActorCollectionRelationship(@PathVariable("userId") String userId,ActorCollection relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createActorCollectionRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ActorCollectionMapper.mapActorCollectionToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ActorCollection reclassifiedActorCollection =  ActorCollectionMapper.mapOmrsRelationshipToActorCollection(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedActorCollection;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/actorCollections")

    public ActorCollection getActorCollectionRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getActorCollectionRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ActorCollection gotActorCollection = ActorCollectionMapper.mapOmrsRelationshipToActorCollection(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotActorCollection;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/actorCollections")
    public ActorCollection updateActorCollectionRelationship(@PathVariable("userId") String userId,ActorCollection actorCollection)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateActorCollectionRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ActorCollectionMapper.mapActorCollectionToOmrsRelationship(actorCollection);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ActorCollection updatedActorCollection = ActorCollectionMapper.mapOmrsRelationshipToActorCollection(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedActorCollection;
    }

     public void deleteActorCollectionRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteActorCollectionRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ActorCollection")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type actorCollection
             }
     }
     public void purgeActorCollectionRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeActorCollectionRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ActorCollection")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type actorCollection
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/termAnchors")

    public TermAnchor createTermAnchorRelationship(@PathVariable("userId") String userId,TermAnchor relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createTermAnchorRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = TermAnchorMapper.mapTermAnchorToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        TermAnchor reclassifiedTermAnchor =  TermAnchorMapper.mapOmrsRelationshipToTermAnchor(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedTermAnchor;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/termAnchors")

    public TermAnchor getTermAnchorRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getTermAnchorRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            TermAnchor gotTermAnchor = TermAnchorMapper.mapOmrsRelationshipToTermAnchor(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotTermAnchor;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/termAnchors")
    public TermAnchor updateTermAnchorRelationship(@PathVariable("userId") String userId,TermAnchor termAnchor)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateTermAnchorRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = TermAnchorMapper.mapTermAnchorToOmrsRelationship(termAnchor);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        TermAnchor updatedTermAnchor = TermAnchorMapper.mapOmrsRelationshipToTermAnchor(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedTermAnchor;
    }

     public void deleteTermAnchorRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteTermAnchorRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("TermAnchor")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type termAnchor
             }
     }
     public void purgeTermAnchorRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeTermAnchorRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("TermAnchor")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type termAnchor
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/projectResourceses")

    public ProjectResources createProjectResourcesRelationship(@PathVariable("userId") String userId,ProjectResources relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createProjectResourcesRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ProjectResourcesMapper.mapProjectResourcesToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ProjectResources reclassifiedProjectResources =  ProjectResourcesMapper.mapOmrsRelationshipToProjectResources(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedProjectResources;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/projectResourceses")

    public ProjectResources getProjectResourcesRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getProjectResourcesRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ProjectResources gotProjectResources = ProjectResourcesMapper.mapOmrsRelationshipToProjectResources(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotProjectResources;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/projectResourceses")
    public ProjectResources updateProjectResourcesRelationship(@PathVariable("userId") String userId,ProjectResources projectResources)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateProjectResourcesRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ProjectResourcesMapper.mapProjectResourcesToOmrsRelationship(projectResources);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ProjectResources updatedProjectResources = ProjectResourcesMapper.mapOmrsRelationshipToProjectResources(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedProjectResources;
    }

     public void deleteProjectResourcesRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteProjectResourcesRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ProjectResources")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type projectResources
             }
     }
     public void purgeProjectResourcesRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeProjectResourcesRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ProjectResources")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type projectResources
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/aPIRequests")

    public APIRequest createAPIRequestRelationship(@PathVariable("userId") String userId,APIRequest relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAPIRequestRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = APIRequestMapper.mapAPIRequestToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        APIRequest reclassifiedAPIRequest =  APIRequestMapper.mapOmrsRelationshipToAPIRequest(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAPIRequest;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/aPIRequests")

    public APIRequest getAPIRequestRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAPIRequestRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            APIRequest gotAPIRequest = APIRequestMapper.mapOmrsRelationshipToAPIRequest(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAPIRequest;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/aPIRequests")
    public APIRequest updateAPIRequestRelationship(@PathVariable("userId") String userId,APIRequest aPIRequest)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAPIRequestRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = APIRequestMapper.mapAPIRequestToOmrsRelationship(aPIRequest);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        APIRequest updatedAPIRequest = APIRequestMapper.mapOmrsRelationshipToAPIRequest(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAPIRequest;
    }

     public void deleteAPIRequestRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAPIRequestRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("APIRequest")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type aPIRequest
             }
     }
     public void purgeAPIRequestRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAPIRequestRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("APIRequest")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type aPIRequest
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/softwareComponentDeployments")

    public SoftwareComponentDeployment createSoftwareComponentDeploymentRelationship(@PathVariable("userId") String userId,SoftwareComponentDeployment relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createSoftwareComponentDeploymentRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = SoftwareComponentDeploymentMapper.mapSoftwareComponentDeploymentToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        SoftwareComponentDeployment reclassifiedSoftwareComponentDeployment =  SoftwareComponentDeploymentMapper.mapOmrsRelationshipToSoftwareComponentDeployment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedSoftwareComponentDeployment;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/softwareComponentDeployments")

    public SoftwareComponentDeployment getSoftwareComponentDeploymentRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getSoftwareComponentDeploymentRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            SoftwareComponentDeployment gotSoftwareComponentDeployment = SoftwareComponentDeploymentMapper.mapOmrsRelationshipToSoftwareComponentDeployment(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotSoftwareComponentDeployment;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/softwareComponentDeployments")
    public SoftwareComponentDeployment updateSoftwareComponentDeploymentRelationship(@PathVariable("userId") String userId,SoftwareComponentDeployment softwareComponentDeployment)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateSoftwareComponentDeploymentRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = SoftwareComponentDeploymentMapper.mapSoftwareComponentDeploymentToOmrsRelationship(softwareComponentDeployment);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        SoftwareComponentDeployment updatedSoftwareComponentDeployment = SoftwareComponentDeploymentMapper.mapOmrsRelationshipToSoftwareComponentDeployment(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedSoftwareComponentDeployment;
    }

     public void deleteSoftwareComponentDeploymentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteSoftwareComponentDeploymentRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("SoftwareComponentDeployment")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type softwareComponentDeployment
             }
     }
     public void purgeSoftwareComponentDeploymentRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeSoftwareComponentDeploymentRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("SoftwareComponentDeployment")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type softwareComponentDeployment
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/cohortMemberMetadataCollections")

    public CohortMemberMetadataCollection createCohortMemberMetadataCollectionRelationship(@PathVariable("userId") String userId,CohortMemberMetadataCollection relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createCohortMemberMetadataCollectionRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = CohortMemberMetadataCollectionMapper.mapCohortMemberMetadataCollectionToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        CohortMemberMetadataCollection reclassifiedCohortMemberMetadataCollection =  CohortMemberMetadataCollectionMapper.mapOmrsRelationshipToCohortMemberMetadataCollection(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedCohortMemberMetadataCollection;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/cohortMemberMetadataCollections")

    public CohortMemberMetadataCollection getCohortMemberMetadataCollectionRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getCohortMemberMetadataCollectionRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            CohortMemberMetadataCollection gotCohortMemberMetadataCollection = CohortMemberMetadataCollectionMapper.mapOmrsRelationshipToCohortMemberMetadataCollection(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotCohortMemberMetadataCollection;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/cohortMemberMetadataCollections")
    public CohortMemberMetadataCollection updateCohortMemberMetadataCollectionRelationship(@PathVariable("userId") String userId,CohortMemberMetadataCollection cohortMemberMetadataCollection)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateCohortMemberMetadataCollectionRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = CohortMemberMetadataCollectionMapper.mapCohortMemberMetadataCollectionToOmrsRelationship(cohortMemberMetadataCollection);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        CohortMemberMetadataCollection updatedCohortMemberMetadataCollection = CohortMemberMetadataCollectionMapper.mapOmrsRelationshipToCohortMemberMetadataCollection(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedCohortMemberMetadataCollection;
    }

     public void deleteCohortMemberMetadataCollectionRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteCohortMemberMetadataCollectionRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("CohortMemberMetadataCollection")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type cohortMemberMetadataCollection
             }
     }
     public void purgeCohortMemberMetadataCollectionRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeCohortMemberMetadataCollectionRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("CohortMemberMetadataCollection")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type cohortMemberMetadataCollection
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/referenceableFacets")

    public ReferenceableFacet createReferenceableFacetRelationship(@PathVariable("userId") String userId,ReferenceableFacet relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createReferenceableFacetRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = ReferenceableFacetMapper.mapReferenceableFacetToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        ReferenceableFacet reclassifiedReferenceableFacet =  ReferenceableFacetMapper.mapOmrsRelationshipToReferenceableFacet(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedReferenceableFacet;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/referenceableFacets")

    public ReferenceableFacet getReferenceableFacetRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getReferenceableFacetRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            ReferenceableFacet gotReferenceableFacet = ReferenceableFacetMapper.mapOmrsRelationshipToReferenceableFacet(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotReferenceableFacet;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/referenceableFacets")
    public ReferenceableFacet updateReferenceableFacetRelationship(@PathVariable("userId") String userId,ReferenceableFacet referenceableFacet)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateReferenceableFacetRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = ReferenceableFacetMapper.mapReferenceableFacetToOmrsRelationship(referenceableFacet);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        ReferenceableFacet updatedReferenceableFacet = ReferenceableFacetMapper.mapOmrsRelationshipToReferenceableFacet(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedReferenceableFacet;
    }

     public void deleteReferenceableFacetRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteReferenceableFacetRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("ReferenceableFacet")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type referenceableFacet
             }
     }
     public void purgeReferenceableFacetRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeReferenceableFacetRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("ReferenceableFacet")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type referenceableFacet
                  }
          }

    @RequestMapping(method = RequestMethod.POST, path = "users/{userId}/relationships/attachedLikes")

    public AttachedLike createAttachedLikeRelationship(@PathVariable("userId") String userId,AttachedLike relationship)
          throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException,  TypeException, UnrecognizedGUIDException {
        final String methodName = "createAttachedLikeRelationship";
        if (log.isDebugEnabled()) {
            log.debug("==> Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);

        Relationship omrsRelationship = AttachedLikeMapper.mapAttachedLikeToOmrsRelationship(relationship);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSAddRelationship(userId,omrsRelationship);
        AttachedLike reclassifiedAttachedLike =  AttachedLikeMapper.mapOmrsRelationshipToAttachedLike(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationship="+relationship);
        }
        return reclassifiedAttachedLike;
    }
    @RequestMapping(method = RequestMethod.GET, path = "users/{userId}/relationships/attachedLikes")

    public AttachedLike getAttachedLikeRelationshipByGuid(@PathVariable("userId") String userId, String relationshipGuid)
         throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException {
            final String methodName = "getAttachedLikeRelationshipByGuid";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            RestValidator.validateUserIdNotNull(className,methodName,userId);
            RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

            Relationship returnedRelationship = oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
            AttachedLike gotAttachedLike = AttachedLikeMapper.mapOmrsRelationshipToAttachedLike(returnedRelationship);
            if (log.isDebugEnabled()) {
                log.debug("<== successful Method: " + methodName + ",userId="+userId+",relationshipGuid="+relationshipGuid);
            }
            return gotAttachedLike;
        }
    @RequestMapping(method = RequestMethod.PUT, path = "users/{userId}/relationships/attachedLikes")
    public AttachedLike updateAttachedLikeRelationship(@PathVariable("userId") String userId,AttachedLike attachedLike)
            throws UserNotAuthorizedException, PropertyServerException, InvalidParameterException, StatusNotSupportedException, UnrecognizedGUIDException {
        final String methodName = "updateAttachedLikeRelationship";
        if (log.isDebugEnabled()) {
           log.debug("==> Method: " + methodName + ",userId="+userId);
        }
        RestValidator.validateUserIdNotNull(className,methodName,userId);


        Relationship omrsRelationship = AttachedLikeMapper.mapAttachedLikeToOmrsRelationship(attachedLike);
        Relationship returnedRelationship = oMRSAPIHelper.callOMRSUpdateRelationship(userId,omrsRelationship);
        AttachedLike updatedAttachedLike = AttachedLikeMapper.mapOmrsRelationshipToAttachedLike(returnedRelationship);
        if (log.isDebugEnabled()) {
            log.debug("<== successful Method: " + methodName + ",userId="+userId);
        }
        return updatedAttachedLike;
    }

     public void deleteAttachedLikeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
              throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, FunctionNotSupportedException, UnrecognizedGUIDException {
            final String methodName = "deleteAttachedLikeRelationshipById";
            if (log.isDebugEnabled()) {
                log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
            }
             RestValidator.validateUserIdNotNull(className,methodName,userId);
             RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

             Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
             String typeGuid = relationship.getType().getTypeDefGUID();
             String typeName = relationship.getType().getTypeDefName();
             if (typeName.equals("AttachedLike")) {
                oMRSAPIHelper.callOMRSDeleteRelationship(userId, typeGuid, typeName, relationshipGuid);
                if (log.isDebugEnabled()) {
                    log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
             } else {
                 // error guid supplied is not for a relationship of type attachedLike
             }
     }
     public void purgeAttachedLikeRelationshipById(@PathVariable String userId,@PathVariable String relationshipGuid)
                  throws PropertyServerException, UserNotAuthorizedException, InvalidParameterException, UnrecognizedGUIDException, RelationshipNotDeletedException, GUIDNotPurgedException {
                 final String methodName = "purgeAttachedLikeRelationshipById";
                 if (log.isDebugEnabled()) {
                     log.debug("==> Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                 }
                  RestValidator.validateUserIdNotNull(className,methodName,userId);
                  RestValidator.validateGUIDNotNull(className,methodName,relationshipGuid,"relationshipGuid");

                  Relationship relationship =  oMRSAPIHelper.callOMRSGetRelationshipByGuid(userId,relationshipGuid);
                  String typeGuid = relationship.getType().getTypeDefGUID();
                  String typeName = relationship.getType().getTypeDefName();
                  if (typeName.equals("AttachedLike")) {
                     oMRSAPIHelper.callOMRSPurgeRelationship(userId, typeGuid, typeName, relationshipGuid);
                     if (log.isDebugEnabled()) {
                         log.debug("<== successful Method: " + methodName + ",userId="+userId+",guid="+relationshipGuid);
                      }
                  } else {
                      // error guid supplied is not for a relationship of type attachedLike
                  }
          }

}
